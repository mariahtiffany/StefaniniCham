<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_script">
    <sys_ui_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <description/>
        <global>false</global>
        <ignore_in_now_experience>false</ignore_in_now_experience>
        <name>x_stefa_chameleon.CallServiceDesk</name>
        <script><![CDATA[var CallServiceDesk = CallServiceDesk || {};

CallServiceDesk = (function () {
  (function(){"use strict";try{if(typeof document!="undefined"){var e=document.createElement("style");e.appendChild(document.createTextNode("#main_div{max-width:350px}a{color:#56bbf9}#c2c_connection_speed_div,#c2c_test_call_quality_div{display:none;font-size:18px}#c2c_widget_div{padding:10px}#c2c_status_line{display:inline-block}#c2c_select_devices_btn{font-size:18px;padding-top:2px;margin-right:8px;display:none}#c2c_select_devices_svg{width:22px;height:22px}#c2c_test_btn{font-size:18px;padding-top:2px;display:none}#c2c_test_svg{width:22px;height:22px}#c2c_call_btn{margin:0 1rem 0 0;display:none}#c2c_call_svg{width:22px;height:22px}.c2c_call_btn_hangup{background-color:#ffb6c1;border-color:#ffb6c1}.c2c_call_svg_disabled{transform:rotate(-90deg);fill:gray}.c2c_call_svg_ready{transform:rotate(-90deg);fill:#1e90ff}.c2c_call_svg_hangup{fill:#ff1493}.c2c_call_svg_calling{animation:colorChange 4s infinite linear}@keyframes colorChange{to{fill:#99e6ff}90%{fill:#66d9ff}80%{fill:#3cf}70%{fill:#00bfff}60%{fill:#09c}50%{fill:#007399}40%{fill:#004d66}30%{fill:#007399}20%{fill:#09c}10%{fill:#00bfff}0%{fill:#3cf}}#keypad_btn{margin-right:1rem}#c2c_video_chk_span{color:#150cef;display:none}#c2c_camera_btn{padding:4px 16px;border:0px none #99e6ff;background-color:#99e6ff;margin-right:1rem;display:none}#c2c_camera_svg{width:26px;height:26px;fill:#fff;stroke:#000}#c2c_camera_line_svg.c2c_camera_on{stroke:none}#c2c_camera_line_svg.c2c_camera_off{stroke:#000}#c2c_select_devices_div,#dtmf_keypad{display:none}#keypad_table{font-family:Verdana,Arial,Helvetica,sans-serif;text-align:center;margin:10px auto}#keypad_table tr td{vertical-align:middle;text-align:center;border:1px solid #000000;font-size:18px;font-weight:700;width:40px;height:30px;cursor:pointer;background-color:#666;color:#ccc}#keypad_table tr td:hover{background-color:#999;color:#ff0}")),document.head.appendChild(e)}}catch(c){console.error("vite-plugin-css-injected-by-js",c)}})();
var Dv=Object.defineProperty;var Yd=Object.getOwnPropertySymbols;var Nv=Object.prototype.hasOwnProperty,Mv=Object.prototype.propertyIsEnumerable;var ra=(t,e,r)=>e in t?Dv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mr=(t,e)=>{for(var r in e||(e={}))Nv.call(e,r)&&ra(t,r,e[r]);if(Yd)for(var r of Yd(e))Mv.call(e,r)&&ra(t,r,e[r]);return t};var le=(t,e,r)=>(ra(t,typeof e!="symbol"?e+"":e,r),r);var Kn=(t,e,r)=>new Promise((i,l)=>{var o=h=>{try{f(r.next(h))}catch(c){l(c)}},n=h=>{try{f(r.throw(h))}catch(c){l(c)}},f=h=>h.done?i(h.value):Promise.resolve(h.value).then(o,n);f((r=r.apply(t,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function r(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(l){if(l.ep)return;l.ep=!0;const o=r(l);fetch(l.href,o)}})();function Lv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _p={exports:{}},fo={},pp={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var is=Symbol.for("react.element"),Uv=Symbol.for("react.portal"),Fv=Symbol.for("react.fragment"),$v=Symbol.for("react.strict_mode"),Hv=Symbol.for("react.profiler"),jv=Symbol.for("react.provider"),Vv=Symbol.for("react.context"),Bv=Symbol.for("react.forward_ref"),zv=Symbol.for("react.suspense"),qv=Symbol.for("react.memo"),Wv=Symbol.for("react.lazy"),Jd=Symbol.iterator;function Gv(t){return t===null||typeof t!="object"?null:(t=Jd&&t[Jd]||t["@@iterator"],typeof t=="function"?t:null)}var gp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mp=Object.assign,vp={};function Yr(t,e,r){this.props=t,this.context=e,this.refs=vp,this.updater=r||gp}Yr.prototype.isReactComponent={};Yr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yp(){}yp.prototype=Yr.prototype;function sc(t,e,r){this.props=t,this.context=e,this.refs=vp,this.updater=r||gp}var lc=sc.prototype=new yp;lc.constructor=sc;mp(lc,Yr.prototype);lc.isPureReactComponent=!0;var Xd=Array.isArray,Sp=Object.prototype.hasOwnProperty,oc={current:null},Cp={key:!0,ref:!0,__self:!0,__source:!0};function Tp(t,e,r){var i,l={},o=null,n=null;if(e!=null)for(i in e.ref!==void 0&&(n=e.ref),e.key!==void 0&&(o=""+e.key),e)Sp.call(e,i)&&!Cp.hasOwnProperty(i)&&(l[i]=e[i]);var f=arguments.length-2;if(f===1)l.children=r;else if(1<f){for(var h=Array(f),c=0;c<f;c++)h[c]=arguments[c+2];l.children=h}if(t&&t.defaultProps)for(i in f=t.defaultProps,f)l[i]===void 0&&(l[i]=f[i]);return{$typeof:is,type:t,key:o,ref:n,props:l,_owner:oc.current}}function Kv(t,e){return{$typeof:is,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ac(t){return typeof t=="object"&&t!==null&&t.$typeof===is}function Qv(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Zd=/\/+/g;function ia(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Qv(""+t.key):e.toString(36)}function ol(t,e,r,i,l){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var n=!1;if(t===null)n=!0;else switch(o){case"string":case"number":n=!0;break;case"object":switch(t.$typeof){case is:case Uv:n=!0}}if(n)return n=t,l=l(n),t=i===""?"."+ia(n,0):i,Xd(l)?(r="",t!=null&&(r=t.replace(Zd,"$&/")+"/"),ol(l,e,r,"",function(c){return c})):l!=null&&(ac(l)&&(l=Kv(l,r+(!l.key||n&&n.key===l.key?"":(""+l.key).replace(Zd,"$&/")+"/")+t)),e.push(l)),1;if(n=0,i=i===""?".":i+":",Xd(t))for(var f=0;f<t.length;f++){o=t[f];var h=i+ia(o,f);n+=ol(o,e,r,h,l)}else if(h=Gv(t),typeof h=="function")for(t=h.call(t),f=0;!(o=t.next()).done;)o=o.value,h=i+ia(o,f++),n+=ol(o,e,r,h,l);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return n}function Ds(t,e,r){if(t==null)return t;var i=[],l=0;return ol(t,i,"","",function(o){return e.call(r,o,l++)}),i}function Yv(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ot={current:null},al={transition:null},Jv={ReactCurrentDispatcher:ot,ReactCurrentBatchConfig:al,ReactCurrentOwner:oc};ce.Children={map:Ds,forEach:function(t,e,r){Ds(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ds(t,function(){e++}),e},toArray:function(t){return Ds(t,function(e){return e})||[]},only:function(t){if(!ac(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ce.Component=Yr;ce.Fragment=Fv;ce.Profiler=Hv;ce.PureComponent=sc;ce.StrictMode=$v;ce.Suspense=zv;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jv;ce.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=mp({},t.props),l=t.key,o=t.ref,n=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,n=oc.current),e.key!==void 0&&(l=""+e.key),t.type&&t.type.defaultProps)var f=t.type.defaultProps;for(h in e)Sp.call(e,h)&&!Cp.hasOwnProperty(h)&&(i[h]=e[h]===void 0&&f!==void 0?f[h]:e[h])}var h=arguments.length-2;if(h===1)i.children=r;else if(1<h){f=Array(h);for(var c=0;c<h;c++)f[c]=arguments[c+2];i.children=f}return{$typeof:is,type:t.type,key:l,ref:o,props:i,_owner:n}};ce.createContext=function(t){return t={$typeof:Vv,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$typeof:jv,_context:t},t.Consumer=t};ce.createElement=Tp;ce.createFactory=function(t){var e=Tp.bind(null,t);return e.type=t,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(t){return{$typeof:Bv,render:t}};ce.isValidElement=ac;ce.lazy=function(t){return{$typeof:Wv,_payload:{_status:-1,_result:t},_init:Yv}};ce.memo=function(t,e){return{$typeof:qv,type:t,compare:e===void 0?null:e}};ce.startTransition=function(t){var e=al.transition;al.transition={};try{t()}finally{al.transition=e}};ce.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ce.useCallback=function(t,e){return ot.current.useCallback(t,e)};ce.useContext=function(t){return ot.current.useContext(t)};ce.useDebugValue=function(){};ce.useDeferredValue=function(t){return ot.current.useDeferredValue(t)};ce.useEffect=function(t,e){return ot.current.useEffect(t,e)};ce.useId=function(){return ot.current.useId()};ce.useImperativeHandle=function(t,e,r){return ot.current.useImperativeHandle(t,e,r)};ce.useInsertionEffect=function(t,e){return ot.current.useInsertionEffect(t,e)};ce.useLayoutEffect=function(t,e){return ot.current.useLayoutEffect(t,e)};ce.useMemo=function(t,e){return ot.current.useMemo(t,e)};ce.useReducer=function(t,e,r){return ot.current.useReducer(t,e,r)};ce.useRef=function(t){return ot.current.useRef(t)};ce.useState=function(t){return ot.current.useState(t)};ce.useSyncExternalStore=function(t,e,r){return ot.current.useSyncExternalStore(t,e,r)};ce.useTransition=function(){return ot.current.useTransition()};ce.version="18.2.0";pp.exports=ce;var er=pp.exports;const Xv=Lv(er);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zv=er,ey=Symbol.for("react.element"),ty=Symbol.for("react.fragment"),ny=Object.prototype.hasOwnProperty,ry=Zv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iy={key:!0,ref:!0,__self:!0,__source:!0};function wp(t,e,r){var i,l={},o=null,n=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(n=e.ref);for(i in e)ny.call(e,i)&&!iy.hasOwnProperty(i)&&(l[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)l[i]===void 0&&(l[i]=e[i]);return{$typeof:ey,type:t,key:o,ref:n,props:l,_owner:ry.current}}fo.Fragment=ty;fo.jsx=wp;fo.jsxs=wp;_p.exports=fo;var q=_p.exports,Za={},Ep={exports:{}},Tt={},Ap={exports:{}},Rp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,ee){var ie=Q.length;Q.push(ee);e:for(;0<ie;){var _e=ie-1>>>1,te=Q[_e];if(0<l(te,ee))Q[_e]=ee,Q[ie]=te,ie=_e;else break e}}function r(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var ee=Q[0],ie=Q.pop();if(ie!==ee){Q[0]=ie;e:for(var _e=0,te=Q.length,Et=te>>>1;_e<Et;){var rt=2*(_e+1)-1,At=Q[rt],Je=rt+1,de=Q[Je];if(0>l(At,ie))Je<te&&0>l(de,At)?(Q[_e]=de,Q[Je]=ie,_e=Je):(Q[_e]=At,Q[rt]=ie,_e=rt);else if(Je<te&&0>l(de,ie))Q[_e]=de,Q[Je]=ie,_e=Je;else break e}}return ee}function l(Q,ee){var ie=Q.sortIndex-ee.sortIndex;return ie!==0?ie:Q.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var n=Date,f=n.now();t.unstable_now=function(){return n.now()-f}}var h=[],c=[],p=1,g=null,v=3,C=!1,w=!1,k=!1,F=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Q){for(var ee=r(c);ee!==null;){if(ee.callback===null)i(c);else if(ee.startTime<=Q)i(c),ee.sortIndex=ee.expirationTime,e(h,ee);else break;ee=r(c)}}function x(Q){if(k=!1,E(Q),!w)if(r(h)!==null)w=!0,O($);else{var ee=r(c);ee!==null&&j(x,ee.startTime-Q)}}function $(Q,ee){w=!1,k&&(k=!1,T(I),I=-1),C=!0;var ie=v;try{for(E(ee),g=r(h);g!==null&&(!(g.expirationTime>ee)||Q&&!De());){var _e=g.callback;if(typeof _e=="function"){g.callback=null,v=g.priorityLevel;var te=_e(g.expirationTime<=ee);ee=t.unstable_now(),typeof te=="function"?g.callback=te:g===r(h)&&i(h),E(ee)}else i(h);g=r(h)}if(g!==null)var Et=!0;else{var rt=r(c);rt!==null&&j(x,rt.startTime-ee),Et=!1}return Et}finally{g=null,v=ie,C=!1}}var W=!1,z=null,I=-1,D=5,re=-1;function De(){return!(t.unstable_now()-re<D)}function He(){if(z!==null){var Q=t.unstable_now();re=Q;var ee=!0;try{ee=z(!0,Q)}finally{ee?ae():(W=!1,z=null)}}else W=!1}var ae;if(typeof S=="function")ae=function(){S(He)};else if(typeof MessageChannel!="undefined"){var H=new MessageChannel,B=H.port2;H.port1.onmessage=He,ae=function(){B.postMessage(null)}}else ae=function(){F(He,0)};function O(Q){z=Q,W||(W=!0,ae())}function j(Q,ee){I=F(function(){Q(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){w||C||(w=!0,O($))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(h)},t.unstable_next=function(Q){switch(v){case 1:case 2:case 3:var ee=3;break;default:ee=v}var ie=v;v=ee;try{return Q()}finally{v=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,ee){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ie=v;v=Q;try{return ee()}finally{v=ie}},t.unstable_scheduleCallback=function(Q,ee,ie){var _e=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?_e+ie:_e):ie=_e,Q){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=ie+te,Q={id:p++,callback:ee,priorityLevel:Q,startTime:ie,expirationTime:te,sortIndex:-1},ie>_e?(Q.sortIndex=ie,e(c,Q),r(h)===null&&Q===r(c)&&(k?(T(I),I=-1):k=!0,j(x,ie-_e))):(Q.sortIndex=te,e(h,Q),w||C||(w=!0,O($))),Q},t.unstable_shouldYield=De,t.unstable_wrapCallback=function(Q){var ee=v;return function(){var ie=v;v=ee;try{return Q.apply(this,arguments)}finally{v=ie}}}})(Rp);Ap.exports=Rp;var sy=Ap.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp=er,Ct=sy;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ip=new Set,Fi={};function dr(t,e){Vr(t,e),Vr(t+"Capture",e)}function Vr(t,e){for(Fi[t]=e,t=0;t<e.length;t++)Ip.add(e[t])}var an=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),eu=Object.prototype.hasOwnProperty,ly=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,eh={},th={};function oy(t){return eu.call(th,t)?!0:eu.call(eh,t)?!1:ly.test(t)?th[t]=!0:(eh[t]=!0,!1)}function ay(t,e,r,i){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function uy(t,e,r,i){if(e===null||typeof e=="undefined"||ay(t,e,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function at(t,e,r,i,l,o,n){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=l,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=n}var Ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ye[t]=new at(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ye[e]=new at(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ye[t]=new at(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ye[t]=new at(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ye[t]=new at(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ye[t]=new at(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ye[t]=new at(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ye[t]=new at(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ye[t]=new at(t,5,!1,t.toLowerCase(),null,!1,!1)});var uc=/[\-:]([a-z])/g;function cc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(uc,cc);Ye[e]=new at(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(uc,cc);Ye[e]=new at(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(uc,cc);Ye[e]=new at(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ye[t]=new at(t,1,!1,t.toLowerCase(),null,!1,!1)});Ye.xlinkHref=new at("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ye[t]=new at(t,1,!1,t.toLowerCase(),null,!0,!0)});function fc(t,e,r,i){var l=Ye.hasOwnProperty(e)?Ye[e]:null;(l!==null?l.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(uy(e,r,l,i)&&(r=null),i||l===null?oy(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):l.mustUseProperty?t[l.propertyName]=r===null?l.type===3?!1:"":r:(e=l.attributeName,i=l.attributeNamespace,r===null?t.removeAttribute(e):(l=l.type,r=l===3||l===4&&r===!0?"":""+r,i?t.setAttributeNS(i,e,r):t.setAttribute(e,r))))}var dn=kp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ns=Symbol.for("react.element"),Tr=Symbol.for("react.portal"),wr=Symbol.for("react.fragment"),dc=Symbol.for("react.strict_mode"),tu=Symbol.for("react.profiler"),bp=Symbol.for("react.provider"),Op=Symbol.for("react.context"),hc=Symbol.for("react.forward_ref"),nu=Symbol.for("react.suspense"),ru=Symbol.for("react.suspense_list"),_c=Symbol.for("react.memo"),Cn=Symbol.for("react.lazy"),Pp=Symbol.for("react.offscreen"),nh=Symbol.iterator;function ai(t){return t===null||typeof t!="object"?null:(t=nh&&t[nh]||t["@@iterator"],typeof t=="function"?t:null)}var Ie=Object.assign,sa;function Ei(t){if(sa===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);sa=e&&e[1]||""}return`
`+sa+t}var la=!1;function oa(t,e){if(!t||la)return"";la=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var l=c.stack.split(`
`),o=i.stack.split(`
`),n=l.length-1,f=o.length-1;1<=n&&0<=f&&l[n]!==o[f];)f--;for(;1<=n&&0<=f;n--,f--)if(l[n]!==o[f]){if(n!==1||f!==1)do if(n--,f--,0>f||l[n]!==o[f]){var h=`
`+l[n].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=n&&0<=f);break}}}finally{la=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ei(t):""}function cy(t){switch(t.tag){case 5:return Ei(t.type);case 16:return Ei("Lazy");case 13:return Ei("Suspense");case 19:return Ei("SuspenseList");case 0:case 2:case 15:return t=oa(t.type,!1),t;case 11:return t=oa(t.type.render,!1),t;case 1:return t=oa(t.type,!0),t;default:return""}}function iu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wr:return"Fragment";case Tr:return"Portal";case tu:return"Profiler";case dc:return"StrictMode";case nu:return"Suspense";case ru:return"SuspenseList"}if(typeof t=="object")switch(t.$typeof){case Op:return(t.displayName||"Context")+".Consumer";case bp:return(t._context.displayName||"Context")+".Provider";case hc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _c:return e=t.displayName||null,e!==null?e:iu(t.type)||"Memo";case Cn:e=t._payload,t=t._init;try{return iu(t(e))}catch(r){}}return null}function fy(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return iu(e);case 8:return e===dc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function dy(t){var e=xp(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var l=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return l.call(this)},set:function(n){i=""+n,o.call(this,n)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(n){i=""+n},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ms(t){t._valueTracker||(t._valueTracker=dy(t))}function Dp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),i="";return t&&(i=xp(t)?t.checked?"true":"false":t.value),t=i,t!==r?(e.setValue(t),!0):!1}function xl(t){if(t=t||(typeof document!="undefined"?document:void 0),typeof t=="undefined")return null;try{return t.activeElement||t.body}catch(e){return t.body}}function su(t,e){var r=e.checked;return Ie({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:t._wrapperState.initialChecked})}function rh(t,e){var r=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;r=Mn(e.value!=null?e.value:r),t._wrapperState={initialChecked:i,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Np(t,e){e=e.checked,e!=null&&fc(t,"checked",e,!1)}function lu(t,e){Np(t,e);var r=Mn(e.value),i=e.type;if(r!=null)i==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ou(t,e.type,r):e.hasOwnProperty("defaultValue")&&ou(t,e.type,Mn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ih(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function ou(t,e,r){(e!=="number"||xl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ai=Array.isArray;function Mr(t,e,r,i){if(t=t.options,e){e={};for(var l=0;l<r.length;l++)e["$"+r[l]]=!0;for(r=0;r<t.length;r++)l=e.hasOwnProperty("$"+t[r].value),t[r].selected!==l&&(t[r].selected=l),l&&i&&(t[r].defaultSelected=!0)}else{for(r=""+Mn(r),e=null,l=0;l<t.length;l++){if(t[l].value===r){t[l].selected=!0,i&&(t[l].defaultSelected=!0);return}e!==null||t[l].disabled||(e=t[l])}e!==null&&(e.selected=!0)}}function au(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return Ie({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sh(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(V(92));if(Ai(r)){if(1<r.length)throw Error(V(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Mn(r)}}function Mp(t,e){var r=Mn(e.value),i=Mn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),i!=null&&(t.defaultValue=""+i)}function lh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Lp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Lp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ls,Up=function(t){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(e,r,i,l){MSApp.execUnsafeLocalFunction(function(){return t(e,r,i,l)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ls=Ls||document.createElement("div"),Ls.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ls.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $i(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ii={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hy=["Webkit","ms","Moz","O"];Object.keys(Ii).forEach(function(t){hy.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ii[e]=Ii[t]})});function Fp(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ii.hasOwnProperty(t)&&Ii[t]?(""+e).trim():e+"px"}function $p(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var i=r.indexOf("--")===0,l=Fp(r,e[r],i);r==="float"&&(r="cssFloat"),i?t.setProperty(r,l):t[r]=l}}var _y=Ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cu(t,e){if(e){if(_y[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function fu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var du=null;function pc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hu=null,Lr=null,Ur=null;function oh(t){if(t=os(t)){if(typeof hu!="function")throw Error(V(280));var e=t.stateNode;e&&(e=mo(e),hu(t.stateNode,t.type,e))}}function Hp(t){Lr?Ur?Ur.push(t):Ur=[t]:Lr=t}function jp(){if(Lr){var t=Lr,e=Ur;if(Ur=Lr=null,oh(t),e)for(t=0;t<e.length;t++)oh(e[t])}}function Vp(t,e){return t(e)}function Bp(){}var aa=!1;function zp(t,e,r){if(aa)return t(e,r);aa=!0;try{return Vp(t,e,r)}finally{aa=!1,(Lr!==null||Ur!==null)&&(Bp(),jp())}}function Hi(t,e){var r=t.stateNode;if(r===null)return null;var i=mo(r);if(i===null)return null;r=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(V(231,e,typeof r));return r}var _u=!1;if(an)try{var ui={};Object.defineProperty(ui,"passive",{get:function(){_u=!0}}),window.addEventListener("test",ui,ui),window.removeEventListener("test",ui,ui)}catch(t){_u=!1}function py(t,e,r,i,l,o,n,f,h){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(p){this.onError(p)}}var bi=!1,Dl=null,Nl=!1,pu=null,gy={onError:function(t){bi=!0,Dl=t}};function my(t,e,r,i,l,o,n,f,h){bi=!1,Dl=null,py.apply(gy,arguments)}function vy(t,e,r,i,l,o,n,f,h){if(my.apply(this,arguments),bi){if(bi){var c=Dl;bi=!1,Dl=null}else throw Error(V(198));Nl||(Nl=!0,pu=c)}}function hr(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function qp(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ah(t){if(hr(t)!==t)throw Error(V(188))}function yy(t){var e=t.alternate;if(!e){if(e=hr(t),e===null)throw Error(V(188));return e!==t?null:t}for(var r=t,i=e;;){var l=r.return;if(l===null)break;var o=l.alternate;if(o===null){if(i=l.return,i!==null){r=i;continue}break}if(l.child===o.child){for(o=l.child;o;){if(o===r)return ah(l),t;if(o===i)return ah(l),e;o=o.sibling}throw Error(V(188))}if(r.return!==i.return)r=l,i=o;else{for(var n=!1,f=l.child;f;){if(f===r){n=!0,r=l,i=o;break}if(f===i){n=!0,i=l,r=o;break}f=f.sibling}if(!n){for(f=o.child;f;){if(f===r){n=!0,r=o,i=l;break}if(f===i){n=!0,i=o,r=l;break}f=f.sibling}if(!n)throw Error(V(189))}}if(r.alternate!==i)throw Error(V(190))}if(r.tag!==3)throw Error(V(188));return r.stateNode.current===r?t:e}function Wp(t){return t=yy(t),t!==null?Gp(t):null}function Gp(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Gp(t);if(e!==null)return e;t=t.sibling}return null}var Kp=Ct.unstable_scheduleCallback,uh=Ct.unstable_cancelCallback,Sy=Ct.unstable_shouldYield,Cy=Ct.unstable_requestPaint,xe=Ct.unstable_now,Ty=Ct.unstable_getCurrentPriorityLevel,gc=Ct.unstable_ImmediatePriority,Qp=Ct.unstable_UserBlockingPriority,Ml=Ct.unstable_NormalPriority,wy=Ct.unstable_LowPriority,Yp=Ct.unstable_IdlePriority,ho=null,Gt=null;function Ey(t){if(Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(ho,t,void 0,(t.current.flags&128)===128)}catch(e){}}var $t=Math.clz32?Math.clz32:ky,Ay=Math.log,Ry=Math.LN2;function ky(t){return t>>>=0,t===0?32:31-(Ay(t)/Ry|0)|0}var Us=64,Fs=4194304;function Ri(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ll(t,e){var r=t.pendingLanes;if(r===0)return 0;var i=0,l=t.suspendedLanes,o=t.pingedLanes,n=r&268435455;if(n!==0){var f=n&~l;f!==0?i=Ri(f):(o&=n,o!==0&&(i=Ri(o)))}else n=r&~l,n!==0?i=Ri(n):o!==0&&(i=Ri(o));if(i===0)return 0;if(e!==0&&e!==i&&!(e&l)&&(l=i&-i,o=e&-e,l>=o||l===16&&(o&4194240)!==0))return e;if(i&4&&(i|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)r=31-$t(e),l=1<<r,i|=t[r],e&=~l;return i}function Iy(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function by(t,e){for(var r=t.suspendedLanes,i=t.pingedLanes,l=t.expirationTimes,o=t.pendingLanes;0<o;){var n=31-$t(o),f=1<<n,h=l[n];h===-1?(!(f&r)||f&i)&&(l[n]=Iy(f,e)):h<=e&&(t.expiredLanes|=f),o&=~f}}function gu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Jp(){var t=Us;return Us<<=1,!(Us&4194240)&&(Us=64),t}function ua(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ss(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$t(e),t[e]=r}function Oy(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<r;){var l=31-$t(r),o=1<<l;e[l]=0,i[l]=-1,t[l]=-1,r&=~o}}function mc(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var i=31-$t(r),l=1<<i;l&e|t[i]&e&&(t[i]|=e),r&=~l}}var pe=0;function Xp(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Zp,vc,eg,tg,ng,mu=!1,$s=[],kn=null,In=null,bn=null,ji=new Map,Vi=new Map,wn=[],Py="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ch(t,e){switch(t){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":In=null;break;case"mouseover":case"mouseout":bn=null;break;case"pointerover":case"pointerout":ji.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vi.delete(e.pointerId)}}function ci(t,e,r,i,l,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:i,nativeEvent:o,targetContainers:[l]},e!==null&&(e=os(e),e!==null&&vc(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,l!==null&&e.indexOf(l)===-1&&e.push(l),t)}function xy(t,e,r,i,l){switch(e){case"focusin":return kn=ci(kn,t,e,r,i,l),!0;case"dragenter":return In=ci(In,t,e,r,i,l),!0;case"mouseover":return bn=ci(bn,t,e,r,i,l),!0;case"pointerover":var o=l.pointerId;return ji.set(o,ci(ji.get(o)||null,t,e,r,i,l)),!0;case"gotpointercapture":return o=l.pointerId,Vi.set(o,ci(Vi.get(o)||null,t,e,r,i,l)),!0}return!1}function rg(t){var e=tr(t.target);if(e!==null){var r=hr(e);if(r!==null){if(e=r.tag,e===13){if(e=qp(r),e!==null){t.blockedOn=e,ng(t.priority,function(){eg(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ul(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=vu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var i=new r.constructor(r.type,r);du=i,r.target.dispatchEvent(i),du=null}else return e=os(r),e!==null&&vc(e),t.blockedOn=r,!1;e.shift()}return!0}function fh(t,e,r){ul(t)&&r.delete(e)}function Dy(){mu=!1,kn!==null&&ul(kn)&&(kn=null),In!==null&&ul(In)&&(In=null),bn!==null&&ul(bn)&&(bn=null),ji.forEach(fh),Vi.forEach(fh)}function fi(t,e){t.blockedOn===e&&(t.blockedOn=null,mu||(mu=!0,Ct.unstable_scheduleCallback(Ct.unstable_NormalPriority,Dy)))}function Bi(t){function e(l){return fi(l,t)}if(0<$s.length){fi($s[0],t);for(var r=1;r<$s.length;r++){var i=$s[r];i.blockedOn===t&&(i.blockedOn=null)}}for(kn!==null&&fi(kn,t),In!==null&&fi(In,t),bn!==null&&fi(bn,t),ji.forEach(e),Vi.forEach(e),r=0;r<wn.length;r++)i=wn[r],i.blockedOn===t&&(i.blockedOn=null);for(;0<wn.length&&(r=wn[0],r.blockedOn===null);)rg(r),r.blockedOn===null&&wn.shift()}var Fr=dn.ReactCurrentBatchConfig,Ul=!0;function Ny(t,e,r,i){var l=pe,o=Fr.transition;Fr.transition=null;try{pe=1,yc(t,e,r,i)}finally{pe=l,Fr.transition=o}}function My(t,e,r,i){var l=pe,o=Fr.transition;Fr.transition=null;try{pe=4,yc(t,e,r,i)}finally{pe=l,Fr.transition=o}}function yc(t,e,r,i){if(Ul){var l=vu(t,e,r,i);if(l===null)ya(t,e,i,Fl,r),ch(t,i);else if(xy(l,t,e,r,i))i.stopPropagation();else if(ch(t,i),e&4&&-1<Py.indexOf(t)){for(;l!==null;){var o=os(l);if(o!==null&&Zp(o),o=vu(t,e,r,i),o===null&&ya(t,e,i,Fl,r),o===l)break;l=o}l!==null&&i.stopPropagation()}else ya(t,e,i,null,r)}}var Fl=null;function vu(t,e,r,i){if(Fl=null,t=pc(i),t=tr(t),t!==null)if(e=hr(t),e===null)t=null;else if(r=e.tag,r===13){if(t=qp(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Fl=t,null}function ig(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ty()){case gc:return 1;case Qp:return 4;case Ml:case wy:return 16;case Yp:return 536870912;default:return 16}default:return 16}}var An=null,Sc=null,cl=null;function sg(){if(cl)return cl;var t,e=Sc,r=e.length,i,l="value"in An?An.value:An.textContent,o=l.length;for(t=0;t<r&&e[t]===l[t];t++);var n=r-t;for(i=1;i<=n&&e[r-i]===l[o-i];i++);return cl=l.slice(t,1<i?1-i:void 0)}function fl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Hs(){return!0}function dh(){return!1}function wt(t){function e(r,i,l,o,n){this._reactName=r,this._targetInst=l,this.type=i,this.nativeEvent=o,this.target=n,this.currentTarget=null;for(var f in t)t.hasOwnProperty(f)&&(r=t[f],this[f]=r?r(o):o[f]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Hs:dh,this.isPropagationStopped=dh,this}return Ie(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Hs)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Hs)},persist:function(){},isPersistent:Hs}),e}var Jr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cc=wt(Jr),ls=Ie({},Jr,{view:0,detail:0}),Ly=wt(ls),ca,fa,di,_o=Ie({},ls,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==di&&(di&&t.type==="mousemove"?(ca=t.screenX-di.screenX,fa=t.screenY-di.screenY):fa=ca=0,di=t),ca)},movementY:function(t){return"movementY"in t?t.movementY:fa}}),hh=wt(_o),Uy=Ie({},_o,{dataTransfer:0}),Fy=wt(Uy),$y=Ie({},ls,{relatedTarget:0}),da=wt($y),Hy=Ie({},Jr,{animationName:0,elapsedTime:0,pseudoElement:0}),jy=wt(Hy),Vy=Ie({},Jr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),By=wt(Vy),zy=Ie({},Jr,{data:0}),_h=wt(zy),qy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ky(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Gy[t])?!!e[t]:!1}function Tc(){return Ky}var Qy=Ie({},ls,{key:function(t){if(t.key){var e=qy[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=fl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Wy[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tc,charCode:function(t){return t.type==="keypress"?fl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?fl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Yy=wt(Qy),Jy=Ie({},_o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ph=wt(Jy),Xy=Ie({},ls,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tc}),Zy=wt(Xy),e0=Ie({},Jr,{propertyName:0,elapsedTime:0,pseudoElement:0}),t0=wt(e0),n0=Ie({},_o,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),r0=wt(n0),i0=[9,13,27,32],wc=an&&"CompositionEvent"in window,Oi=null;an&&"documentMode"in document&&(Oi=document.documentMode);var s0=an&&"TextEvent"in window&&!Oi,lg=an&&(!wc||Oi&&8<Oi&&11>=Oi),gh=String.fromCharCode(32),mh=!1;function og(t,e){switch(t){case"keyup":return i0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ag(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Er=!1;function l0(t,e){switch(t){case"compositionend":return ag(e);case"keypress":return e.which!==32?null:(mh=!0,gh);case"textInput":return t=e.data,t===gh&&mh?null:t;default:return null}}function o0(t,e){if(Er)return t==="compositionend"||!wc&&og(t,e)?(t=sg(),cl=Sc=An=null,Er=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lg&&e.locale!=="ko"?null:e.data;default:return null}}var a0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!a0[t.type]:e==="textarea"}function ug(t,e,r,i){Hp(i),e=$l(e,"onChange"),0<e.length&&(r=new Cc("onChange","change",null,r,i),t.push({event:r,listeners:e}))}var Pi=null,zi=null;function u0(t){Sg(t,0)}function po(t){var e=kr(t);if(Dp(e))return t}function c0(t,e){if(t==="change")return e}var cg=!1;if(an){var ha;if(an){var _a="oninput"in document;if(!_a){var yh=document.createElement("div");yh.setAttribute("oninput","return;"),_a=typeof yh.oninput=="function"}ha=_a}else ha=!1;cg=ha&&(!document.documentMode||9<document.documentMode)}function Sh(){Pi&&(Pi.detachEvent("onpropertychange",fg),zi=Pi=null)}function fg(t){if(t.propertyName==="value"&&po(zi)){var e=[];ug(e,zi,t,pc(t)),zp(u0,e)}}function f0(t,e,r){t==="focusin"?(Sh(),Pi=e,zi=r,Pi.attachEvent("onpropertychange",fg)):t==="focusout"&&Sh()}function d0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return po(zi)}function h0(t,e){if(t==="click")return po(e)}function _0(t,e){if(t==="input"||t==="change")return po(e)}function p0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var jt=typeof Object.is=="function"?Object.is:p0;function qi(t,e){if(jt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var l=r[i];if(!eu.call(e,l)||!jt(t[l],e[l]))return!1}return!0}function Ch(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Th(t,e){var r=Ch(t);t=0;for(var i;r;){if(r.nodeType===3){if(i=t+r.textContent.length,t<=e&&i>=e)return{node:r,offset:e-t};t=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ch(r)}}function dg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?dg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function hg(){for(var t=window,e=xl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch(i){r=!1}if(r)t=e.contentWindow;else break;e=xl(t.document)}return e}function Ec(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function g0(t){var e=hg(),r=t.focusedElem,i=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&dg(r.ownerDocument.documentElement,r)){if(i!==null&&Ec(r)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var l=r.textContent.length,o=Math.min(i.start,l);i=i.end===void 0?o:Math.min(i.end,l),!t.extend&&o>i&&(l=i,i=o,o=l),l=Th(r,o);var n=Th(r,i);l&&n&&(t.rangeCount!==1||t.anchorNode!==l.node||t.anchorOffset!==l.offset||t.focusNode!==n.node||t.focusOffset!==n.offset)&&(e=e.createRange(),e.setStart(l.node,l.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(n.node,n.offset)):(e.setEnd(n.node,n.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var m0=an&&"documentMode"in document&&11>=document.documentMode,Ar=null,yu=null,xi=null,Su=!1;function wh(t,e,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Su||Ar==null||Ar!==xl(i)||(i=Ar,"selectionStart"in i&&Ec(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),xi&&qi(xi,i)||(xi=i,i=$l(yu,"onSelect"),0<i.length&&(e=new Cc("onSelect","select",null,e,r),t.push({event:e,listeners:i}),e.target=Ar)))}function js(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Rr={animationend:js("Animation","AnimationEnd"),animationiteration:js("Animation","AnimationIteration"),animationstart:js("Animation","AnimationStart"),transitionend:js("Transition","TransitionEnd")},pa={},_g={};an&&(_g=document.createElement("div").style,"AnimationEvent"in window||(delete Rr.animationend.animation,delete Rr.animationiteration.animation,delete Rr.animationstart.animation),"TransitionEvent"in window||delete Rr.transitionend.transition);function go(t){if(pa[t])return pa[t];if(!Rr[t])return t;var e=Rr[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in _g)return pa[t]=e[r];return t}var pg=go("animationend"),gg=go("animationiteration"),mg=go("animationstart"),vg=go("transitionend"),yg=new Map,Eh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fn(t,e){yg.set(t,e),dr(e,[t])}for(var ga=0;ga<Eh.length;ga++){var ma=Eh[ga],v0=ma.toLowerCase(),y0=ma[0].toUpperCase()+ma.slice(1);Fn(v0,"on"+y0)}Fn(pg,"onAnimationEnd");Fn(gg,"onAnimationIteration");Fn(mg,"onAnimationStart");Fn("dblclick","onDoubleClick");Fn("focusin","onFocus");Fn("focusout","onBlur");Fn(vg,"onTransitionEnd");Vr("onMouseEnter",["mouseout","mouseover"]);Vr("onMouseLeave",["mouseout","mouseover"]);Vr("onPointerEnter",["pointerout","pointerover"]);Vr("onPointerLeave",["pointerout","pointerover"]);dr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dr("onBeforeInput",["compositionend","keypress","textInput","paste"]);dr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S0=new Set("cancel close invalid load scroll toggle".split(" ").concat(ki));function Ah(t,e,r){var i=t.type||"unknown-event";t.currentTarget=r,vy(i,e,void 0,t),t.currentTarget=null}function Sg(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var i=t[r],l=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var n=i.length-1;0<=n;n--){var f=i[n],h=f.instance,c=f.currentTarget;if(f=f.listener,h!==o&&l.isPropagationStopped())break e;Ah(l,f,c),o=h}else for(n=0;n<i.length;n++){if(f=i[n],h=f.instance,c=f.currentTarget,f=f.listener,h!==o&&l.isPropagationStopped())break e;Ah(l,f,c),o=h}}}if(Nl)throw t=pu,Nl=!1,pu=null,t}function Ce(t,e){var r=e[Au];r===void 0&&(r=e[Au]=new Set);var i=t+"__bubble";r.has(i)||(Cg(e,t,2,!1),r.add(i))}function va(t,e,r){var i=0;e&&(i|=4),Cg(r,t,i,e)}var Vs="_reactListening"+Math.random().toString(36).slice(2);function Wi(t){if(!t[Vs]){t[Vs]=!0,Ip.forEach(function(r){r!=="selectionchange"&&(S0.has(r)||va(r,!1,t),va(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vs]||(e[Vs]=!0,va("selectionchange",!1,e))}}function Cg(t,e,r,i){switch(ig(e)){case 1:var l=Ny;break;case 4:l=My;break;default:l=yc}r=l.bind(null,e,r,t),l=void 0,!_u||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(l=!0),i?l!==void 0?t.addEventListener(e,r,{capture:!0,passive:l}):t.addEventListener(e,r,!0):l!==void 0?t.addEventListener(e,r,{passive:l}):t.addEventListener(e,r,!1)}function ya(t,e,r,i,l){var o=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var n=i.tag;if(n===3||n===4){var f=i.stateNode.containerInfo;if(f===l||f.nodeType===8&&f.parentNode===l)break;if(n===4)for(n=i.return;n!==null;){var h=n.tag;if((h===3||h===4)&&(h=n.stateNode.containerInfo,h===l||h.nodeType===8&&h.parentNode===l))return;n=n.return}for(;f!==null;){if(n=tr(f),n===null)return;if(h=n.tag,h===5||h===6){i=o=n;continue e}f=f.parentNode}}i=i.return}zp(function(){var c=o,p=pc(r),g=[];e:{var v=yg.get(t);if(v!==void 0){var C=Cc,w=t;switch(t){case"keypress":if(fl(r)===0)break e;case"keydown":case"keyup":C=Yy;break;case"focusin":w="focus",C=da;break;case"focusout":w="blur",C=da;break;case"beforeblur":case"afterblur":C=da;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=hh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Fy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Zy;break;case pg:case gg:case mg:C=jy;break;case vg:C=t0;break;case"scroll":C=Ly;break;case"wheel":C=r0;break;case"copy":case"cut":case"paste":C=By;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=ph}var k=(e&4)!==0,F=!k&&t==="scroll",T=k?v!==null?v+"Capture":null:v;k=[];for(var S=c,E;S!==null;){E=S;var x=E.stateNode;if(E.tag===5&&x!==null&&(E=x,T!==null&&(x=Hi(S,T),x!=null&&k.push(Gi(S,x,E)))),F)break;S=S.return}0<k.length&&(v=new C(v,w,null,r,p),g.push({event:v,listeners:k}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",v&&r!==du&&(w=r.relatedTarget||r.fromElement)&&(tr(w)||w[un]))break e;if((C||v)&&(v=p.window===p?p:(v=p.ownerDocument)?v.defaultView||v.parentWindow:window,C?(w=r.relatedTarget||r.toElement,C=c,w=w?tr(w):null,w!==null&&(F=hr(w),w!==F||w.tag!==5&&w.tag!==6)&&(w=null)):(C=null,w=c),C!==w)){if(k=hh,x="onMouseLeave",T="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(k=ph,x="onPointerLeave",T="onPointerEnter",S="pointer"),F=C==null?v:kr(C),E=w==null?v:kr(w),v=new k(x,S+"leave",C,r,p),v.target=F,v.relatedTarget=E,x=null,tr(p)===c&&(k=new k(T,S+"enter",w,r,p),k.target=E,k.relatedTarget=F,x=k),F=x,C&&w)t:{for(k=C,T=w,S=0,E=k;E;E=vr(E))S++;for(E=0,x=T;x;x=vr(x))E++;for(;0<S-E;)k=vr(k),S--;for(;0<E-S;)T=vr(T),E--;for(;S--;){if(k===T||T!==null&&k===T.alternate)break t;k=vr(k),T=vr(T)}k=null}else k=null;C!==null&&Rh(g,v,C,k,!1),w!==null&&F!==null&&Rh(g,F,w,k,!0)}}e:{if(v=c?kr(c):window,C=v.nodeName&&v.nodeName.toLowerCase(),C==="select"||C==="input"&&v.type==="file")var $=c0;else if(vh(v))if(cg)$=_0;else{$=d0;var W=f0}else(C=v.nodeName)&&C.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&($=h0);if($&&($=$(t,c))){ug(g,$,r,p);break e}W&&W(t,v,c),t==="focusout"&&(W=v._wrapperState)&&W.controlled&&v.type==="number"&&ou(v,"number",v.value)}switch(W=c?kr(c):window,t){case"focusin":(vh(W)||W.contentEditable==="true")&&(Ar=W,yu=c,xi=null);break;case"focusout":xi=yu=Ar=null;break;case"mousedown":Su=!0;break;case"contextmenu":case"mouseup":case"dragend":Su=!1,wh(g,r,p);break;case"selectionchange":if(m0)break;case"keydown":case"keyup":wh(g,r,p)}var z;if(wc)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Er?og(t,r)&&(I="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(lg&&r.locale!=="ko"&&(Er||I!=="onCompositionStart"?I==="onCompositionEnd"&&Er&&(z=sg()):(An=p,Sc="value"in An?An.value:An.textContent,Er=!0)),W=$l(c,I),0<W.length&&(I=new _h(I,t,null,r,p),g.push({event:I,listeners:W}),z?I.data=z:(z=ag(r),z!==null&&(I.data=z)))),(z=s0?l0(t,r):o0(t,r))&&(c=$l(c,"onBeforeInput"),0<c.length&&(p=new _h("onBeforeInput","beforeinput",null,r,p),g.push({event:p,listeners:c}),p.data=z))}Sg(g,e)})}function Gi(t,e,r){return{instance:t,listener:e,currentTarget:r}}function $l(t,e){for(var r=e+"Capture",i=[];t!==null;){var l=t,o=l.stateNode;l.tag===5&&o!==null&&(l=o,o=Hi(t,r),o!=null&&i.unshift(Gi(t,o,l)),o=Hi(t,e),o!=null&&i.push(Gi(t,o,l))),t=t.return}return i}function vr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rh(t,e,r,i,l){for(var o=e._reactName,n=[];r!==null&&r!==i;){var f=r,h=f.alternate,c=f.stateNode;if(h!==null&&h===i)break;f.tag===5&&c!==null&&(f=c,l?(h=Hi(r,o),h!=null&&n.unshift(Gi(r,h,f))):l||(h=Hi(r,o),h!=null&&n.push(Gi(r,h,f)))),r=r.return}n.length!==0&&t.push({event:e,listeners:n})}var C0=/\r\n?/g,T0=/\u0000|\uFFFD/g;function kh(t){return(typeof t=="string"?t:""+t).replace(C0,`
`).replace(T0,"")}function Bs(t,e,r){if(e=kh(e),kh(t)!==e&&r)throw Error(V(425))}function Hl(){}var Cu=null,Tu=null;function wu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Eu=typeof setTimeout=="function"?setTimeout:void 0,w0=typeof clearTimeout=="function"?clearTimeout:void 0,Ih=typeof Promise=="function"?Promise:void 0,E0=typeof queueMicrotask=="function"?queueMicrotask:typeof Ih!="undefined"?function(t){return Ih.resolve(null).then(t).catch(A0)}:Eu;function A0(t){setTimeout(function(){throw t})}function Sa(t,e){var r=e,i=0;do{var l=r.nextSibling;if(t.removeChild(r),l&&l.nodeType===8)if(r=l.data,r==="/$"){if(i===0){t.removeChild(l),Bi(e);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=l}while(r);Bi(e)}function On(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function bh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Xr=Math.random().toString(36).slice(2),Wt="__reactFiber$"+Xr,Ki="__reactProps$"+Xr,un="__reactContainer$"+Xr,Au="__reactEvents$"+Xr,R0="__reactListeners$"+Xr,k0="__reactHandles$"+Xr;function tr(t){var e=t[Wt];if(e)return e;for(var r=t.parentNode;r;){if(e=r[un]||r[Wt]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=bh(t);t!==null;){if(r=t[Wt])return r;t=bh(t)}return e}t=r,r=t.parentNode}return null}function os(t){return t=t[Wt]||t[un],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function kr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function mo(t){return t[Ki]||null}var Ru=[],Ir=-1;function $n(t){return{current:t}}function Te(t){0>Ir||(t.current=Ru[Ir],Ru[Ir]=null,Ir--)}function ve(t,e){Ir++,Ru[Ir]=t.current,t.current=e}var Ln={},tt=$n(Ln),ht=$n(!1),or=Ln;function Br(t,e){var r=t.type.contextTypes;if(!r)return Ln;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var l={},o;for(o in r)l[o]=e[o];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=l),l}function _t(t){return t=t.childContextTypes,t!=null}function jl(){Te(ht),Te(tt)}function Oh(t,e,r){if(tt.current!==Ln)throw Error(V(168));ve(tt,e),ve(ht,r)}function Tg(t,e,r){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var l in i)if(!(l in e))throw Error(V(108,fy(t)||"Unknown",l));return Ie({},r,i)}function Vl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ln,or=tt.current,ve(tt,t),ve(ht,ht.current),!0}function Ph(t,e,r){var i=t.stateNode;if(!i)throw Error(V(169));r?(t=Tg(t,e,or),i.__reactInternalMemoizedMergedChildContext=t,Te(ht),Te(tt),ve(tt,t)):Te(ht),ve(ht,r)}var rn=null,vo=!1,Ca=!1;function wg(t){rn===null?rn=[t]:rn.push(t)}function I0(t){vo=!0,wg(t)}function Hn(){if(!Ca&&rn!==null){Ca=!0;var t=0,e=pe;try{var r=rn;for(pe=1;t<r.length;t++){var i=r[t];do i=i(!0);while(i!==null)}rn=null,vo=!1}catch(l){throw rn!==null&&(rn=rn.slice(t+1)),Kp(gc,Hn),l}finally{pe=e,Ca=!1}}return null}var br=[],Or=0,Bl=null,zl=0,kt=[],It=0,ar=null,sn=1,ln="";function Xn(t,e){br[Or++]=zl,br[Or++]=Bl,Bl=t,zl=e}function Eg(t,e,r){kt[It++]=sn,kt[It++]=ln,kt[It++]=ar,ar=t;var i=sn;t=ln;var l=32-$t(i)-1;i&=~(1<<l),r+=1;var o=32-$t(e)+l;if(30<o){var n=l-l%5;o=(i&(1<<n)-1).toString(32),i>>=n,l-=n,sn=1<<32-$t(e)+l|r<<l|i,ln=o+t}else sn=1<<o|r<<l|i,ln=t}function Ac(t){t.return!==null&&(Xn(t,1),Eg(t,1,0))}function Rc(t){for(;t===Bl;)Bl=br[--Or],br[Or]=null,zl=br[--Or],br[Or]=null;for(;t===ar;)ar=kt[--It],kt[It]=null,ln=kt[--It],kt[It]=null,sn=kt[--It],kt[It]=null}var St=null,yt=null,Ae=!1,Ft=null;function Ag(t,e){var r=Ot(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function xh(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,St=t,yt=On(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,St=t,yt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ar!==null?{id:sn,overflow:ln}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ot(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,St=t,yt=null,!0):!1;default:return!1}}function ku(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Iu(t){if(Ae){var e=yt;if(e){var r=e;if(!xh(t,e)){if(ku(t))throw Error(V(418));e=On(r.nextSibling);var i=St;e&&xh(t,e)?Ag(i,r):(t.flags=t.flags&-4097|2,Ae=!1,St=t)}}else{if(ku(t))throw Error(V(418));t.flags=t.flags&-4097|2,Ae=!1,St=t}}}function Dh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;St=t}function zs(t){if(t!==St)return!1;if(!Ae)return Dh(t),Ae=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wu(t.type,t.memoizedProps)),e&&(e=yt)){if(ku(t))throw Rg(),Error(V(418));for(;e;)Ag(t,e),e=On(e.nextSibling)}if(Dh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){yt=On(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}yt=null}}else yt=St?On(t.stateNode.nextSibling):null;return!0}function Rg(){for(var t=yt;t;)t=On(t.nextSibling)}function zr(){yt=St=null,Ae=!1}function kc(t){Ft===null?Ft=[t]:Ft.push(t)}var b0=dn.ReactCurrentBatchConfig;function Lt(t,e){if(t&&t.defaultProps){e=Ie({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}var ql=$n(null),Wl=null,Pr=null,Ic=null;function bc(){Ic=Pr=Wl=null}function Oc(t){var e=ql.current;Te(ql),t._currentValue=e}function bu(t,e,r){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===r)break;t=t.return}}function $r(t,e){Wl=t,Ic=Pr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dt=!0),t.firstContext=null)}function xt(t){var e=t._currentValue;if(Ic!==t)if(t={context:t,memoizedValue:e,next:null},Pr===null){if(Wl===null)throw Error(V(308));Pr=t,Wl.dependencies={lanes:0,firstContext:t}}else Pr=Pr.next=t;return e}var nr=null;function Pc(t){nr===null?nr=[t]:nr.push(t)}function kg(t,e,r,i){var l=e.interleaved;return l===null?(r.next=r,Pc(e)):(r.next=l.next,l.next=r),e.interleaved=r,cn(t,i)}function cn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Tn=!1;function xc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ig(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function on(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pn(t,e,r){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,he&2){var l=i.pending;return l===null?e.next=e:(e.next=l.next,l.next=e),i.pending=e,cn(t,r)}return l=i.interleaved,l===null?(e.next=e,Pc(i)):(e.next=l.next,l.next=e),i.interleaved=e,cn(t,r)}function dl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,mc(t,r)}}function Nh(t,e){var r=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var l=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var n={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?l=o=n:o=o.next=n,r=r.next}while(r!==null);o===null?l=o=e:o=o.next=e}else l=o=e;r={baseState:i.baseState,firstBaseUpdate:l,lastBaseUpdate:o,shared:i.shared,effects:i.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Gl(t,e,r,i){var l=t.updateQueue;Tn=!1;var o=l.firstBaseUpdate,n=l.lastBaseUpdate,f=l.shared.pending;if(f!==null){l.shared.pending=null;var h=f,c=h.next;h.next=null,n===null?o=c:n.next=c,n=h;var p=t.alternate;p!==null&&(p=p.updateQueue,f=p.lastBaseUpdate,f!==n&&(f===null?p.firstBaseUpdate=c:f.next=c,p.lastBaseUpdate=h))}if(o!==null){var g=l.baseState;n=0,p=c=h=null,f=o;do{var v=f.lane,C=f.eventTime;if((i&v)===v){p!==null&&(p=p.next={eventTime:C,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var w=t,k=f;switch(v=e,C=r,k.tag){case 1:if(w=k.payload,typeof w=="function"){g=w.call(C,g,v);break e}g=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=k.payload,v=typeof w=="function"?w.call(C,g,v):w,v==null)break e;g=Ie({},g,v);break e;case 2:Tn=!0}}f.callback!==null&&f.lane!==0&&(t.flags|=64,v=l.effects,v===null?l.effects=[f]:v.push(f))}else C={eventTime:C,lane:v,tag:f.tag,payload:f.payload,callback:f.callback,next:null},p===null?(c=p=C,h=g):p=p.next=C,n|=v;if(f=f.next,f===null){if(f=l.shared.pending,f===null)break;v=f,f=v.next,v.next=null,l.lastBaseUpdate=v,l.shared.pending=null}}while(1);if(p===null&&(h=g),l.baseState=h,l.firstBaseUpdate=c,l.lastBaseUpdate=p,e=l.shared.interleaved,e!==null){l=e;do n|=l.lane,l=l.next;while(l!==e)}else o===null&&(l.shared.lanes=0);cr|=n,t.lanes=n,t.memoizedState=g}}function Mh(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],l=i.callback;if(l!==null){if(i.callback=null,i=r,typeof l!="function")throw Error(V(191,l));l.call(i)}}}var bg=new kp.Component().refs;function Ou(t,e,r,i){e=t.memoizedState,r=r(i,e),r=r==null?e:Ie({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var yo={isMounted:function(t){return(t=t._reactInternals)?hr(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var i=lt(),l=Dn(t),o=on(i,l);o.payload=e,r!=null&&(o.callback=r),e=Pn(t,o,l),e!==null&&(Ht(e,t,l,i),dl(e,t,l))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var i=lt(),l=Dn(t),o=on(i,l);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=Pn(t,o,l),e!==null&&(Ht(e,t,l,i),dl(e,t,l))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=lt(),i=Dn(t),l=on(r,i);l.tag=2,e!=null&&(l.callback=e),e=Pn(t,l,i),e!==null&&(Ht(e,t,i,r),dl(e,t,i))}};function Lh(t,e,r,i,l,o,n){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,o,n):e.prototype&&e.prototype.isPureReactComponent?!qi(r,i)||!qi(l,o):!0}function Og(t,e,r){var i=!1,l=Ln,o=e.contextType;return typeof o=="object"&&o!==null?o=xt(o):(l=_t(e)?or:tt.current,i=e.contextTypes,o=(i=i!=null)?Br(t,l):Ln),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=yo,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=l,t.__reactInternalMemoizedMaskedChildContext=o),e}function Uh(t,e,r,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,i),e.state!==t&&yo.enqueueReplaceState(e,e.state,null)}function Pu(t,e,r,i){var l=t.stateNode;l.props=r,l.state=t.memoizedState,l.refs=bg,xc(t);var o=e.contextType;typeof o=="object"&&o!==null?l.context=xt(o):(o=_t(e)?or:tt.current,l.context=Br(t,o)),l.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Ou(t,e,o,r),l.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(e=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),e!==l.state&&yo.enqueueReplaceState(l,l.state,null),Gl(t,r,l,i),l.state=t.memoizedState),typeof l.componentDidMount=="function"&&(t.flags|=4194308)}function hi(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(V(309));var i=r.stateNode}if(!i)throw Error(V(147,t));var l=i,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(n){var f=l.refs;f===bg&&(f=l.refs={}),n===null?delete f[o]:f[o]=n},e._stringRef=o,e)}if(typeof t!="string")throw Error(V(284));if(!r._owner)throw Error(V(290,t))}return t}function qs(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Fh(t){var e=t._init;return e(t._payload)}function Pg(t){function e(T,S){if(t){var E=T.deletions;E===null?(T.deletions=[S],T.flags|=16):E.push(S)}}function r(T,S){if(!t)return null;for(;S!==null;)e(T,S),S=S.sibling;return null}function i(T,S){for(T=new Map;S!==null;)S.key!==null?T.set(S.key,S):T.set(S.index,S),S=S.sibling;return T}function l(T,S){return T=Nn(T,S),T.index=0,T.sibling=null,T}function o(T,S,E){return T.index=E,t?(E=T.alternate,E!==null?(E=E.index,E<S?(T.flags|=2,S):E):(T.flags|=2,S)):(T.flags|=1048576,S)}function n(T){return t&&T.alternate===null&&(T.flags|=2),T}function f(T,S,E,x){return S===null||S.tag!==6?(S=Ia(E,T.mode,x),S.return=T,S):(S=l(S,E),S.return=T,S)}function h(T,S,E,x){var $=E.type;return $===wr?p(T,S,E.props.children,x,E.key):S!==null&&(S.elementType===$||typeof $=="object"&&$!==null&&$.$typeof===Cn&&Fh($)===S.type)?(x=l(S,E.props),x.ref=hi(T,S,E),x.return=T,x):(x=vl(E.type,E.key,E.props,null,T.mode,x),x.ref=hi(T,S,E),x.return=T,x)}function c(T,S,E,x){return S===null||S.tag!==4||S.stateNode.containerInfo!==E.containerInfo||S.stateNode.implementation!==E.implementation?(S=ba(E,T.mode,x),S.return=T,S):(S=l(S,E.children||[]),S.return=T,S)}function p(T,S,E,x,$){return S===null||S.tag!==7?(S=lr(E,T.mode,x,$),S.return=T,S):(S=l(S,E),S.return=T,S)}function g(T,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Ia(""+S,T.mode,E),S.return=T,S;if(typeof S=="object"&&S!==null){switch(S.$typeof){case Ns:return E=vl(S.type,S.key,S.props,null,T.mode,E),E.ref=hi(T,null,S),E.return=T,E;case Tr:return S=ba(S,T.mode,E),S.return=T,S;case Cn:var x=S._init;return g(T,x(S._payload),E)}if(Ai(S)||ai(S))return S=lr(S,T.mode,E,null),S.return=T,S;qs(T,S)}return null}function v(T,S,E,x){var $=S!==null?S.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return $!==null?null:f(T,S,""+E,x);if(typeof E=="object"&&E!==null){switch(E.$typeof){case Ns:return E.key===$?h(T,S,E,x):null;case Tr:return E.key===$?c(T,S,E,x):null;case Cn:return $=E._init,v(T,S,$(E._payload),x)}if(Ai(E)||ai(E))return $!==null?null:p(T,S,E,x,null);qs(T,E)}return null}function C(T,S,E,x,$){if(typeof x=="string"&&x!==""||typeof x=="number")return T=T.get(E)||null,f(S,T,""+x,$);if(typeof x=="object"&&x!==null){switch(x.$typeof){case Ns:return T=T.get(x.key===null?E:x.key)||null,h(S,T,x,$);case Tr:return T=T.get(x.key===null?E:x.key)||null,c(S,T,x,$);case Cn:var W=x._init;return C(T,S,E,W(x._payload),$)}if(Ai(x)||ai(x))return T=T.get(E)||null,p(S,T,x,$,null);qs(S,x)}return null}function w(T,S,E,x){for(var $=null,W=null,z=S,I=S=0,D=null;z!==null&&I<E.length;I++){z.index>I?(D=z,z=null):D=z.sibling;var re=v(T,z,E[I],x);if(re===null){z===null&&(z=D);break}t&&z&&re.alternate===null&&e(T,z),S=o(re,S,I),W===null?$=re:W.sibling=re,W=re,z=D}if(I===E.length)return r(T,z),Ae&&Xn(T,I),$;if(z===null){for(;I<E.length;I++)z=g(T,E[I],x),z!==null&&(S=o(z,S,I),W===null?$=z:W.sibling=z,W=z);return Ae&&Xn(T,I),$}for(z=i(T,z);I<E.length;I++)D=C(z,T,I,E[I],x),D!==null&&(t&&D.alternate!==null&&z.delete(D.key===null?I:D.key),S=o(D,S,I),W===null?$=D:W.sibling=D,W=D);return t&&z.forEach(function(De){return e(T,De)}),Ae&&Xn(T,I),$}function k(T,S,E,x){var $=ai(E);if(typeof $!="function")throw Error(V(150));if(E=$.call(E),E==null)throw Error(V(151));for(var W=$=null,z=S,I=S=0,D=null,re=E.next();z!==null&&!re.done;I++,re=E.next()){z.index>I?(D=z,z=null):D=z.sibling;var De=v(T,z,re.value,x);if(De===null){z===null&&(z=D);break}t&&z&&De.alternate===null&&e(T,z),S=o(De,S,I),W===null?$=De:W.sibling=De,W=De,z=D}if(re.done)return r(T,z),Ae&&Xn(T,I),$;if(z===null){for(;!re.done;I++,re=E.next())re=g(T,re.value,x),re!==null&&(S=o(re,S,I),W===null?$=re:W.sibling=re,W=re);return Ae&&Xn(T,I),$}for(z=i(T,z);!re.done;I++,re=E.next())re=C(z,T,I,re.value,x),re!==null&&(t&&re.alternate!==null&&z.delete(re.key===null?I:re.key),S=o(re,S,I),W===null?$=re:W.sibling=re,W=re);return t&&z.forEach(function(He){return e(T,He)}),Ae&&Xn(T,I),$}function F(T,S,E,x){if(typeof E=="object"&&E!==null&&E.type===wr&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$typeof){case Ns:e:{for(var $=E.key,W=S;W!==null;){if(W.key===$){if($=E.type,$===wr){if(W.tag===7){r(T,W.sibling),S=l(W,E.props.children),S.return=T,T=S;break e}}else if(W.elementType===$||typeof $=="object"&&$!==null&&$.$typeof===Cn&&Fh($)===W.type){r(T,W.sibling),S=l(W,E.props),S.ref=hi(T,W,E),S.return=T,T=S;break e}r(T,W);break}else e(T,W);W=W.sibling}E.type===wr?(S=lr(E.props.children,T.mode,x,E.key),S.return=T,T=S):(x=vl(E.type,E.key,E.props,null,T.mode,x),x.ref=hi(T,S,E),x.return=T,T=x)}return n(T);case Tr:e:{for(W=E.key;S!==null;){if(S.key===W)if(S.tag===4&&S.stateNode.containerInfo===E.containerInfo&&S.stateNode.implementation===E.implementation){r(T,S.sibling),S=l(S,E.children||[]),S.return=T,T=S;break e}else{r(T,S);break}else e(T,S);S=S.sibling}S=ba(E,T.mode,x),S.return=T,T=S}return n(T);case Cn:return W=E._init,F(T,S,W(E._payload),x)}if(Ai(E))return w(T,S,E,x);if(ai(E))return k(T,S,E,x);qs(T,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,S!==null&&S.tag===6?(r(T,S.sibling),S=l(S,E),S.return=T,T=S):(r(T,S),S=Ia(E,T.mode,x),S.return=T,T=S),n(T)):r(T,S)}return F}var qr=Pg(!0),xg=Pg(!1),as={},Kt=$n(as),Qi=$n(as),Yi=$n(as);function rr(t){if(t===as)throw Error(V(174));return t}function Dc(t,e){switch(ve(Yi,e),ve(Qi,t),ve(Kt,as),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=uu(e,t)}Te(Kt),ve(Kt,e)}function Wr(){Te(Kt),Te(Qi),Te(Yi)}function Dg(t){rr(Yi.current);var e=rr(Kt.current),r=uu(e,t.type);e!==r&&(ve(Qi,t),ve(Kt,r))}function Nc(t){Qi.current===t&&(Te(Kt),Te(Qi))}var Re=$n(0);function Kl(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ta=[];function Mc(){for(var t=0;t<Ta.length;t++)Ta[t]._workInProgressVersionPrimary=null;Ta.length=0}var hl=dn.ReactCurrentDispatcher,wa=dn.ReactCurrentBatchConfig,ur=0,ke=null,Fe=null,Ve=null,Ql=!1,Di=!1,Ji=0,O0=0;function Xe(){throw Error(V(321))}function Lc(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!jt(t[r],e[r]))return!1;return!0}function Uc(t,e,r,i,l,o){if(ur=o,ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hl.current=t===null||t.memoizedState===null?N0:M0,t=r(i,l),Di){o=0;do{if(Di=!1,Ji=0,25<=o)throw Error(V(301));o+=1,Ve=Fe=null,e.updateQueue=null,hl.current=L0,t=r(i,l)}while(Di)}if(hl.current=Yl,e=Fe!==null&&Fe.next!==null,ur=0,Ve=Fe=ke=null,Ql=!1,e)throw Error(V(300));return t}function Fc(){var t=Ji!==0;return Ji=0,t}function zt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ve===null?ke.memoizedState=Ve=t:Ve=Ve.next=t,Ve}function Dt(){if(Fe===null){var t=ke.alternate;t=t!==null?t.memoizedState:null}else t=Fe.next;var e=Ve===null?ke.memoizedState:Ve.next;if(e!==null)Ve=e,Fe=t;else{if(t===null)throw Error(V(310));Fe=t,t={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},Ve===null?ke.memoizedState=Ve=t:Ve=Ve.next=t}return Ve}function Xi(t,e){return typeof e=="function"?e(t):e}function Ea(t){var e=Dt(),r=e.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=t;var i=Fe,l=i.baseQueue,o=r.pending;if(o!==null){if(l!==null){var n=l.next;l.next=o.next,o.next=n}i.baseQueue=l=o,r.pending=null}if(l!==null){o=l.next,i=i.baseState;var f=n=null,h=null,c=o;do{var p=c.lane;if((ur&p)===p)h!==null&&(h=h.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var g={lane:p,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};h===null?(f=h=g,n=i):h=h.next=g,ke.lanes|=p,cr|=p}c=c.next}while(c!==null&&c!==o);h===null?n=i:h.next=f,jt(i,e.memoizedState)||(dt=!0),e.memoizedState=i,e.baseState=n,e.baseQueue=h,r.lastRenderedState=i}if(t=r.interleaved,t!==null){l=t;do o=l.lane,ke.lanes|=o,cr|=o,l=l.next;while(l!==t)}else l===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Aa(t){var e=Dt(),r=e.queue;if(r===null)throw Error(V(311));r.lastRenderedReducer=t;var i=r.dispatch,l=r.pending,o=e.memoizedState;if(l!==null){r.pending=null;var n=l=l.next;do o=t(o,n.action),n=n.next;while(n!==l);jt(o,e.memoizedState)||(dt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,i]}function Ng(){}function Mg(t,e){var r=ke,i=Dt(),l=e(),o=!jt(i.memoizedState,l);if(o&&(i.memoizedState=l,dt=!0),i=i.queue,$c(Fg.bind(null,r,i,t),[t]),i.getSnapshot!==e||o||Ve!==null&&Ve.memoizedState.tag&1){if(r.flags|=2048,Zi(9,Ug.bind(null,r,i,l,e),void 0,null),Be===null)throw Error(V(349));ur&30||Lg(r,e,l)}return l}function Lg(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Ug(t,e,r,i){e.value=r,e.getSnapshot=i,$g(e)&&Hg(t)}function Fg(t,e,r){return r(function(){$g(e)&&Hg(t)})}function $g(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!jt(t,r)}catch(i){return!0}}function Hg(t){var e=cn(t,1);e!==null&&Ht(e,t,1,-1)}function $h(t){var e=zt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:t},e.queue=t,t=t.dispatch=D0.bind(null,ke,t),[e.memoizedState,t]}function Zi(t,e,r,i){return t={tag:t,create:e,destroy:r,deps:i,next:null},e=ke.updateQueue,e===null?(e={lastEffect:null,stores:null},ke.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(i=r.next,r.next=t,t.next=i,e.lastEffect=t)),t}function jg(){return Dt().memoizedState}function _l(t,e,r,i){var l=zt();ke.flags|=t,l.memoizedState=Zi(1|e,r,void 0,i===void 0?null:i)}function So(t,e,r,i){var l=Dt();i=i===void 0?null:i;var o=void 0;if(Fe!==null){var n=Fe.memoizedState;if(o=n.destroy,i!==null&&Lc(i,n.deps)){l.memoizedState=Zi(e,r,o,i);return}}ke.flags|=t,l.memoizedState=Zi(1|e,r,o,i)}function Hh(t,e){return _l(8390656,8,t,e)}function $c(t,e){return So(2048,8,t,e)}function Vg(t,e){return So(4,2,t,e)}function Bg(t,e){return So(4,4,t,e)}function zg(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qg(t,e,r){return r=r!=null?r.concat([t]):null,So(4,4,zg.bind(null,e,t),r)}function Hc(){}function Wg(t,e){var r=Dt();e=e===void 0?null:e;var i=r.memoizedState;return i!==null&&e!==null&&Lc(e,i[1])?i[0]:(r.memoizedState=[t,e],t)}function Gg(t,e){var r=Dt();e=e===void 0?null:e;var i=r.memoizedState;return i!==null&&e!==null&&Lc(e,i[1])?i[0]:(t=t(),r.memoizedState=[t,e],t)}function Kg(t,e,r){return ur&21?(jt(r,e)||(r=Jp(),ke.lanes|=r,cr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dt=!0),t.memoizedState=r)}function P0(t,e){var r=pe;pe=r!==0&&4>r?r:4,t(!0);var i=wa.transition;wa.transition={};try{t(!1),e()}finally{pe=r,wa.transition=i}}function Qg(){return Dt().memoizedState}function x0(t,e,r){var i=Dn(t);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},Yg(t))Jg(e,r);else if(r=kg(t,e,r,i),r!==null){var l=lt();Ht(r,t,i,l),Xg(r,e,i)}}function D0(t,e,r){var i=Dn(t),l={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(Yg(t))Jg(e,l);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var n=e.lastRenderedState,f=o(n,r);if(l.hasEagerState=!0,l.eagerState=f,jt(f,n)){var h=e.interleaved;h===null?(l.next=l,Pc(e)):(l.next=h.next,h.next=l),e.interleaved=l;return}}catch(c){}finally{}r=kg(t,e,l,i),r!==null&&(l=lt(),Ht(r,t,i,l),Xg(r,e,i))}}function Yg(t){var e=t.alternate;return t===ke||e!==null&&e===ke}function Jg(t,e){Di=Ql=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Xg(t,e,r){if(r&4194240){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,mc(t,r)}}var Yl={readContext:xt,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},N0={readContext:xt,useCallback:function(t,e){return zt().memoizedState=[t,e===void 0?null:e],t},useContext:xt,useEffect:Hh,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,_l(4194308,4,zg.bind(null,e,t),r)},useLayoutEffect:function(t,e){return _l(4194308,4,t,e)},useInsertionEffect:function(t,e){return _l(4,2,t,e)},useMemo:function(t,e){var r=zt();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var i=zt();return e=r!==void 0?r(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=x0.bind(null,ke,t),[i.memoizedState,t]},useRef:function(t){var e=zt();return t={current:t},e.memoizedState=t},useState:$h,useDebugValue:Hc,useDeferredValue:function(t){return zt().memoizedState=t},useTransition:function(){var t=$h(!1),e=t[0];return t=P0.bind(null,t[1]),zt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var i=ke,l=zt();if(Ae){if(r===void 0)throw Error(V(407));r=r()}else{if(r=e(),Be===null)throw Error(V(349));ur&30||Lg(i,e,r)}l.memoizedState=r;var o={value:r,getSnapshot:e};return l.queue=o,Hh(Fg.bind(null,i,o,t),[t]),i.flags|=2048,Zi(9,Ug.bind(null,i,o,r,e),void 0,null),r},useId:function(){var t=zt(),e=Be.identifierPrefix;if(Ae){var r=ln,i=sn;r=(i&~(1<<32-$t(i)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ji++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=O0++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},M0={readContext:xt,useCallback:Wg,useContext:xt,useEffect:$c,useImperativeHandle:qg,useInsertionEffect:Vg,useLayoutEffect:Bg,useMemo:Gg,useReducer:Ea,useRef:jg,useState:function(){return Ea(Xi)},useDebugValue:Hc,useDeferredValue:function(t){var e=Dt();return Kg(e,Fe.memoizedState,t)},useTransition:function(){var t=Ea(Xi)[0],e=Dt().memoizedState;return[t,e]},useMutableSource:Ng,useSyncExternalStore:Mg,useId:Qg,unstable_isNewReconciler:!1},L0={readContext:xt,useCallback:Wg,useContext:xt,useEffect:$c,useImperativeHandle:qg,useInsertionEffect:Vg,useLayoutEffect:Bg,useMemo:Gg,useReducer:Aa,useRef:jg,useState:function(){return Aa(Xi)},useDebugValue:Hc,useDeferredValue:function(t){var e=Dt();return Fe===null?e.memoizedState=t:Kg(e,Fe.memoizedState,t)},useTransition:function(){var t=Aa(Xi)[0],e=Dt().memoizedState;return[t,e]},useMutableSource:Ng,useSyncExternalStore:Mg,useId:Qg,unstable_isNewReconciler:!1};function Gr(t,e){try{var r="",i=e;do r+=cy(i),i=i.return;while(i);var l=r}catch(o){l=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:l,digest:null}}function Ra(t,e,r){return{value:t,source:null,stack:r!=null?r:null,digest:e!=null?e:null}}function xu(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var U0=typeof WeakMap=="function"?WeakMap:Map;function Zg(t,e,r){r=on(-1,r),r.tag=3,r.payload={element:null};var i=e.value;return r.callback=function(){Xl||(Xl=!0,Vu=i),xu(t,e)},r}function em(t,e,r){r=on(-1,r),r.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var l=e.value;r.payload=function(){return i(l)},r.callback=function(){xu(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){xu(t,e),typeof i!="function"&&(xn===null?xn=new Set([this]):xn.add(this));var n=e.stack;this.componentDidCatch(e.value,{componentStack:n!==null?n:""})}),r}function jh(t,e,r){var i=t.pingCache;if(i===null){i=t.pingCache=new U0;var l=new Set;i.set(e,l)}else l=i.get(e),l===void 0&&(l=new Set,i.set(e,l));l.has(r)||(l.add(r),t=J0.bind(null,t,e,r),e.then(t,t))}function Vh(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Bh(t,e,r,i,l){return t.mode&1?(t.flags|=65536,t.lanes=l,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=on(-1,1),e.tag=2,Pn(r,e,1))),r.lanes|=1),t)}var F0=dn.ReactCurrentOwner,dt=!1;function st(t,e,r,i){e.child=t===null?xg(e,null,r,i):qr(e,t.child,r,i)}function zh(t,e,r,i,l){r=r.render;var o=e.ref;return $r(e,l),i=Uc(t,e,r,i,o,l),r=Fc(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~l,fn(t,e,l)):(Ae&&r&&Ac(e),e.flags|=1,st(t,e,i,l),e.child)}function qh(t,e,r,i,l){if(t===null){var o=r.type;return typeof o=="function"&&!Kc(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,tm(t,e,o,i,l)):(t=vl(r.type,null,i,e,e.mode,l),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&l)){var n=o.memoizedProps;if(r=r.compare,r=r!==null?r:qi,r(n,i)&&t.ref===e.ref)return fn(t,e,l)}return e.flags|=1,t=Nn(o,i),t.ref=e.ref,t.return=e,e.child=t}function tm(t,e,r,i,l){if(t!==null){var o=t.memoizedProps;if(qi(o,i)&&t.ref===e.ref)if(dt=!1,e.pendingProps=i=o,(t.lanes&l)!==0)t.flags&131072&&(dt=!0);else return e.lanes=t.lanes,fn(t,e,l)}return Du(t,e,r,i,l)}function nm(t,e,r){var i=e.pendingProps,l=i.children,o=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ve(Dr,vt),vt|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ve(Dr,vt),vt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:r,ve(Dr,vt),vt|=i}else o!==null?(i=o.baseLanes|r,e.memoizedState=null):i=r,ve(Dr,vt),vt|=i;return st(t,e,l,r),e.child}function rm(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Du(t,e,r,i,l){var o=_t(r)?or:tt.current;return o=Br(e,o),$r(e,l),r=Uc(t,e,r,i,o,l),i=Fc(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~l,fn(t,e,l)):(Ae&&i&&Ac(e),e.flags|=1,st(t,e,r,l),e.child)}function Wh(t,e,r,i,l){if(_t(r)){var o=!0;Vl(e)}else o=!1;if($r(e,l),e.stateNode===null)pl(t,e),Og(e,r,i),Pu(e,r,i,l),i=!0;else if(t===null){var n=e.stateNode,f=e.memoizedProps;n.props=f;var h=n.context,c=r.contextType;typeof c=="object"&&c!==null?c=xt(c):(c=_t(r)?or:tt.current,c=Br(e,c));var p=r.getDerivedStateFromProps,g=typeof p=="function"||typeof n.getSnapshotBeforeUpdate=="function";g||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(f!==i||h!==c)&&Uh(e,n,i,c),Tn=!1;var v=e.memoizedState;n.state=v,Gl(e,i,n,l),h=e.memoizedState,f!==i||v!==h||ht.current||Tn?(typeof p=="function"&&(Ou(e,r,p,i),h=e.memoizedState),(f=Tn||Lh(e,r,f,i,v,h,c))?(g||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount()),typeof n.componentDidMount=="function"&&(e.flags|=4194308)):(typeof n.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=h),n.props=i,n.state=h,n.context=c,i=f):(typeof n.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{n=e.stateNode,Ig(t,e),f=e.memoizedProps,c=e.type===e.elementType?f:Lt(e.type,f),n.props=c,g=e.pendingProps,v=n.context,h=r.contextType,typeof h=="object"&&h!==null?h=xt(h):(h=_t(r)?or:tt.current,h=Br(e,h));var C=r.getDerivedStateFromProps;(p=typeof C=="function"||typeof n.getSnapshotBeforeUpdate=="function")||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(f!==g||v!==h)&&Uh(e,n,i,h),Tn=!1,v=e.memoizedState,n.state=v,Gl(e,i,n,l);var w=e.memoizedState;f!==g||v!==w||ht.current||Tn?(typeof C=="function"&&(Ou(e,r,C,i),w=e.memoizedState),(c=Tn||Lh(e,r,c,i,v,w,h)||!1)?(p||typeof n.UNSAFE_componentWillUpdate!="function"&&typeof n.componentWillUpdate!="function"||(typeof n.componentWillUpdate=="function"&&n.componentWillUpdate(i,w,h),typeof n.UNSAFE_componentWillUpdate=="function"&&n.UNSAFE_componentWillUpdate(i,w,h)),typeof n.componentDidUpdate=="function"&&(e.flags|=4),typeof n.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof n.componentDidUpdate!="function"||f===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||f===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=w),n.props=i,n.state=w,n.context=h,i=c):(typeof n.componentDidUpdate!="function"||f===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||f===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),i=!1)}return Nu(t,e,r,i,o,l)}function Nu(t,e,r,i,l,o){rm(t,e);var n=(e.flags&128)!==0;if(!i&&!n)return l&&Ph(e,r,!1),fn(t,e,o);i=e.stateNode,F0.current=e;var f=n&&typeof r.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&n?(e.child=qr(e,t.child,null,o),e.child=qr(e,null,f,o)):st(t,e,f,o),e.memoizedState=i.state,l&&Ph(e,r,!0),e.child}function im(t){var e=t.stateNode;e.pendingContext?Oh(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Oh(t,e.context,!1),Dc(t,e.containerInfo)}function Gh(t,e,r,i,l){return zr(),kc(l),e.flags|=256,st(t,e,r,i),e.child}var Mu={dehydrated:null,treeContext:null,retryLane:0};function Lu(t){return{baseLanes:t,cachePool:null,transitions:null}}function sm(t,e,r){var i=e.pendingProps,l=Re.current,o=!1,n=(e.flags&128)!==0,f;if((f=n)||(f=t!==null&&t.memoizedState===null?!1:(l&2)!==0),f?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(l|=1),ve(Re,l&1),t===null)return Iu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(n=i.children,t=i.fallback,o?(i=e.mode,o=e.child,n={mode:"hidden",children:n},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=n):o=wo(n,i,0,null),t=lr(t,i,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Lu(r),e.memoizedState=Mu,t):jc(e,n));if(l=t.memoizedState,l!==null&&(f=l.dehydrated,f!==null))return $0(t,e,n,i,f,l,r);if(o){o=i.fallback,n=e.mode,l=t.child,f=l.sibling;var h={mode:"hidden",children:i.children};return!(n&1)&&e.child!==l?(i=e.child,i.childLanes=0,i.pendingProps=h,e.deletions=null):(i=Nn(l,h),i.subtreeFlags=l.subtreeFlags&14680064),f!==null?o=Nn(f,o):(o=lr(o,n,r,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,n=t.child.memoizedState,n=n===null?Lu(r):{baseLanes:n.baseLanes|r,cachePool:null,transitions:n.transitions},o.memoizedState=n,o.childLanes=t.childLanes&~r,e.memoizedState=Mu,i}return o=t.child,t=o.sibling,i=Nn(o,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=r),i.return=e,i.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=i,e.memoizedState=null,i}function jc(t,e){return e=wo({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ws(t,e,r,i){return i!==null&&kc(i),qr(e,t.child,null,r),t=jc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $0(t,e,r,i,l,o,n){if(r)return e.flags&256?(e.flags&=-257,i=Ra(Error(V(422))),Ws(t,e,n,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=i.fallback,l=e.mode,i=wo({mode:"visible",children:i.children},l,0,null),o=lr(o,l,n,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,e.mode&1&&qr(e,t.child,null,n),e.child.memoizedState=Lu(n),e.memoizedState=Mu,o);if(!(e.mode&1))return Ws(t,e,n,null);if(l.data==="$!"){if(i=l.nextSibling&&l.nextSibling.dataset,i)var f=i.dgst;return i=f,o=Error(V(419)),i=Ra(o,i,void 0),Ws(t,e,n,i)}if(f=(n&t.childLanes)!==0,dt||f){if(i=Be,i!==null){switch(n&-n){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(i.suspendedLanes|n)?0:l,l!==0&&l!==o.retryLane&&(o.retryLane=l,cn(t,l),Ht(i,t,l,-1))}return Gc(),i=Ra(Error(V(421))),Ws(t,e,n,i)}return l.data==="$?"?(e.flags|=128,e.child=t.child,e=X0.bind(null,t),l._reactRetry=e,null):(t=o.treeContext,yt=On(l.nextSibling),St=e,Ae=!0,Ft=null,t!==null&&(kt[It++]=sn,kt[It++]=ln,kt[It++]=ar,sn=t.id,ln=t.overflow,ar=e),e=jc(e,i.children),e.flags|=4096,e)}function Kh(t,e,r){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),bu(t.return,e,r)}function ka(t,e,r,i,l){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:l}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=r,o.tailMode=l)}function lm(t,e,r){var i=e.pendingProps,l=i.revealOrder,o=i.tail;if(st(t,e,i.children,r),i=Re.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Kh(t,r,e);else if(t.tag===19)Kh(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ve(Re,i),!(e.mode&1))e.memoizedState=null;else switch(l){case"forwards":for(r=e.child,l=null;r!==null;)t=r.alternate,t!==null&&Kl(t)===null&&(l=r),r=r.sibling;r=l,r===null?(l=e.child,e.child=null):(l=r.sibling,r.sibling=null),ka(e,!1,l,r,o);break;case"backwards":for(r=null,l=e.child,e.child=null;l!==null;){if(t=l.alternate,t!==null&&Kl(t)===null){e.child=l;break}t=l.sibling,l.sibling=r,r=l,l=t}ka(e,!0,r,null,o);break;case"together":ka(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),cr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,r=Nn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Nn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function H0(t,e,r){switch(e.tag){case 3:im(e),zr();break;case 5:Dg(e);break;case 1:_t(e.type)&&Vl(e);break;case 4:Dc(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,l=e.memoizedProps.value;ve(ql,i._currentValue),i._currentValue=l;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ve(Re,Re.current&1),e.flags|=128,null):r&e.child.childLanes?sm(t,e,r):(ve(Re,Re.current&1),t=fn(t,e,r),t!==null?t.sibling:null);ve(Re,Re.current&1);break;case 19:if(i=(r&e.childLanes)!==0,t.flags&128){if(i)return lm(t,e,r);e.flags|=128}if(l=e.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),ve(Re,Re.current),i)break;return null;case 22:case 23:return e.lanes=0,nm(t,e,r)}return fn(t,e,r)}var om,Uu,am,um;om=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Uu=function(){};am=function(t,e,r,i){var l=t.memoizedProps;if(l!==i){t=e.stateNode,rr(Kt.current);var o=null;switch(r){case"input":l=su(t,l),i=su(t,i),o=[];break;case"select":l=Ie({},l,{value:void 0}),i=Ie({},i,{value:void 0}),o=[];break;case"textarea":l=au(t,l),i=au(t,i),o=[];break;default:typeof l.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Hl)}cu(r,i);var n;r=null;for(c in l)if(!i.hasOwnProperty(c)&&l.hasOwnProperty(c)&&l[c]!=null)if(c==="style"){var f=l[c];for(n in f)f.hasOwnProperty(n)&&(r||(r={}),r[n]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fi.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in i){var h=i[c];if(f=l!=null?l[c]:void 0,i.hasOwnProperty(c)&&h!==f&&(h!=null||f!=null))if(c==="style")if(f){for(n in f)!f.hasOwnProperty(n)||h&&h.hasOwnProperty(n)||(r||(r={}),r[n]="");for(n in h)h.hasOwnProperty(n)&&f[n]!==h[n]&&(r||(r={}),r[n]=h[n])}else r||(o||(o=[]),o.push(c,r)),r=h;else c==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,f=f?f.__html:void 0,h!=null&&f!==h&&(o=o||[]).push(c,h)):c==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(c,""+h):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fi.hasOwnProperty(c)?(h!=null&&c==="onScroll"&&Ce("scroll",t),o||f===h||(o=[])):(o=o||[]).push(c,h))}r&&(o=o||[]).push("style",r);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};um=function(t,e,r,i){r!==i&&(e.flags|=4)};function _i(t,e){if(!Ae)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ze(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,i=0;if(e)for(var l=t.child;l!==null;)r|=l.lanes|l.childLanes,i|=l.subtreeFlags&14680064,i|=l.flags&14680064,l.return=t,l=l.sibling;else for(l=t.child;l!==null;)r|=l.lanes|l.childLanes,i|=l.subtreeFlags,i|=l.flags,l.return=t,l=l.sibling;return t.subtreeFlags|=i,t.childLanes=r,e}function j0(t,e,r){var i=e.pendingProps;switch(Rc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(e),null;case 1:return _t(e.type)&&jl(),Ze(e),null;case 3:return i=e.stateNode,Wr(),Te(ht),Te(tt),Mc(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(zs(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ft!==null&&(qu(Ft),Ft=null))),Uu(t,e),Ze(e),null;case 5:Nc(e);var l=rr(Yi.current);if(r=e.type,t!==null&&e.stateNode!=null)am(t,e,r,i,l),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(V(166));return Ze(e),null}if(t=rr(Kt.current),zs(e)){i=e.stateNode,r=e.type;var o=e.memoizedProps;switch(i[Wt]=e,i[Ki]=o,t=(e.mode&1)!==0,r){case"dialog":Ce("cancel",i),Ce("close",i);break;case"iframe":case"object":case"embed":Ce("load",i);break;case"video":case"audio":for(l=0;l<ki.length;l++)Ce(ki[l],i);break;case"source":Ce("error",i);break;case"img":case"image":case"link":Ce("error",i),Ce("load",i);break;case"details":Ce("toggle",i);break;case"input":rh(i,o),Ce("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ce("invalid",i);break;case"textarea":sh(i,o),Ce("invalid",i)}cu(r,o),l=null;for(var n in o)if(o.hasOwnProperty(n)){var f=o[n];n==="children"?typeof f=="string"?i.textContent!==f&&(o.suppressHydrationWarning!==!0&&Bs(i.textContent,f,t),l=["children",f]):typeof f=="number"&&i.textContent!==""+f&&(o.suppressHydrationWarning!==!0&&Bs(i.textContent,f,t),l=["children",""+f]):Fi.hasOwnProperty(n)&&f!=null&&n==="onScroll"&&Ce("scroll",i)}switch(r){case"input":Ms(i),ih(i,o,!0);break;case"textarea":Ms(i),lh(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=Hl)}i=l,e.updateQueue=i,i!==null&&(e.flags|=4)}else{n=l.nodeType===9?l:l.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Lp(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=n.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=n.createElement(r,{is:i.is}):(t=n.createElement(r),r==="select"&&(n=t,i.multiple?n.multiple=!0:i.size&&(n.size=i.size))):t=n.createElementNS(t,r),t[Wt]=e,t[Ki]=i,om(t,e,!1,!1),e.stateNode=t;e:{switch(n=fu(r,i),r){case"dialog":Ce("cancel",t),Ce("close",t),l=i;break;case"iframe":case"object":case"embed":Ce("load",t),l=i;break;case"video":case"audio":for(l=0;l<ki.length;l++)Ce(ki[l],t);l=i;break;case"source":Ce("error",t),l=i;break;case"img":case"image":case"link":Ce("error",t),Ce("load",t),l=i;break;case"details":Ce("toggle",t),l=i;break;case"input":rh(t,i),l=su(t,i),Ce("invalid",t);break;case"option":l=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},l=Ie({},i,{value:void 0}),Ce("invalid",t);break;case"textarea":sh(t,i),l=au(t,i),Ce("invalid",t);break;default:l=i}cu(r,l),f=l;for(o in f)if(f.hasOwnProperty(o)){var h=f[o];o==="style"?$p(t,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&Up(t,h)):o==="children"?typeof h=="string"?(r!=="textarea"||h!=="")&&$i(t,h):typeof h=="number"&&$i(t,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Fi.hasOwnProperty(o)?h!=null&&o==="onScroll"&&Ce("scroll",t):h!=null&&fc(t,o,h,n))}switch(r){case"input":Ms(t),ih(t,i,!1);break;case"textarea":Ms(t),lh(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Mn(i.value));break;case"select":t.multiple=!!i.multiple,o=i.value,o!=null?Mr(t,!!i.multiple,o,!1):i.defaultValue!=null&&Mr(t,!!i.multiple,i.defaultValue,!0);break;default:typeof l.onClick=="function"&&(t.onclick=Hl)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ze(e),null;case 6:if(t&&e.stateNode!=null)um(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(V(166));if(r=rr(Yi.current),rr(Kt.current),zs(e)){if(i=e.stateNode,r=e.memoizedProps,i[Wt]=e,(o=i.nodeValue!==r)&&(t=St,t!==null))switch(t.tag){case 3:Bs(i.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bs(i.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[Wt]=e,e.stateNode=i}return Ze(e),null;case 13:if(Te(Re),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ae&&yt!==null&&e.mode&1&&!(e.flags&128))Rg(),zr(),e.flags|=98560,o=!1;else if(o=zs(e),i!==null&&i.dehydrated!==null){if(t===null){if(!o)throw Error(V(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(V(317));o[Wt]=e}else zr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ze(e),o=!1}else Ft!==null&&(qu(Ft),Ft=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Re.current&1?$e===0&&($e=3):Gc())),e.updateQueue!==null&&(e.flags|=4),Ze(e),null);case 4:return Wr(),Uu(t,e),t===null&&Wi(e.stateNode.containerInfo),Ze(e),null;case 10:return Oc(e.type._context),Ze(e),null;case 17:return _t(e.type)&&jl(),Ze(e),null;case 19:if(Te(Re),o=e.memoizedState,o===null)return Ze(e),null;if(i=(e.flags&128)!==0,n=o.rendering,n===null)if(i)_i(o,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(n=Kl(t),n!==null){for(e.flags|=128,_i(o,!1),i=n.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=r,r=e.child;r!==null;)o=r,t=i,o.flags&=14680066,n=o.alternate,n===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,o.type=n.type,t=n.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ve(Re,Re.current&1|2),e.child}t=t.sibling}o.tail!==null&&xe()>Kr&&(e.flags|=128,i=!0,_i(o,!1),e.lanes=4194304)}else{if(!i)if(t=Kl(n),t!==null){if(e.flags|=128,i=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),_i(o,!0),o.tail===null&&o.tailMode==="hidden"&&!n.alternate&&!Ae)return Ze(e),null}else 2*xe()-o.renderingStartTime>Kr&&r!==1073741824&&(e.flags|=128,i=!0,_i(o,!1),e.lanes=4194304);o.isBackwards?(n.sibling=e.child,e.child=n):(r=o.last,r!==null?r.sibling=n:e.child=n,o.last=n)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=xe(),e.sibling=null,r=Re.current,ve(Re,i?r&1|2:r&1),e):(Ze(e),null);case 22:case 23:return Wc(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?vt&1073741824&&(Ze(e),e.subtreeFlags&6&&(e.flags|=8192)):Ze(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function V0(t,e){switch(Rc(e),e.tag){case 1:return _t(e.type)&&jl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wr(),Te(ht),Te(tt),Mc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Nc(e),null;case 13:if(Te(Re),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));zr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Te(Re),null;case 4:return Wr(),null;case 10:return Oc(e.type._context),null;case 22:case 23:return Wc(),null;case 24:return null;default:return null}}var Gs=!1,et=!1,B0=typeof WeakSet=="function"?WeakSet:Set,Y=null;function xr(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){Oe(t,e,i)}else r.current=null}function Fu(t,e,r){try{r()}catch(i){Oe(t,e,i)}}var Qh=!1;function z0(t,e){if(Cu=Ul,t=hg(),Ec(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var l=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{r.nodeType,o.nodeType}catch(x){r=null;break e}var n=0,f=-1,h=-1,c=0,p=0,g=t,v=null;t:for(;;){for(var C;g!==r||l!==0&&g.nodeType!==3||(f=n+l),g!==o||i!==0&&g.nodeType!==3||(h=n+i),g.nodeType===3&&(n+=g.nodeValue.length),(C=g.firstChild)!==null;)v=g,g=C;for(;;){if(g===t)break t;if(v===r&&++c===l&&(f=n),v===o&&++p===i&&(h=n),(C=g.nextSibling)!==null)break;g=v,v=g.parentNode}g=C}r=f===-1||h===-1?null:{start:f,end:h}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tu={focusedElem:t,selectionRange:r},Ul=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var k=w.memoizedProps,F=w.memoizedState,T=e.stateNode,S=T.getSnapshotBeforeUpdate(e.elementType===e.type?k:Lt(e.type,k),F);T.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(x){Oe(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return w=Qh,Qh=!1,w}function Ni(t,e,r){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&t)===t){var o=l.destroy;l.destroy=void 0,o!==void 0&&Fu(e,r,o)}l=l.next}while(l!==i)}}function Co(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var i=r.create;r.destroy=i()}r=r.next}while(r!==e)}}function $u(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function cm(t){var e=t.alternate;e!==null&&(t.alternate=null,cm(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Wt],delete e[Ki],delete e[Au],delete e[R0],delete e[k0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fm(t){return t.tag===5||t.tag===3||t.tag===4}function Yh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fm(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hu(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Hl));else if(i!==4&&(t=t.child,t!==null))for(Hu(t,e,r),t=t.sibling;t!==null;)Hu(t,e,r),t=t.sibling}function ju(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(ju(t,e,r),t=t.sibling;t!==null;)ju(t,e,r),t=t.sibling}var We=null,Ut=!1;function vn(t,e,r){for(r=r.child;r!==null;)dm(t,e,r),r=r.sibling}function dm(t,e,r){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(ho,r)}catch(f){}switch(r.tag){case 5:et||xr(r,e);case 6:var i=We,l=Ut;We=null,vn(t,e,r),We=i,Ut=l,We!==null&&(Ut?(t=We,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):We.removeChild(r.stateNode));break;case 18:We!==null&&(Ut?(t=We,r=r.stateNode,t.nodeType===8?Sa(t.parentNode,r):t.nodeType===1&&Sa(t,r),Bi(t)):Sa(We,r.stateNode));break;case 4:i=We,l=Ut,We=r.stateNode.containerInfo,Ut=!0,vn(t,e,r),We=i,Ut=l;break;case 0:case 11:case 14:case 15:if(!et&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){l=i=i.next;do{var o=l,n=o.destroy;o=o.tag,n!==void 0&&(o&2||o&4)&&Fu(r,e,n),l=l.next}while(l!==i)}vn(t,e,r);break;case 1:if(!et&&(xr(r,e),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(f){Oe(r,e,f)}vn(t,e,r);break;case 21:vn(t,e,r);break;case 22:r.mode&1?(et=(i=et)||r.memoizedState!==null,vn(t,e,r),et=i):vn(t,e,r);break;default:vn(t,e,r)}}function Jh(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new B0),e.forEach(function(i){var l=Z0.bind(null,t,i);r.has(i)||(r.add(i),i.then(l,l))})}}function Nt(t,e){var r=e.deletions;if(r!==null)for(var i=0;i<r.length;i++){var l=r[i];try{var o=t,n=e,f=n;e:for(;f!==null;){switch(f.tag){case 5:We=f.stateNode,Ut=!1;break e;case 3:We=f.stateNode.containerInfo,Ut=!0;break e;case 4:We=f.stateNode.containerInfo,Ut=!0;break e}f=f.return}if(We===null)throw Error(V(160));dm(o,n,l),We=null,Ut=!1;var h=l.alternate;h!==null&&(h.return=null),l.return=null}catch(c){Oe(l,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)hm(e,t),e=e.sibling}function hm(t,e){var r=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Nt(e,t),Bt(t),i&4){try{Ni(3,t,t.return),Co(3,t)}catch(k){Oe(t,t.return,k)}try{Ni(5,t,t.return)}catch(k){Oe(t,t.return,k)}}break;case 1:Nt(e,t),Bt(t),i&512&&r!==null&&xr(r,r.return);break;case 5:if(Nt(e,t),Bt(t),i&512&&r!==null&&xr(r,r.return),t.flags&32){var l=t.stateNode;try{$i(l,"")}catch(k){Oe(t,t.return,k)}}if(i&4&&(l=t.stateNode,l!=null)){var o=t.memoizedProps,n=r!==null?r.memoizedProps:o,f=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{f==="input"&&o.type==="radio"&&o.name!=null&&Np(l,o),fu(f,n);var c=fu(f,o);for(n=0;n<h.length;n+=2){var p=h[n],g=h[n+1];p==="style"?$p(l,g):p==="dangerouslySetInnerHTML"?Up(l,g):p==="children"?$i(l,g):fc(l,p,g,c)}switch(f){case"input":lu(l,o);break;case"textarea":Mp(l,o);break;case"select":var v=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!o.multiple;var C=o.value;C!=null?Mr(l,!!o.multiple,C,!1):v!==!!o.multiple&&(o.defaultValue!=null?Mr(l,!!o.multiple,o.defaultValue,!0):Mr(l,!!o.multiple,o.multiple?[]:"",!1))}l[Ki]=o}catch(k){Oe(t,t.return,k)}}break;case 6:if(Nt(e,t),Bt(t),i&4){if(t.stateNode===null)throw Error(V(162));l=t.stateNode,o=t.memoizedProps;try{l.nodeValue=o}catch(k){Oe(t,t.return,k)}}break;case 3:if(Nt(e,t),Bt(t),i&4&&r!==null&&r.memoizedState.isDehydrated)try{Bi(e.containerInfo)}catch(k){Oe(t,t.return,k)}break;case 4:Nt(e,t),Bt(t);break;case 13:Nt(e,t),Bt(t),l=t.child,l.flags&8192&&(o=l.memoizedState!==null,l.stateNode.isHidden=o,!o||l.alternate!==null&&l.alternate.memoizedState!==null||(zc=xe())),i&4&&Jh(t);break;case 22:if(p=r!==null&&r.memoizedState!==null,t.mode&1?(et=(c=et)||p,Nt(e,t),et=c):Nt(e,t),Bt(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!p&&t.mode&1)for(Y=t,p=t.child;p!==null;){for(g=Y=p;Y!==null;){switch(v=Y,C=v.child,v.tag){case 0:case 11:case 14:case 15:Ni(4,v,v.return);break;case 1:xr(v,v.return);var w=v.stateNode;if(typeof w.componentWillUnmount=="function"){i=v,r=v.return;try{e=i,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(k){Oe(i,r,k)}}break;case 5:xr(v,v.return);break;case 22:if(v.memoizedState!==null){Zh(g);continue}}C!==null?(C.return=v,Y=C):Zh(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{l=g.stateNode,c?(o=l.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(f=g.stateNode,h=g.memoizedProps.style,n=h!=null&&h.hasOwnProperty("display")?h.display:null,f.style.display=Fp("display",n))}catch(k){Oe(t,t.return,k)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=c?"":g.memoizedProps}catch(k){Oe(t,t.return,k)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Nt(e,t),Bt(t),i&4&&Jh(t);break;case 21:break;default:Nt(e,t),Bt(t)}}function Bt(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(fm(r)){var i=r;break e}r=r.return}throw Error(V(160))}switch(i.tag){case 5:var l=i.stateNode;i.flags&32&&($i(l,""),i.flags&=-33);var o=Yh(t);ju(t,o,l);break;case 3:case 4:var n=i.stateNode.containerInfo,f=Yh(t);Hu(t,f,n);break;default:throw Error(V(161))}}catch(h){Oe(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function q0(t,e,r){Y=t,_m(t)}function _m(t,e,r){for(var i=(t.mode&1)!==0;Y!==null;){var l=Y,o=l.child;if(l.tag===22&&i){var n=l.memoizedState!==null||Gs;if(!n){var f=l.alternate,h=f!==null&&f.memoizedState!==null||et;f=Gs;var c=et;if(Gs=n,(et=h)&&!c)for(Y=l;Y!==null;)n=Y,h=n.child,n.tag===22&&n.memoizedState!==null?e_(l):h!==null?(h.return=n,Y=h):e_(l);for(;o!==null;)Y=o,_m(o),o=o.sibling;Y=l,Gs=f,et=c}Xh(t)}else l.subtreeFlags&8772&&o!==null?(o.return=l,Y=o):Xh(t)}}function Xh(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:et||Co(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!et)if(r===null)i.componentDidMount();else{var l=e.elementType===e.type?r.memoizedProps:Lt(e.type,r.memoizedProps);i.componentDidUpdate(l,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Mh(e,o,i);break;case 3:var n=e.updateQueue;if(n!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Mh(e,n,r)}break;case 5:var f=e.stateNode;if(r===null&&e.flags&4){r=f;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&r.focus();break;case"img":h.src&&(r.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var p=c.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&Bi(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}et||e.flags&512&&$u(e)}catch(v){Oe(e,e.return,v)}}if(e===t){Y=null;break}if(r=e.sibling,r!==null){r.return=e.return,Y=r;break}Y=e.return}}function Zh(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Y=r;break}Y=e.return}}function e_(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Co(4,e)}catch(h){Oe(e,r,h)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var l=e.return;try{i.componentDidMount()}catch(h){Oe(e,l,h)}}var o=e.return;try{$u(e)}catch(h){Oe(e,o,h)}break;case 5:var n=e.return;try{$u(e)}catch(h){Oe(e,n,h)}}}catch(h){Oe(e,e.return,h)}if(e===t){Y=null;break}var f=e.sibling;if(f!==null){f.return=e.return,Y=f;break}Y=e.return}}var W0=Math.ceil,Jl=dn.ReactCurrentDispatcher,Vc=dn.ReactCurrentOwner,Pt=dn.ReactCurrentBatchConfig,he=0,Be=null,Le=null,Qe=0,vt=0,Dr=$n(0),$e=0,es=null,cr=0,To=0,Bc=0,Mi=null,ft=null,zc=0,Kr=1/0,nn=null,Xl=!1,Vu=null,xn=null,Ks=!1,Rn=null,Zl=0,Li=0,Bu=null,gl=-1,ml=0;function lt(){return he&6?xe():gl!==-1?gl:gl=xe()}function Dn(t){return t.mode&1?he&2&&Qe!==0?Qe&-Qe:b0.transition!==null?(ml===0&&(ml=Jp()),ml):(t=pe,t!==0||(t=window.event,t=t===void 0?16:ig(t.type)),t):1}function Ht(t,e,r,i){if(50<Li)throw Li=0,Bu=null,Error(V(185));ss(t,r,i),(!(he&2)||t!==Be)&&(t===Be&&(!(he&2)&&(To|=r),$e===4&&En(t,Qe)),pt(t,i),r===1&&he===0&&!(e.mode&1)&&(Kr=xe()+500,vo&&Hn()))}function pt(t,e){var r=t.callbackNode;by(t,e);var i=Ll(t,t===Be?Qe:0);if(i===0)r!==null&&uh(r),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(r!=null&&uh(r),e===1)t.tag===0?I0(t_.bind(null,t)):wg(t_.bind(null,t)),E0(function(){!(he&6)&&Hn()}),r=null;else{switch(Xp(i)){case 1:r=gc;break;case 4:r=Qp;break;case 16:r=Ml;break;case 536870912:r=Yp;break;default:r=Ml}r=Tm(r,pm.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function pm(t,e){if(gl=-1,ml=0,he&6)throw Error(V(327));var r=t.callbackNode;if(Hr()&&t.callbackNode!==r)return null;var i=Ll(t,t===Be?Qe:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=eo(t,i);else{e=i;var l=he;he|=2;var o=mm();(Be!==t||Qe!==e)&&(nn=null,Kr=xe()+500,sr(t,e));do try{Q0();break}catch(f){gm(t,f)}while(1);bc(),Jl.current=o,he=l,Le!==null?e=0:(Be=null,Qe=0,e=$e)}if(e!==0){if(e===2&&(l=gu(t),l!==0&&(i=l,e=zu(t,l))),e===1)throw r=es,sr(t,0),En(t,i),pt(t,xe()),r;if(e===6)En(t,i);else{if(l=t.current.alternate,!(i&30)&&!G0(l)&&(e=eo(t,i),e===2&&(o=gu(t),o!==0&&(i=o,e=zu(t,o))),e===1))throw r=es,sr(t,0),En(t,i),pt(t,xe()),r;switch(t.finishedWork=l,t.finishedLanes=i,e){case 0:case 1:throw Error(V(345));case 2:Zn(t,ft,nn);break;case 3:if(En(t,i),(i&130023424)===i&&(e=zc+500-xe(),10<e)){if(Ll(t,0)!==0)break;if(l=t.suspendedLanes,(l&i)!==i){lt(),t.pingedLanes|=t.suspendedLanes&l;break}t.timeoutHandle=Eu(Zn.bind(null,t,ft,nn),e);break}Zn(t,ft,nn);break;case 4:if(En(t,i),(i&4194240)===i)break;for(e=t.eventTimes,l=-1;0<i;){var n=31-$t(i);o=1<<n,n=e[n],n>l&&(l=n),i&=~o}if(i=l,i=xe()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*W0(i/1960))-i,10<i){t.timeoutHandle=Eu(Zn.bind(null,t,ft,nn),i);break}Zn(t,ft,nn);break;case 5:Zn(t,ft,nn);break;default:throw Error(V(329))}}}return pt(t,xe()),t.callbackNode===r?pm.bind(null,t):null}function zu(t,e){var r=Mi;return t.current.memoizedState.isDehydrated&&(sr(t,e).flags|=256),t=eo(t,e),t!==2&&(e=ft,ft=r,e!==null&&qu(e)),t}function qu(t){ft===null?ft=t:ft.push.apply(ft,t)}function G0(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var l=r[i],o=l.getSnapshot;l=l.value;try{if(!jt(o(),l))return!1}catch(n){return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function En(t,e){for(e&=~Bc,e&=~To,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-$t(e),i=1<<r;t[r]=-1,e&=~i}}function t_(t){if(he&6)throw Error(V(327));Hr();var e=Ll(t,0);if(!(e&1))return pt(t,xe()),null;var r=eo(t,e);if(t.tag!==0&&r===2){var i=gu(t);i!==0&&(e=i,r=zu(t,i))}if(r===1)throw r=es,sr(t,0),En(t,e),pt(t,xe()),r;if(r===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zn(t,ft,nn),pt(t,xe()),null}function qc(t,e){var r=he;he|=1;try{return t(e)}finally{he=r,he===0&&(Kr=xe()+500,vo&&Hn())}}function fr(t){Rn!==null&&Rn.tag===0&&!(he&6)&&Hr();var e=he;he|=1;var r=Pt.transition,i=pe;try{if(Pt.transition=null,pe=1,t)return t()}finally{pe=i,Pt.transition=r,he=e,!(he&6)&&Hn()}}function Wc(){vt=Dr.current,Te(Dr)}function sr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,w0(r)),Le!==null)for(r=Le.return;r!==null;){var i=r;switch(Rc(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&jl();break;case 3:Wr(),Te(ht),Te(tt),Mc();break;case 5:Nc(i);break;case 4:Wr();break;case 13:Te(Re);break;case 19:Te(Re);break;case 10:Oc(i.type._context);break;case 22:case 23:Wc()}r=r.return}if(Be=t,Le=t=Nn(t.current,null),Qe=vt=e,$e=0,es=null,Bc=To=cr=0,ft=Mi=null,nr!==null){for(e=0;e<nr.length;e++)if(r=nr[e],i=r.interleaved,i!==null){r.interleaved=null;var l=i.next,o=r.pending;if(o!==null){var n=o.next;o.next=l,i.next=n}r.pending=i}nr=null}return t}function gm(t,e){do{var r=Le;try{if(bc(),hl.current=Yl,Ql){for(var i=ke.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}Ql=!1}if(ur=0,Ve=Fe=ke=null,Di=!1,Ji=0,Vc.current=null,r===null||r.return===null){$e=1,es=e,Le=null;break}e:{var o=t,n=r.return,f=r,h=e;if(e=Qe,f.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var c=h,p=f,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var v=p.alternate;v?(p.updateQueue=v.updateQueue,p.memoizedState=v.memoizedState,p.lanes=v.lanes):(p.updateQueue=null,p.memoizedState=null)}var C=Vh(n);if(C!==null){C.flags&=-257,Bh(C,n,f,o,e),C.mode&1&&jh(o,c,e),e=C,h=c;var w=e.updateQueue;if(w===null){var k=new Set;k.add(h),e.updateQueue=k}else w.add(h);break e}else{if(!(e&1)){jh(o,c,e),Gc();break e}h=Error(V(426))}}else if(Ae&&f.mode&1){var F=Vh(n);if(F!==null){!(F.flags&65536)&&(F.flags|=256),Bh(F,n,f,o,e),kc(Gr(h,f));break e}}o=h=Gr(h,f),$e!==4&&($e=2),Mi===null?Mi=[o]:Mi.push(o),o=n;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var T=Zg(o,h,e);Nh(o,T);break e;case 1:f=h;var S=o.type,E=o.stateNode;if(!(o.flags&128)&&(typeof S.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(xn===null||!xn.has(E)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=em(o,f,e);Nh(o,x);break e}}o=o.return}while(o!==null)}ym(r)}catch($){e=$,Le===r&&r!==null&&(Le=r=r.return);continue}break}while(1)}function mm(){var t=Jl.current;return Jl.current=Yl,t===null?Yl:t}function Gc(){($e===0||$e===3||$e===2)&&($e=4),Be===null||!(cr&268435455)&&!(To&268435455)||En(Be,Qe)}function eo(t,e){var r=he;he|=2;var i=mm();(Be!==t||Qe!==e)&&(nn=null,sr(t,e));do try{K0();break}catch(l){gm(t,l)}while(1);if(bc(),he=r,Jl.current=i,Le!==null)throw Error(V(261));return Be=null,Qe=0,$e}function K0(){for(;Le!==null;)vm(Le)}function Q0(){for(;Le!==null&&!Sy();)vm(Le)}function vm(t){var e=Cm(t.alternate,t,vt);t.memoizedProps=t.pendingProps,e===null?ym(t):Le=e,Vc.current=null}function ym(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=V0(r,e),r!==null){r.flags&=32767,Le=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,Le=null;return}}else if(r=j0(r,e,vt),r!==null){Le=r;return}if(e=e.sibling,e!==null){Le=e;return}Le=e=t}while(e!==null);$e===0&&($e=5)}function Zn(t,e,r){var i=pe,l=Pt.transition;try{Pt.transition=null,pe=1,Y0(t,e,r,i)}finally{Pt.transition=l,pe=i}return null}function Y0(t,e,r,i){do Hr();while(Rn!==null);if(he&6)throw Error(V(327));r=t.finishedWork;var l=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(Oy(t,o),t===Be&&(Le=Be=null,Qe=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ks||(Ks=!0,Tm(Ml,function(){return Hr(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Pt.transition,Pt.transition=null;var n=pe;pe=1;var f=he;he|=4,Vc.current=null,z0(t,r),hm(r,t),g0(Tu),Ul=!!Cu,Tu=Cu=null,t.current=r,q0(r),Cy(),he=f,pe=n,Pt.transition=o}else t.current=r;if(Ks&&(Ks=!1,Rn=t,Zl=l),o=t.pendingLanes,o===0&&(xn=null),Ey(r.stateNode),pt(t,xe()),e!==null)for(i=t.onRecoverableError,r=0;r<e.length;r++)l=e[r],i(l.value,{componentStack:l.stack,digest:l.digest});if(Xl)throw Xl=!1,t=Vu,Vu=null,t;return Zl&1&&t.tag!==0&&Hr(),o=t.pendingLanes,o&1?t===Bu?Li++:(Li=0,Bu=t):Li=0,Hn(),null}function Hr(){if(Rn!==null){var t=Xp(Zl),e=Pt.transition,r=pe;try{if(Pt.transition=null,pe=16>t?16:t,Rn===null)var i=!1;else{if(t=Rn,Rn=null,Zl=0,he&6)throw Error(V(331));var l=he;for(he|=4,Y=t.current;Y!==null;){var o=Y,n=o.child;if(Y.flags&16){var f=o.deletions;if(f!==null){for(var h=0;h<f.length;h++){var c=f[h];for(Y=c;Y!==null;){var p=Y;switch(p.tag){case 0:case 11:case 15:Ni(8,p,o)}var g=p.child;if(g!==null)g.return=p,Y=g;else for(;Y!==null;){p=Y;var v=p.sibling,C=p.return;if(cm(p),p===c){Y=null;break}if(v!==null){v.return=C,Y=v;break}Y=C}}}var w=o.alternate;if(w!==null){var k=w.child;if(k!==null){w.child=null;do{var F=k.sibling;k.sibling=null,k=F}while(k!==null)}}Y=o}}if(o.subtreeFlags&2064&&n!==null)n.return=o,Y=n;else e:for(;Y!==null;){if(o=Y,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ni(9,o,o.return)}var T=o.sibling;if(T!==null){T.return=o.return,Y=T;break e}Y=o.return}}var S=t.current;for(Y=S;Y!==null;){n=Y;var E=n.child;if(n.subtreeFlags&2064&&E!==null)E.return=n,Y=E;else e:for(n=S;Y!==null;){if(f=Y,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:Co(9,f)}}catch($){Oe(f,f.return,$)}if(f===n){Y=null;break e}var x=f.sibling;if(x!==null){x.return=f.return,Y=x;break e}Y=f.return}}if(he=l,Hn(),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(ho,t)}catch($){}i=!0}return i}finally{pe=r,Pt.transition=e}}return!1}function n_(t,e,r){e=Gr(r,e),e=Zg(t,e,1),t=Pn(t,e,1),e=lt(),t!==null&&(ss(t,1,e),pt(t,e))}function Oe(t,e,r){if(t.tag===3)n_(t,t,r);else for(;e!==null;){if(e.tag===3){n_(e,t,r);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(xn===null||!xn.has(i))){t=Gr(r,t),t=em(e,t,1),e=Pn(e,t,1),t=lt(),e!==null&&(ss(e,1,t),pt(e,t));break}}e=e.return}}function J0(t,e,r){var i=t.pingCache;i!==null&&i.delete(e),e=lt(),t.pingedLanes|=t.suspendedLanes&r,Be===t&&(Qe&r)===r&&($e===4||$e===3&&(Qe&130023424)===Qe&&500>xe()-zc?sr(t,0):Bc|=r),pt(t,e)}function Sm(t,e){e===0&&(t.mode&1?(e=Fs,Fs<<=1,!(Fs&130023424)&&(Fs=4194304)):e=1);var r=lt();t=cn(t,e),t!==null&&(ss(t,e,r),pt(t,r))}function X0(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Sm(t,r)}function Z0(t,e){var r=0;switch(t.tag){case 13:var i=t.stateNode,l=t.memoizedState;l!==null&&(r=l.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(V(314))}i!==null&&i.delete(e),Sm(t,r)}var Cm;Cm=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ht.current)dt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return dt=!1,H0(t,e,r);dt=!!(t.flags&131072)}else dt=!1,Ae&&e.flags&1048576&&Eg(e,zl,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;pl(t,e),t=e.pendingProps;var l=Br(e,tt.current);$r(e,r),l=Uc(null,e,i,t,l,r);var o=Fc();return e.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_t(i)?(o=!0,Vl(e)):o=!1,e.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,xc(e),l.updater=yo,e.stateNode=l,l._reactInternals=e,Pu(e,i,t,r),e=Nu(null,e,i,!0,o,r)):(e.tag=0,Ae&&o&&Ac(e),st(null,e,l,r),e=e.child),e;case 16:i=e.elementType;e:{switch(pl(t,e),t=e.pendingProps,l=i._init,i=l(i._payload),e.type=i,l=e.tag=tS(i),t=Lt(i,t),l){case 0:e=Du(null,e,i,t,r);break e;case 1:e=Wh(null,e,i,t,r);break e;case 11:e=zh(null,e,i,t,r);break e;case 14:e=qh(null,e,i,Lt(i.type,t),r);break e}throw Error(V(306,i,""))}return e;case 0:return i=e.type,l=e.pendingProps,l=e.elementType===i?l:Lt(i,l),Du(t,e,i,l,r);case 1:return i=e.type,l=e.pendingProps,l=e.elementType===i?l:Lt(i,l),Wh(t,e,i,l,r);case 3:e:{if(im(e),t===null)throw Error(V(387));i=e.pendingProps,o=e.memoizedState,l=o.element,Ig(t,e),Gl(e,i,null,r);var n=e.memoizedState;if(i=n.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:n.cache,pendingSuspenseBoundaries:n.pendingSuspenseBoundaries,transitions:n.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){l=Gr(Error(V(423)),e),e=Gh(t,e,i,r,l);break e}else if(i!==l){l=Gr(Error(V(424)),e),e=Gh(t,e,i,r,l);break e}else for(yt=On(e.stateNode.containerInfo.firstChild),St=e,Ae=!0,Ft=null,r=xg(e,null,i,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(zr(),i===l){e=fn(t,e,r);break e}st(t,e,i,r)}e=e.child}return e;case 5:return Dg(e),t===null&&Iu(e),i=e.type,l=e.pendingProps,o=t!==null?t.memoizedProps:null,n=l.children,wu(i,l)?n=null:o!==null&&wu(i,o)&&(e.flags|=32),rm(t,e),st(t,e,n,r),e.child;case 6:return t===null&&Iu(e),null;case 13:return sm(t,e,r);case 4:return Dc(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=qr(e,null,i,r):st(t,e,i,r),e.child;case 11:return i=e.type,l=e.pendingProps,l=e.elementType===i?l:Lt(i,l),zh(t,e,i,l,r);case 7:return st(t,e,e.pendingProps,r),e.child;case 8:return st(t,e,e.pendingProps.children,r),e.child;case 12:return st(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(i=e.type._context,l=e.pendingProps,o=e.memoizedProps,n=l.value,ve(ql,i._currentValue),i._currentValue=n,o!==null)if(jt(o.value,n)){if(o.children===l.children&&!ht.current){e=fn(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var f=o.dependencies;if(f!==null){n=o.child;for(var h=f.firstContext;h!==null;){if(h.context===i){if(o.tag===1){h=on(-1,r&-r),h.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var p=c.pending;p===null?h.next=h:(h.next=p.next,p.next=h),c.pending=h}}o.lanes|=r,h=o.alternate,h!==null&&(h.lanes|=r),bu(o.return,r,e),f.lanes|=r;break}h=h.next}}else if(o.tag===10)n=o.type===e.type?null:o.child;else if(o.tag===18){if(n=o.return,n===null)throw Error(V(341));n.lanes|=r,f=n.alternate,f!==null&&(f.lanes|=r),bu(n,r,e),n=o.sibling}else n=o.child;if(n!==null)n.return=o;else for(n=o;n!==null;){if(n===e){n=null;break}if(o=n.sibling,o!==null){o.return=n.return,n=o;break}n=n.return}o=n}st(t,e,l.children,r),e=e.child}return e;case 9:return l=e.type,i=e.pendingProps.children,$r(e,r),l=xt(l),i=i(l),e.flags|=1,st(t,e,i,r),e.child;case 14:return i=e.type,l=Lt(i,e.pendingProps),l=Lt(i.type,l),qh(t,e,i,l,r);case 15:return tm(t,e,e.type,e.pendingProps,r);case 17:return i=e.type,l=e.pendingProps,l=e.elementType===i?l:Lt(i,l),pl(t,e),e.tag=1,_t(i)?(t=!0,Vl(e)):t=!1,$r(e,r),Og(e,i,l),Pu(e,i,l,r),Nu(null,e,i,!0,t,r);case 19:return lm(t,e,r);case 22:return nm(t,e,r)}throw Error(V(156,e.tag))};function Tm(t,e){return Kp(t,e)}function eS(t,e,r,i){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(t,e,r,i){return new eS(t,e,r,i)}function Kc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tS(t){if(typeof t=="function")return Kc(t)?1:0;if(t!=null){if(t=t.$typeof,t===hc)return 11;if(t===_c)return 14}return 2}function Nn(t,e){var r=t.alternate;return r===null?(r=Ot(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function vl(t,e,r,i,l,o){var n=2;if(i=t,typeof t=="function")Kc(t)&&(n=1);else if(typeof t=="string")n=5;else e:switch(t){case wr:return lr(r.children,l,o,e);case dc:n=8,l|=8;break;case tu:return t=Ot(12,r,e,l|2),t.elementType=tu,t.lanes=o,t;case nu:return t=Ot(13,r,e,l),t.elementType=nu,t.lanes=o,t;case ru:return t=Ot(19,r,e,l),t.elementType=ru,t.lanes=o,t;case Pp:return wo(r,l,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$typeof){case bp:n=10;break e;case Op:n=9;break e;case hc:n=11;break e;case _c:n=14;break e;case Cn:n=16,i=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=Ot(n,r,e,l),e.elementType=t,e.type=i,e.lanes=o,e}function lr(t,e,r,i){return t=Ot(7,t,i,e),t.lanes=r,t}function wo(t,e,r,i){return t=Ot(22,t,i,e),t.elementType=Pp,t.lanes=r,t.stateNode={isHidden:!1},t}function Ia(t,e,r){return t=Ot(6,t,null,e),t.lanes=r,t}function ba(t,e,r){return e=Ot(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function nS(t,e,r,i,l){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ua(0),this.expirationTimes=ua(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ua(0),this.identifierPrefix=i,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Qc(t,e,r,i,l,o,n,f,h){return t=new nS(t,e,r,f,h),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ot(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xc(o),t}function rS(t,e,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$typeof:Tr,key:i==null?null:""+i,children:t,containerInfo:e,implementation:r}}function wm(t){if(!t)return Ln;t=t._reactInternals;e:{if(hr(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_t(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var r=t.type;if(_t(r))return Tg(t,r,e)}return e}function Em(t,e,r,i,l,o,n,f,h){return t=Qc(r,i,!0,t,l,o,n,f,h),t.context=wm(null),r=t.current,i=lt(),l=Dn(r),o=on(i,l),o.callback=e!=null?e:null,Pn(r,o,l),t.current.lanes=l,ss(t,l,i),pt(t,i),t}function Eo(t,e,r,i){var l=e.current,o=lt(),n=Dn(l);return r=wm(r),e.context===null?e.context=r:e.pendingContext=r,e=on(o,n),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Pn(l,e,n),t!==null&&(Ht(t,l,n,o),dl(t,l,n)),n}function to(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function r_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Yc(t,e){r_(t,e),(t=t.alternate)&&r_(t,e)}function iS(){return null}var Am=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jc(t){this._internalRoot=t}Ao.prototype.render=Jc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));Eo(t,e,null,null)};Ao.prototype.unmount=Jc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fr(function(){Eo(null,t,null,null)}),e[un]=null}};function Ao(t){this._internalRoot=t}Ao.prototype.unstable_scheduleHydration=function(t){if(t){var e=tg();t={blockedOn:null,target:t,priority:e};for(var r=0;r<wn.length&&e!==0&&e<wn[r].priority;r++);wn.splice(r,0,t),r===0&&rg(t)}};function Xc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ro(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function i_(){}function sS(t,e,r,i,l){if(l){if(typeof i=="function"){var o=i;i=function(){var c=to(n);o.call(c)}}var n=Em(e,i,t,0,null,!1,!1,"",i_);return t._reactRootContainer=n,t[un]=n.current,Wi(t.nodeType===8?t.parentNode:t),fr(),n}for(;l=t.lastChild;)t.removeChild(l);if(typeof i=="function"){var f=i;i=function(){var c=to(h);f.call(c)}}var h=Qc(t,0,!1,null,null,!1,!1,"",i_);return t._reactRootContainer=h,t[un]=h.current,Wi(t.nodeType===8?t.parentNode:t),fr(function(){Eo(e,h,r,i)}),h}function ko(t,e,r,i,l){var o=r._reactRootContainer;if(o){var n=o;if(typeof l=="function"){var f=l;l=function(){var h=to(n);f.call(h)}}Eo(e,n,t,l)}else n=sS(r,e,t,l,i);return to(n)}Zp=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ri(e.pendingLanes);r!==0&&(mc(e,r|1),pt(e,xe()),!(he&6)&&(Kr=xe()+500,Hn()))}break;case 13:fr(function(){var i=cn(t,1);if(i!==null){var l=lt();Ht(i,t,1,l)}}),Yc(t,1)}};vc=function(t){if(t.tag===13){var e=cn(t,134217728);if(e!==null){var r=lt();Ht(e,t,134217728,r)}Yc(t,134217728)}};eg=function(t){if(t.tag===13){var e=Dn(t),r=cn(t,e);if(r!==null){var i=lt();Ht(r,t,e,i)}Yc(t,e)}};tg=function(){return pe};ng=function(t,e){var r=pe;try{return pe=t,e()}finally{pe=r}};hu=function(t,e,r){switch(e){case"input":if(lu(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var i=r[e];if(i!==t&&i.form===t.form){var l=mo(i);if(!l)throw Error(V(90));Dp(i),lu(i,l)}}}break;case"textarea":Mp(t,r);break;case"select":e=r.value,e!=null&&Mr(t,!!r.multiple,e,!1)}};Vp=qc;Bp=fr;var lS={usingClientEntryPoint:!1,Events:[os,kr,mo,Hp,jp,qc]},pi={findFiberByHostInstance:tr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},oS={bundleType:pi.bundleType,version:pi.version,rendererPackageName:pi.rendererPackageName,rendererConfig:pi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Wp(t),t===null?null:t.stateNode},findFiberByHostInstance:pi.findFiberByHostInstance||iS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var Qs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qs.isDisabled&&Qs.supportsFiber)try{ho=Qs.inject(oS),Gt=Qs}catch(t){}}Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lS;Tt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xc(e))throw Error(V(200));return rS(t,e,null,r)};Tt.createRoot=function(t,e){if(!Xc(t))throw Error(V(299));var r=!1,i="",l=Am;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(l=e.onRecoverableError)),e=Qc(t,1,!1,null,null,r,!1,i,l),t[un]=e.current,Wi(t.nodeType===8?t.parentNode:t),new Jc(e)};Tt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=Wp(e),t=t===null?null:t.stateNode,t};Tt.flushSync=function(t){return fr(t)};Tt.hydrate=function(t,e,r){if(!Ro(e))throw Error(V(200));return ko(null,t,e,!0,r)};Tt.hydrateRoot=function(t,e,r){if(!Xc(t))throw Error(V(405));var i=r!=null&&r.hydratedSources||null,l=!1,o="",n=Am;if(r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(n=r.onRecoverableError)),e=Em(e,null,t,1,r!=null?r:null,l,!1,o,n),t[un]=e.current,Wi(t),i)for(t=0;t<i.length;t++)r=i[t],l=r._getVersion,l=l(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,l]:e.mutableSourceEagerHydrationData.push(r,l);return new Ao(e)};Tt.render=function(t,e,r){if(!Ro(e))throw Error(V(200));return ko(null,t,e,!1,r)};Tt.unmountComponentAtNode=function(t){if(!Ro(t))throw Error(V(40));return t._reactRootContainer?(fr(function(){ko(null,null,t,!1,function(){t._reactRootContainer=null,t[un]=null})}),!0):!1};Tt.unstable_batchedUpdates=qc;Tt.unstable_renderSubtreeIntoContainer=function(t,e,r,i){if(!Ro(r))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return ko(t,e,r,!1,i)};Tt.version="18.2.0-next-9e3b772b8-20220608";function Rm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rm)}catch(t){console.error(t)}}Rm(),Ep.exports=Tt;var aS=Ep.exports,s_=aS;Za.createRoot=s_.createRoot,Za.hydrateRoot=s_.hydrateRoot;const uS="jssip",cS="JsSIP",fS="the Javascript SIP library",dS="3.10.0",hS="https://jssip.net",_S=["Jos Luis Milln <jmillan@aliax.net> (https://github.com/jmillan)","Iaki Baz Castillo <ibc@aliax.net> (https://inakibaz.me)"],pS="lib/JsSIP.d.ts",gS="lib-es5/JsSIP.js",mS=["sip","websocket","webrtc","node","browser","library"],vS="MIT",yS={type:"git",url:"https://github.com/versatica/JsSIP.git"},SS={url:"https://github.com/versatica/JsSIP/issues"},CS={"@types/events":"^3.0.0","@types/debug":"^4.1.7",debug:"^4.3.1",events:"^3.3.0","sdp-transform":"^2.14.1"},TS={"@babel/core":"^7.19.6","@babel/preset-env":"^7.19.4","ansi-colors":"^3.2.4",browserify:"^16.5.1",eslint:"^5.16.0","fancy-log":"^1.3.3",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.2","gulp-header":"^2.0.9","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4",pegjs:"^0.7.0","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},wS={lint:"node npm-scripts.js lint",test:"node npm-scripts.js test",prepublish:"node npm-scripts.js prepublish",release:"node npm-scripts.js release"},km={name:uS,title:cS,description:fS,version:dS,homepage:hS,contributors:_S,types:pS,main:gS,keywords:mS,license:vS,repository:yS,bugs:SS,dependencies:CS,devDependencies:TS,scripts:wS};var l_=km,Ue={USER_AGENT:"".concat(l_.title," ").concat(l_.version),SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484,424],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",REFER:"REFER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",DTMF_TRANSPORT:{INFO:"INFO",RFC2833:"RFC2833"},REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",424:"Bad Location Information",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69,SESSION_EXPIRES:90,MIN_SESSION_EXPIRES:60,CONNECTION_RECOVERY_MAX_INTERVAL:30,CONNECTION_RECOVERY_MIN_INTERVAL:2};function yl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yl=function(r){return typeof r}:yl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yl(t)}function Io(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bo(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ts(t,e)}function Oo(t){var e=Im();return function(){var i=ns(t),l;if(e){var o=ns(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return ES(this,l)}}function ES(t,e){return e&&(yl(e)==="object"||typeof e=="function")?e:AS(t)}function AS(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qr(t){var e=typeof Map=="function"?new Map:void 0;return Qr=function(i){if(i===null||!RS(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e!="undefined"){if(e.has(i))return e.get(i);e.set(i,l)}function l(){return Sl(i,arguments,ns(this).constructor)}return l.prototype=Object.create(i.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),ts(l,i)},Qr(t)}function Sl(t,e,r){return Im()?Sl=Reflect.construct:Sl=function(l,o,n){var f=[null];f.push.apply(f,o);var h=Function.bind.apply(l,f),c=new h;return n&&ts(c,n.prototype),c},Sl.apply(null,arguments)}function Im(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function RS(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function ts(t,e){return ts=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},ts(t,e)}function ns(t){return ns=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ns(t)}var kS=function(t){bo(r,t);var e=Oo(r);function r(i,l){var o;return Io(this,r),o=e.call(this),o.code=1,o.name="CONFIGURATION_ERROR",o.parameter=i,o.value=l,o.message=o.value?"Invalid value ".concat(JSON.stringify(o.value),' for parameter "').concat(o.parameter,'"'):"Missing parameter: ".concat(o.parameter),o}return r}(Qr(Error)),IS=function(t){bo(r,t);var e=Oo(r);function r(i){var l;return Io(this,r),l=e.call(this),l.code=2,l.name="INVALID_STATE_ERROR",l.status=i,l.message="Invalid status: ".concat(i),l}return r}(Qr(Error)),bS=function(t){bo(r,t);var e=Oo(r);function r(i){var l;return Io(this,r),l=e.call(this),l.code=3,l.name="NOT_SUPPORTED_ERROR",l.message=i,l}return r}(Qr(Error)),OS=function(t){bo(r,t);var e=Oo(r);function r(i){var l;return Io(this,r),l=e.call(this),l.code=4,l.name="NOT_READY_ERROR",l.message=i,l}return r}(Qr(Error)),jn={ConfigurationError:kS,InvalidStateError:IS,NotSupportedError:bS,NotReadyError:OS},Pe={},Oa,o_;function Zc(){if(o_)return Oa;o_=1;function t(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")}function e(o,n){for(var f=0;f<n.length;f++){var h=n[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function r(o,n,f){return n&&e(o.prototype,n),f&&e(o,f),o}var i=Vn(),l=Yt();return Oa=function(){r(o,null,[{key:"parse",value:function(f){if(f=l.parse(f,"Name_Addr_Header"),f!==-1)return f}}]);function o(n,f,h){if(t(this,o),!n||!(n instanceof i))throw new TypeError('missing or invalid "uri" parameter');this._uri=n,this._parameters={},this.display_name=f;for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&this.setParam(c,h[c])}return r(o,[{key:"setParam",value:function(f,h){f&&(this._parameters[f.toLowerCase()]=typeof h=="undefined"||h===null?null:h.toString())}},{key:"getParam",value:function(f){if(f)return this._parameters[f.toLowerCase()]}},{key:"hasParam",value:function(f){if(f)return this._parameters.hasOwnProperty(f.toLowerCase())&&!0||!1}},{key:"deleteParam",value:function(f){if(f=f.toLowerCase(),this._parameters.hasOwnProperty(f)){var h=this._parameters[f];return delete this._parameters[f],h}}},{key:"clearParams",value:function(){this._parameters={}}},{key:"clone",value:function(){return new o(this._uri.clone(),this._display_name,JSON.parse(JSON.stringify(this._parameters)))}},{key:"_quote",value:function(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}},{key:"toString",value:function(){var f=this._display_name?'"'.concat(this._quote(this._display_name),'" '):"";f+="<".concat(this._uri.toString(),">");for(var h in this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,h)&&(f+=";".concat(h),this._parameters[h]!==null&&(f+="=".concat(this._parameters[h])));return f}},{key:"uri",get:function(){return this._uri}},{key:"display_name",get:function(){return this._display_name},set:function(f){this._display_name=f===0?"0":f}}]),o}(),Oa}var Pa,a_;function Yt(){return a_||(a_=1,Pa=function(){function t(r){return'"'+r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var e={parse:function(i,l){var o={CRLF:p,DIGIT:g,ALPHA:v,HEXDIG:C,WSP:w,OCTET:k,DQUOTE:F,SP:T,HTAB:S,alphanum:E,reserved:x,unreserved:$,mark:W,escaped:z,LWS:I,SWS:D,HCOLON:re,TEXT_UTF8_TRIM:De,TEXT_UTF8char:He,UTF8_NONASCII:ae,UTF8_CONT:H,LHEX:B,token:O,token_nodot:j,separators:Q,word:ee,STAR:ie,SLASH:_e,EQUAL:te,LPAREN:Et,RPAREN:rt,RAQUOT:At,LAQUOT:Je,COMMA:de,SEMI:ue,COLON:zn,LDQUOT:_n,RDQUOT:pn,comment:gn,ctext:mn,quoted_string:pr,quoted_string_clean:se,qdtext:ne,quoted_pair:oe,SIP_URI_noparams:fe,SIP_URI:be,uri_scheme:je,uri_scheme_sips:we,uri_scheme_sip:qn,userinfo:ut,user:cf,user_unreserved:Do,password:ff,hostport:vs,host:Zr,hostname:No,domainlabel:Mo,toplabel:df,IPv6reference:Lo,IPv6address:Uo,h16:J,ls32:gt,IPv4address:ei,dec_octet:ti,port:hf,uri_parameters:_f,uri_parameter:Fo,transport_param:pf,user_param:gf,method_param:mf,ttl_param:vf,maddr_param:yf,lr_param:Sf,other_param:Cf,pname:Tf,pvalue:wf,paramchar:ni,param_unreserved:Ef,headers:Af,header:ys,hname:Rf,hvalue:kf,hnv_unreserved:ri,Request_Response:Qm,Request_Line:If,Request_URI:bf,absoluteURI:$o,hier_part:Of,net_path:Pf,abs_path:Ss,opaque_part:xf,uric:ii,uric_no_slash:Df,path_segments:Nf,segment:Cs,param:Ho,pchar:si,scheme:Mf,authority:Lf,srvr:Uf,reg_name:Ff,query:$f,SIP_Version:jo,INVITEm:Hf,ACKm:jf,OPTIONSm:Vf,BYEm:Bf,CANCELm:zf,REGISTERm:qf,SUBSCRIBEm:Wf,NOTIFYm:Gf,REFERm:Kf,Method:Ts,Status_Line:Qf,Status_Code:Yf,extension_code:Jf,Reason_Phrase:Xf,Allow_Events:Ym,Call_ID:Jm,Contact:Xm,contact_param:ws,name_addr:Wn,display_name:Es,contact_params:Vo,c_p_q:Zf,c_p_expires:ed,delta_seconds:Gn,qvalue:td,generic_param:Ne,gen_value:nd,Content_Disposition:Zm,disp_type:rd,disp_param:Bo,handling_param:id,Content_Encoding:ev,Content_Length:tv,Content_Type:nv,media_type:sd,m_type:ld,discrete_type:od,composite_type:ad,extension_token:As,x_token:ud,m_subtype:cd,m_parameter:zo,m_value:fd,CSeq:rv,CSeq_value:dd,Expires:iv,Event:sv,event_type:li,From:lv,from_param:qo,tag_param:Wo,Max_Forwards:ov,Min_Expires:av,Name_Addr_Header:uv,Proxy_Authenticate:cv,challenge:Go,other_challenge:hd,auth_param:oi,digest_cln:Rs,realm:_d,realm_value:pd,domain:gd,URI:ks,nonce:md,nonce_value:vd,opaque:yd,stale:Sd,algorithm:Cd,qop_options:Td,qop_value:Is,Proxy_Require:fv,Record_Route:dv,rec_route:bs,Reason:hv,reason_param:Ko,reason_cause:wd,Require:_v,Route:pv,route_param:Os,Subscription_State:gv,substate_value:Ed,subexp_params:Qo,event_reason_value:Ad,Subject:mv,Supported:vv,To:yv,to_param:Yo,Via:Sv,via_param:Ps,via_params:Jo,via_ttl:Rd,via_maddr:kd,via_received:Id,via_branch:bd,response_port:Od,rport:Pd,sent_protocol:xd,protocol_name:Dd,transport:Nd,sent_by:Md,via_host:Ld,via_port:Ud,ttl:Xo,WWW_Authenticate:Cv,Session_Expires:Tv,s_e_expires:Fd,s_e_params:Zo,s_e_refresher:$d,extension_header:wv,header_value:Hd,message_body:Ev,uuid_URI:Av,uuid:jd,hex4:Xt,hex8:Vd,hex12:Bd,Refer_To:Rv,Replaces:kv,call_id:zd,replaces_param:ea,to_tag:qd,from_tag:Wd,early_flag:Gd};if(l!==void 0){if(o[l]===void 0)throw new Error("Invalid rule name: "+t(l)+".")}else l="CRLF";var n=0,f=0,h=[];function c(s){n<f||(n>f&&(f=n,h=[]),h.push(s))}function p(){var s;return i.substr(n,2)===`\r
`?(s=`\r
`,n+=2):(s=null,c('"\\r\\n"')),s}function g(){var s;return/^[0-9]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[0-9]")),s}function v(){var s;return/^[a-zA-Z]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[a-zA-Z]")),s}function C(){var s;return/^[0-9a-fA-F]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[0-9a-fA-F]")),s}function w(){var s;return s=T(),s===null&&(s=S()),s}function k(){var s;return/^[\0-\xFF]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[\\0-\\xFF]")),s}function F(){var s;return/^["]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c('["]')),s}function T(){var s;return i.charCodeAt(n)===32?(s=" ",n++):(s=null,c('" "')),s}function S(){var s;return i.charCodeAt(n)===9?(s="	",n++):(s=null,c('"\\t"')),s}function E(){var s;return/^[a-zA-Z0-9]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[a-zA-Z0-9]")),s}function x(){var s;return i.charCodeAt(n)===59?(s=";",n++):(s=null,c('";"')),s===null&&(i.charCodeAt(n)===47?(s="/",n++):(s=null,c('"/"')),s===null&&(i.charCodeAt(n)===63?(s="?",n++):(s=null,c('"?"')),s===null&&(i.charCodeAt(n)===58?(s=":",n++):(s=null,c('":"')),s===null&&(i.charCodeAt(n)===64?(s="@",n++):(s=null,c('"@"')),s===null&&(i.charCodeAt(n)===38?(s="&",n++):(s=null,c('"&"')),s===null&&(i.charCodeAt(n)===61?(s="=",n++):(s=null,c('"="')),s===null&&(i.charCodeAt(n)===43?(s="+",n++):(s=null,c('"+"')),s===null&&(i.charCodeAt(n)===36?(s="$",n++):(s=null,c('"$"')),s===null&&(i.charCodeAt(n)===44?(s=",",n++):(s=null,c('","'))))))))))),s}function $(){var s;return s=E(),s===null&&(s=W()),s}function W(){var s;return i.charCodeAt(n)===45?(s="-",n++):(s=null,c('"-"')),s===null&&(i.charCodeAt(n)===95?(s="_",n++):(s=null,c('"_"')),s===null&&(i.charCodeAt(n)===46?(s=".",n++):(s=null,c('"."')),s===null&&(i.charCodeAt(n)===33?(s="!",n++):(s=null,c('"!"')),s===null&&(i.charCodeAt(n)===126?(s="~",n++):(s=null,c('"~"')),s===null&&(i.charCodeAt(n)===42?(s="*",n++):(s=null,c('"*"')),s===null&&(i.charCodeAt(n)===39?(s="'",n++):(s=null,c(`"'"`)),s===null&&(i.charCodeAt(n)===40?(s="(",n++):(s=null,c('"("')),s===null&&(i.charCodeAt(n)===41?(s=")",n++):(s=null,c('")"')))))))))),s}function z(){var s,a,u,d,_;return d=n,_=n,i.charCodeAt(n)===37?(s="%",n++):(s=null,c('"%"')),s!==null?(a=C(),a!==null?(u=C(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){return y.join("")}(d,s)),s===null&&(n=d),s}function I(){var s,a,u,d,_,m;for(d=n,_=n,m=n,s=[],a=w();a!==null;)s.push(a),a=w();if(s!==null?(a=p(),a!==null?s=[s,a]:(s=null,n=m)):(s=null,n=m),s=s!==null?s:"",s!==null){if(u=w(),u!==null)for(a=[];u!==null;)a.push(u),u=w();else a=null;a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s!==null&&(s=function(y){return" "}()),s===null&&(n=d),s}function D(){var s;return s=I(),s=s!==null?s:"",s}function re(){var s,a,u,d,_;for(d=n,_=n,s=[],a=T(),a===null&&(a=S());a!==null;)s.push(a),a=T(),a===null&&(a=S());return s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return":"}()),s===null&&(n=d),s}function De(){var s,a,u,d,_,m,y;if(_=n,m=n,a=He(),a!==null)for(s=[];a!==null;)s.push(a),a=He();else s=null;if(s!==null){for(a=[],y=n,u=[],d=I();d!==null;)u.push(d),d=I();for(u!==null?(d=He(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;){for(a.push(u),y=n,u=[],d=I();d!==null;)u.push(d),d=I();u!==null?(d=He(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y)}a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){return i.substring(n,b)}(_)),s===null&&(n=_),s}function He(){var s;return/^[!-~]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[!-~]")),s===null&&(s=ae()),s}function ae(){var s;return/^[\x80-\uFFFF]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[\\x80-\\uFFFF]")),s}function H(){var s;return/^[\x80-\xBF]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[\\x80-\\xBF]")),s}function B(){var s;return s=g(),s===null&&(/^[a-f]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[a-f]"))),s}function O(){var s,a,u;if(u=n,a=E(),a===null&&(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a===null&&(i.charCodeAt(n)===46?(a=".",n++):(a=null,c('"."')),a===null&&(i.charCodeAt(n)===33?(a="!",n++):(a=null,c('"!"')),a===null&&(i.charCodeAt(n)===37?(a="%",n++):(a=null,c('"%"')),a===null&&(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a===null&&(i.charCodeAt(n)===95?(a="_",n++):(a=null,c('"_"')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===96?(a="`",n++):(a=null,c('"`"')),a===null&&(i.charCodeAt(n)===39?(a="'",n++):(a=null,c(`"'"`)),a===null&&(i.charCodeAt(n)===126?(a="~",n++):(a=null,c('"~"')))))))))))),a!==null)for(s=[];a!==null;)s.push(a),a=E(),a===null&&(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a===null&&(i.charCodeAt(n)===46?(a=".",n++):(a=null,c('"."')),a===null&&(i.charCodeAt(n)===33?(a="!",n++):(a=null,c('"!"')),a===null&&(i.charCodeAt(n)===37?(a="%",n++):(a=null,c('"%"')),a===null&&(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a===null&&(i.charCodeAt(n)===95?(a="_",n++):(a=null,c('"_"')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===96?(a="`",n++):(a=null,c('"`"')),a===null&&(i.charCodeAt(n)===39?(a="'",n++):(a=null,c(`"'"`)),a===null&&(i.charCodeAt(n)===126?(a="~",n++):(a=null,c('"~"'))))))))))));else s=null;return s!==null&&(s=function(d){return i.substring(n,d)}(u)),s===null&&(n=u),s}function j(){var s,a,u;if(u=n,a=E(),a===null&&(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a===null&&(i.charCodeAt(n)===33?(a="!",n++):(a=null,c('"!"')),a===null&&(i.charCodeAt(n)===37?(a="%",n++):(a=null,c('"%"')),a===null&&(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a===null&&(i.charCodeAt(n)===95?(a="_",n++):(a=null,c('"_"')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===96?(a="`",n++):(a=null,c('"`"')),a===null&&(i.charCodeAt(n)===39?(a="'",n++):(a=null,c(`"'"`)),a===null&&(i.charCodeAt(n)===126?(a="~",n++):(a=null,c('"~"'))))))))))),a!==null)for(s=[];a!==null;)s.push(a),a=E(),a===null&&(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a===null&&(i.charCodeAt(n)===33?(a="!",n++):(a=null,c('"!"')),a===null&&(i.charCodeAt(n)===37?(a="%",n++):(a=null,c('"%"')),a===null&&(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a===null&&(i.charCodeAt(n)===95?(a="_",n++):(a=null,c('"_"')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===96?(a="`",n++):(a=null,c('"`"')),a===null&&(i.charCodeAt(n)===39?(a="'",n++):(a=null,c(`"'"`)),a===null&&(i.charCodeAt(n)===126?(a="~",n++):(a=null,c('"~"')))))))))));else s=null;return s!==null&&(s=function(d){return i.substring(n,d)}(u)),s===null&&(n=u),s}function Q(){var s;return i.charCodeAt(n)===40?(s="(",n++):(s=null,c('"("')),s===null&&(i.charCodeAt(n)===41?(s=")",n++):(s=null,c('")"')),s===null&&(i.charCodeAt(n)===60?(s="<",n++):(s=null,c('"<"')),s===null&&(i.charCodeAt(n)===62?(s=">",n++):(s=null,c('">"')),s===null&&(i.charCodeAt(n)===64?(s="@",n++):(s=null,c('"@"')),s===null&&(i.charCodeAt(n)===44?(s=",",n++):(s=null,c('","')),s===null&&(i.charCodeAt(n)===59?(s=";",n++):(s=null,c('";"')),s===null&&(i.charCodeAt(n)===58?(s=":",n++):(s=null,c('":"')),s===null&&(i.charCodeAt(n)===92?(s="\\",n++):(s=null,c('"\\\\"')),s===null&&(s=F(),s===null&&(i.charCodeAt(n)===47?(s="/",n++):(s=null,c('"/"')),s===null&&(i.charCodeAt(n)===91?(s="[",n++):(s=null,c('"["')),s===null&&(i.charCodeAt(n)===93?(s="]",n++):(s=null,c('"]"')),s===null&&(i.charCodeAt(n)===63?(s="?",n++):(s=null,c('"?"')),s===null&&(i.charCodeAt(n)===61?(s="=",n++):(s=null,c('"="')),s===null&&(i.charCodeAt(n)===123?(s="{",n++):(s=null,c('"{"')),s===null&&(i.charCodeAt(n)===125?(s="}",n++):(s=null,c('"}"')),s===null&&(s=T(),s===null&&(s=S())))))))))))))))))),s}function ee(){var s,a,u;if(u=n,a=E(),a===null&&(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a===null&&(i.charCodeAt(n)===46?(a=".",n++):(a=null,c('"."')),a===null&&(i.charCodeAt(n)===33?(a="!",n++):(a=null,c('"!"')),a===null&&(i.charCodeAt(n)===37?(a="%",n++):(a=null,c('"%"')),a===null&&(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a===null&&(i.charCodeAt(n)===95?(a="_",n++):(a=null,c('"_"')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===96?(a="`",n++):(a=null,c('"`"')),a===null&&(i.charCodeAt(n)===39?(a="'",n++):(a=null,c(`"'"`)),a===null&&(i.charCodeAt(n)===126?(a="~",n++):(a=null,c('"~"')),a===null&&(i.charCodeAt(n)===40?(a="(",n++):(a=null,c('"("')),a===null&&(i.charCodeAt(n)===41?(a=")",n++):(a=null,c('")"')),a===null&&(i.charCodeAt(n)===60?(a="<",n++):(a=null,c('"<"')),a===null&&(i.charCodeAt(n)===62?(a=">",n++):(a=null,c('">"')),a===null&&(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a===null&&(i.charCodeAt(n)===92?(a="\\",n++):(a=null,c('"\\\\"')),a===null&&(a=F(),a===null&&(i.charCodeAt(n)===47?(a="/",n++):(a=null,c('"/"')),a===null&&(i.charCodeAt(n)===91?(a="[",n++):(a=null,c('"["')),a===null&&(i.charCodeAt(n)===93?(a="]",n++):(a=null,c('"]"')),a===null&&(i.charCodeAt(n)===63?(a="?",n++):(a=null,c('"?"')),a===null&&(i.charCodeAt(n)===123?(a="{",n++):(a=null,c('"{"')),a===null&&(i.charCodeAt(n)===125?(a="}",n++):(a=null,c('"}"'))))))))))))))))))))))))),a!==null)for(s=[];a!==null;)s.push(a),a=E(),a===null&&(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a===null&&(i.charCodeAt(n)===46?(a=".",n++):(a=null,c('"."')),a===null&&(i.charCodeAt(n)===33?(a="!",n++):(a=null,c('"!"')),a===null&&(i.charCodeAt(n)===37?(a="%",n++):(a=null,c('"%"')),a===null&&(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a===null&&(i.charCodeAt(n)===95?(a="_",n++):(a=null,c('"_"')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===96?(a="`",n++):(a=null,c('"`"')),a===null&&(i.charCodeAt(n)===39?(a="'",n++):(a=null,c(`"'"`)),a===null&&(i.charCodeAt(n)===126?(a="~",n++):(a=null,c('"~"')),a===null&&(i.charCodeAt(n)===40?(a="(",n++):(a=null,c('"("')),a===null&&(i.charCodeAt(n)===41?(a=")",n++):(a=null,c('")"')),a===null&&(i.charCodeAt(n)===60?(a="<",n++):(a=null,c('"<"')),a===null&&(i.charCodeAt(n)===62?(a=">",n++):(a=null,c('">"')),a===null&&(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a===null&&(i.charCodeAt(n)===92?(a="\\",n++):(a=null,c('"\\\\"')),a===null&&(a=F(),a===null&&(i.charCodeAt(n)===47?(a="/",n++):(a=null,c('"/"')),a===null&&(i.charCodeAt(n)===91?(a="[",n++):(a=null,c('"["')),a===null&&(i.charCodeAt(n)===93?(a="]",n++):(a=null,c('"]"')),a===null&&(i.charCodeAt(n)===63?(a="?",n++):(a=null,c('"?"')),a===null&&(i.charCodeAt(n)===123?(a="{",n++):(a=null,c('"{"')),a===null&&(i.charCodeAt(n)===125?(a="}",n++):(a=null,c('"}"')))))))))))))))))))))))));else s=null;return s!==null&&(s=function(d){return i.substring(n,d)}(u)),s===null&&(n=u),s}function ie(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===42?(a="*",n++):(a=null,c('"*"')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return"*"}()),s===null&&(n=d),s}function _e(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===47?(a="/",n++):(a=null,c('"/"')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return"/"}()),s===null&&(n=d),s}function te(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return"="}()),s===null&&(n=d),s}function Et(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===40?(a="(",n++):(a=null,c('"("')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return"("}()),s===null&&(n=d),s}function rt(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===41?(a=")",n++):(a=null,c('")"')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return")"}()),s===null&&(n=d),s}function At(){var s,a,u,d;return u=n,d=n,i.charCodeAt(n)===62?(s=">",n++):(s=null,c('">"')),s!==null?(a=D(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_){return">"}()),s===null&&(n=u),s}function Je(){var s,a,u,d;return u=n,d=n,s=D(),s!==null?(i.charCodeAt(n)===60?(a="<",n++):(a=null,c('"<"')),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_){return"<"}()),s===null&&(n=u),s}function de(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===44?(a=",",n++):(a=null,c('","')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return","}()),s===null&&(n=d),s}function ue(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===59?(a=";",n++):(a=null,c('";"')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return";"}()),s===null&&(n=d),s}function zn(){var s,a,u,d,_;return d=n,_=n,s=D(),s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=D(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return":"}()),s===null&&(n=d),s}function _n(){var s,a,u,d;return u=n,d=n,s=D(),s!==null?(a=F(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_){return'"'}()),s===null&&(n=u),s}function pn(){var s,a,u,d;return u=n,d=n,s=F(),s!==null?(a=D(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_){return'"'}()),s===null&&(n=u),s}function gn(){var s,a,u,d;if(d=n,s=Et(),s!==null){for(a=[],u=mn(),u===null&&(u=oe(),u===null&&(u=gn()));u!==null;)a.push(u),u=mn(),u===null&&(u=oe(),u===null&&(u=gn()));a!==null?(u=rt(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)}else s=null,n=d;return s}function mn(){var s;return/^[!-']/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[!-']")),s===null&&(/^[*-[]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[*-[]")),s===null&&(/^[\]-~]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[\\]-~]")),s===null&&(s=ae(),s===null&&(s=I())))),s}function pr(){var s,a,u,d,_,m;if(_=n,m=n,s=D(),s!==null)if(a=F(),a!==null){for(u=[],d=ne(),d===null&&(d=oe());d!==null;)u.push(d),d=ne(),d===null&&(d=oe());u!==null?(d=F(),d!==null?s=[s,a,u,d]:(s=null,n=m)):(s=null,n=m)}else s=null,n=m;else s=null,n=m;return s!==null&&(s=function(y){return i.substring(n,y)}(_)),s===null&&(n=_),s}function se(){var s,a,u,d,_,m;if(_=n,m=n,s=D(),s!==null)if(a=F(),a!==null){for(u=[],d=ne(),d===null&&(d=oe());d!==null;)u.push(d),d=ne(),d===null&&(d=oe());u!==null?(d=F(),d!==null?s=[s,a,u,d]:(s=null,n=m)):(s=null,n=m)}else s=null,n=m;else s=null,n=m;return s!==null&&(s=function(y){var b=i.substring(n,y).trim();return b.substring(1,b.length-1).replace(/\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g,"$1")}(_)),s===null&&(n=_),s}function ne(){var s;return s=I(),s===null&&(i.charCodeAt(n)===33?(s="!",n++):(s=null,c('"!"')),s===null&&(/^[#-[]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[#-[]")),s===null&&(/^[\]-~]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[\\]-~]")),s===null&&(s=ae())))),s}function oe(){var s,a,u;return u=n,i.charCodeAt(n)===92?(s="\\",n++):(s=null,c('"\\\\"')),s!==null?(/^[\0-\t]/.test(i.charAt(n))?(a=i.charAt(n),n++):(a=null,c("[\\0-\\t]")),a===null&&(/^[\x0B-\f]/.test(i.charAt(n))?(a=i.charAt(n),n++):(a=null,c("[\\x0B-\\f]")),a===null&&(/^[\x0E-]/.test(i.charAt(n))?(a=i.charAt(n),n++):(a=null,c("[\\x0E-]")))),a!==null?s=[s,a]:(s=null,n=u)):(s=null,n=u),s}function fe(){var s,a,u,d,_,m;return _=n,m=n,s=je(),s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=ut(),u=u!==null?u:"",u!==null?(d=vs(),d!==null?s=[s,a,u,d]:(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m),s!==null&&(s=function(y){try{R.uri=new Kd(R.scheme,R.user,R.host,R.port),delete R.scheme,delete R.user,delete R.host,delete R.host_type,delete R.port}catch(b){R=-1}}()),s===null&&(n=_),s}function be(){var s,a,u,d,_,m,y,b;return y=n,b=n,s=je(),s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=ut(),u=u!==null?u:"",u!==null?(d=vs(),d!==null?(_=_f(),_!==null?(m=Af(),m=m!==null?m:"",m!==null?s=[s,a,u,d,_,m]:(s=null,n=b)):(s=null,n=b)):(s=null,n=b)):(s=null,n=b)):(s=null,n=b)):(s=null,n=b),s!==null&&(s=function(M){try{R.uri=new Kd(R.scheme,R.user,R.host,R.port,R.uri_params,R.uri_headers),delete R.scheme,delete R.user,delete R.host,delete R.host_type,delete R.port,delete R.uri_params,l==="SIP_URI"&&(R=R.uri)}catch(Z){R=-1}}()),s===null&&(n=y),s}function je(){var s;return s=we(),s===null&&(s=qn()),s}function we(){var s,a;return a=n,i.substr(n,4).toLowerCase()==="sips"?(s=i.substr(n,4),n+=4):(s=null,c('"sips"')),s!==null&&(s=function(u,d){R.scheme=d.toLowerCase()}(a,s)),s===null&&(n=a),s}function qn(){var s,a;return a=n,i.substr(n,3).toLowerCase()==="sip"?(s=i.substr(n,3),n+=3):(s=null,c('"sip"')),s!==null&&(s=function(u,d){R.scheme=d.toLowerCase()}(a,s)),s===null&&(n=a),s}function ut(){var s,a,u,d,_,m;return d=n,_=n,s=cf(),s!==null?(m=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=ff(),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m),a=a!==null?a:"",a!==null?(i.charCodeAt(n)===64?(u="@",n++):(u=null,c('"@"')),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y){R.user=decodeURIComponent(i.substring(n-1,y))}(d)),s===null&&(n=d),s}function cf(){var s,a;if(a=$(),a===null&&(a=z(),a===null&&(a=Do())),a!==null)for(s=[];a!==null;)s.push(a),a=$(),a===null&&(a=z(),a===null&&(a=Do()));else s=null;return s}function Do(){var s;return i.charCodeAt(n)===38?(s="&",n++):(s=null,c('"&"')),s===null&&(i.charCodeAt(n)===61?(s="=",n++):(s=null,c('"="')),s===null&&(i.charCodeAt(n)===43?(s="+",n++):(s=null,c('"+"')),s===null&&(i.charCodeAt(n)===36?(s="$",n++):(s=null,c('"$"')),s===null&&(i.charCodeAt(n)===44?(s=",",n++):(s=null,c('","')),s===null&&(i.charCodeAt(n)===59?(s=";",n++):(s=null,c('";"')),s===null&&(i.charCodeAt(n)===63?(s="?",n++):(s=null,c('"?"')),s===null&&(i.charCodeAt(n)===47?(s="/",n++):(s=null,c('"/"'))))))))),s}function ff(){var s,a,u;for(u=n,s=[],a=$(),a===null&&(a=z(),a===null&&(i.charCodeAt(n)===38?(a="&",n++):(a=null,c('"&"')),a===null&&(i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===36?(a="$",n++):(a=null,c('"$"')),a===null&&(i.charCodeAt(n)===44?(a=",",n++):(a=null,c('","'))))))));a!==null;)s.push(a),a=$(),a===null&&(a=z(),a===null&&(i.charCodeAt(n)===38?(a="&",n++):(a=null,c('"&"')),a===null&&(i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')),a===null&&(i.charCodeAt(n)===36?(a="$",n++):(a=null,c('"$"')),a===null&&(i.charCodeAt(n)===44?(a=",",n++):(a=null,c('","'))))))));return s!==null&&(s=function(d){R.password=i.substring(n,d)}(u)),s===null&&(n=u),s}function vs(){var s,a,u,d,_;return d=n,s=Zr(),s!==null?(_=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=hf(),u!==null?a=[a,u]:(a=null,n=_)):(a=null,n=_),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s}function Zr(){var s,a;return a=n,s=No(),s===null&&(s=ei(),s===null&&(s=Lo())),s!==null&&(s=function(u){return R.host=i.substring(n,u).toLowerCase(),R.host}(a)),s===null&&(n=a),s}function No(){var s,a,u,d,_,m;for(d=n,_=n,s=[],m=n,a=Mo(),a!==null?(i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."')),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m);a!==null;)s.push(a),m=n,a=Mo(),a!==null?(i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."')),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m);return s!==null?(a=df(),a!==null?(i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."')),u=u!==null?u:"",u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y){return R.host_type="domain",i.substring(n,y)}(d)),s===null&&(n=d),s}function Mo(){var s,a,u,d;if(d=n,s=E(),s!==null){for(a=[],u=E(),u===null&&(i.charCodeAt(n)===45?(u="-",n++):(u=null,c('"-"')),u===null&&(i.charCodeAt(n)===95?(u="_",n++):(u=null,c('"_"'))));u!==null;)a.push(u),u=E(),u===null&&(i.charCodeAt(n)===45?(u="-",n++):(u=null,c('"-"')),u===null&&(i.charCodeAt(n)===95?(u="_",n++):(u=null,c('"_"'))));a!==null?s=[s,a]:(s=null,n=d)}else s=null,n=d;return s}function df(){var s,a,u,d;if(d=n,s=v(),s!==null){for(a=[],u=E(),u===null&&(i.charCodeAt(n)===45?(u="-",n++):(u=null,c('"-"')),u===null&&(i.charCodeAt(n)===95?(u="_",n++):(u=null,c('"_"'))));u!==null;)a.push(u),u=E(),u===null&&(i.charCodeAt(n)===45?(u="-",n++):(u=null,c('"-"')),u===null&&(i.charCodeAt(n)===95?(u="_",n++):(u=null,c('"_"'))));a!==null?s=[s,a]:(s=null,n=d)}else s=null,n=d;return s}function Lo(){var s,a,u,d,_;return d=n,_=n,i.charCodeAt(n)===91?(s="[",n++):(s=null,c('"["')),s!==null?(a=Uo(),a!==null?(i.charCodeAt(n)===93?(u="]",n++):(u=null,c('"]"')),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m){return R.host_type="IPv6",i.substring(n,m)}(d)),s===null&&(n=d),s}function Uo(){var s,a,u,d,_,m,y,b,M,Z,ye,Vt,xs,na,P,X;return na=n,P=n,s=J(),s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?(i.charCodeAt(n)===58?(d=":",n++):(d=null,c('":"')),d!==null?(_=J(),_!==null?(i.charCodeAt(n)===58?(m=":",n++):(m=null,c('":"')),m!==null?(y=J(),y!==null?(i.charCodeAt(n)===58?(b=":",n++):(b=null,c('":"')),b!==null?(M=J(),M!==null?(i.charCodeAt(n)===58?(Z=":",n++):(Z=null,c('":"')),Z!==null?(ye=J(),ye!==null?(i.charCodeAt(n)===58?(Vt=":",n++):(Vt=null,c('":"')),Vt!==null?(xs=gt(),xs!==null?s=[s,a,u,d,_,m,y,b,M,Z,ye,Vt,xs]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=J(),a!==null?(i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?(i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?(i.charCodeAt(n)===58?(y=":",n++):(y=null,c('":"')),y!==null?(b=J(),b!==null?(i.charCodeAt(n)===58?(M=":",n++):(M=null,c('":"')),M!==null?(Z=J(),Z!==null?(i.charCodeAt(n)===58?(ye=":",n++):(ye=null,c('":"')),ye!==null?(Vt=gt(),Vt!==null?s=[s,a,u,d,_,m,y,b,M,Z,ye,Vt]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=J(),a!==null?(i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?(i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?(i.charCodeAt(n)===58?(y=":",n++):(y=null,c('":"')),y!==null?(b=J(),b!==null?(i.charCodeAt(n)===58?(M=":",n++):(M=null,c('":"')),M!==null?(Z=gt(),Z!==null?s=[s,a,u,d,_,m,y,b,M,Z]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=J(),a!==null?(i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?(i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?(i.charCodeAt(n)===58?(y=":",n++):(y=null,c('":"')),y!==null?(b=gt(),b!==null?s=[s,a,u,d,_,m,y,b]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=J(),a!==null?(i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?(i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=gt(),m!==null?s=[s,a,u,d,_,m]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=J(),a!==null?(i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=gt(),d!==null?s=[s,a,u,d]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=gt(),a!==null?s=[s,a]:(s=null,n=P)):(s=null,n=P),s===null&&(P=n,i.substr(n,2)==="::"?(s="::",n+=2):(s=null,c('"::"')),s!==null?(a=J(),a!==null?s=[s,a]:(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(i.substr(n,2)==="::"?(a="::",n+=2):(a=null,c('"::"')),a!==null?(u=J(),u!==null?(i.charCodeAt(n)===58?(d=":",n++):(d=null,c('":"')),d!==null?(_=J(),_!==null?(i.charCodeAt(n)===58?(m=":",n++):(m=null,c('":"')),m!==null?(y=J(),y!==null?(i.charCodeAt(n)===58?(b=":",n++):(b=null,c('":"')),b!==null?(M=J(),M!==null?(i.charCodeAt(n)===58?(Z=":",n++):(Z=null,c('":"')),Z!==null?(ye=gt(),ye!==null?s=[s,a,u,d,_,m,y,b,M,Z,ye]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(X=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?a=[a,u]:(a=null,n=X)):(a=null,n=X),a=a!==null?a:"",a!==null?(i.substr(n,2)==="::"?(u="::",n+=2):(u=null,c('"::"')),u!==null?(d=J(),d!==null?(i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?(i.charCodeAt(n)===58?(y=":",n++):(y=null,c('":"')),y!==null?(b=J(),b!==null?(i.charCodeAt(n)===58?(M=":",n++):(M=null,c('":"')),M!==null?(Z=gt(),Z!==null?s=[s,a,u,d,_,m,y,b,M,Z]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(X=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?a=[a,u]:(a=null,n=X)):(a=null,n=X),a=a!==null?a:"",a!==null?(X=n,i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?u=[u,d]:(u=null,n=X)):(u=null,n=X),u=u!==null?u:"",u!==null?(i.substr(n,2)==="::"?(d="::",n+=2):(d=null,c('"::"')),d!==null?(_=J(),_!==null?(i.charCodeAt(n)===58?(m=":",n++):(m=null,c('":"')),m!==null?(y=J(),y!==null?(i.charCodeAt(n)===58?(b=":",n++):(b=null,c('":"')),b!==null?(M=gt(),M!==null?s=[s,a,u,d,_,m,y,b,M]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(X=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?a=[a,u]:(a=null,n=X)):(a=null,n=X),a=a!==null?a:"",a!==null?(X=n,i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?u=[u,d]:(u=null,n=X)):(u=null,n=X),u=u!==null?u:"",u!==null?(X=n,i.charCodeAt(n)===58?(d=":",n++):(d=null,c('":"')),d!==null?(_=J(),_!==null?d=[d,_]:(d=null,n=X)):(d=null,n=X),d=d!==null?d:"",d!==null?(i.substr(n,2)==="::"?(_="::",n+=2):(_=null,c('"::"')),_!==null?(m=J(),m!==null?(i.charCodeAt(n)===58?(y=":",n++):(y=null,c('":"')),y!==null?(b=gt(),b!==null?s=[s,a,u,d,_,m,y,b]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(X=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?a=[a,u]:(a=null,n=X)):(a=null,n=X),a=a!==null?a:"",a!==null?(X=n,i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?u=[u,d]:(u=null,n=X)):(u=null,n=X),u=u!==null?u:"",u!==null?(X=n,i.charCodeAt(n)===58?(d=":",n++):(d=null,c('":"')),d!==null?(_=J(),_!==null?d=[d,_]:(d=null,n=X)):(d=null,n=X),d=d!==null?d:"",d!==null?(X=n,i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?_=[_,m]:(_=null,n=X)):(_=null,n=X),_=_!==null?_:"",_!==null?(i.substr(n,2)==="::"?(m="::",n+=2):(m=null,c('"::"')),m!==null?(y=gt(),y!==null?s=[s,a,u,d,_,m,y]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(X=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?a=[a,u]:(a=null,n=X)):(a=null,n=X),a=a!==null?a:"",a!==null?(X=n,i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?u=[u,d]:(u=null,n=X)):(u=null,n=X),u=u!==null?u:"",u!==null?(X=n,i.charCodeAt(n)===58?(d=":",n++):(d=null,c('":"')),d!==null?(_=J(),_!==null?d=[d,_]:(d=null,n=X)):(d=null,n=X),d=d!==null?d:"",d!==null?(X=n,i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?_=[_,m]:(_=null,n=X)):(_=null,n=X),_=_!==null?_:"",_!==null?(X=n,i.charCodeAt(n)===58?(m=":",n++):(m=null,c('":"')),m!==null?(y=J(),y!==null?m=[m,y]:(m=null,n=X)):(m=null,n=X),m=m!==null?m:"",m!==null?(i.substr(n,2)==="::"?(y="::",n+=2):(y=null,c('"::"')),y!==null?(b=J(),b!==null?s=[s,a,u,d,_,m,y,b]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P),s===null&&(P=n,s=J(),s!==null?(X=n,i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?a=[a,u]:(a=null,n=X)):(a=null,n=X),a=a!==null?a:"",a!==null?(X=n,i.charCodeAt(n)===58?(u=":",n++):(u=null,c('":"')),u!==null?(d=J(),d!==null?u=[u,d]:(u=null,n=X)):(u=null,n=X),u=u!==null?u:"",u!==null?(X=n,i.charCodeAt(n)===58?(d=":",n++):(d=null,c('":"')),d!==null?(_=J(),_!==null?d=[d,_]:(d=null,n=X)):(d=null,n=X),d=d!==null?d:"",d!==null?(X=n,i.charCodeAt(n)===58?(_=":",n++):(_=null,c('":"')),_!==null?(m=J(),m!==null?_=[_,m]:(_=null,n=X)):(_=null,n=X),_=_!==null?_:"",_!==null?(X=n,i.charCodeAt(n)===58?(m=":",n++):(m=null,c('":"')),m!==null?(y=J(),y!==null?m=[m,y]:(m=null,n=X)):(m=null,n=X),m=m!==null?m:"",m!==null?(X=n,i.charCodeAt(n)===58?(y=":",n++):(y=null,c('":"')),y!==null?(b=J(),b!==null?y=[y,b]:(y=null,n=X)):(y=null,n=X),y=y!==null?y:"",y!==null?(i.substr(n,2)==="::"?(b="::",n+=2):(b=null,c('"::"')),b!==null?s=[s,a,u,d,_,m,y,b]:(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P)):(s=null,n=P))))))))))))))),s!==null&&(s=function(xv){return R.host_type="IPv6",i.substring(n,xv)}(na)),s===null&&(n=na),s}function J(){var s,a,u,d,_;return _=n,s=C(),s!==null?(a=C(),a=a!==null?a:"",a!==null?(u=C(),u=u!==null?u:"",u!==null?(d=C(),d=d!==null?d:"",d!==null?s=[s,a,u,d]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s}function gt(){var s,a,u,d;return d=n,s=J(),s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=J(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s===null&&(s=ei()),s}function ei(){var s,a,u,d,_,m,y,b,M;return b=n,M=n,s=ti(),s!==null?(i.charCodeAt(n)===46?(a=".",n++):(a=null,c('"."')),a!==null?(u=ti(),u!==null?(i.charCodeAt(n)===46?(d=".",n++):(d=null,c('"."')),d!==null?(_=ti(),_!==null?(i.charCodeAt(n)===46?(m=".",n++):(m=null,c('"."')),m!==null?(y=ti(),y!==null?s=[s,a,u,d,_,m,y]:(s=null,n=M)):(s=null,n=M)):(s=null,n=M)):(s=null,n=M)):(s=null,n=M)):(s=null,n=M)):(s=null,n=M),s!==null&&(s=function(Z){return R.host_type="IPv4",i.substring(n,Z)}(b)),s===null&&(n=b),s}function ti(){var s,a,u,d;return d=n,i.substr(n,2)==="25"?(s="25",n+=2):(s=null,c('"25"')),s!==null?(/^[0-5]/.test(i.charAt(n))?(a=i.charAt(n),n++):(a=null,c("[0-5]")),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s===null&&(d=n,i.charCodeAt(n)===50?(s="2",n++):(s=null,c('"2"')),s!==null?(/^[0-4]/.test(i.charAt(n))?(a=i.charAt(n),n++):(a=null,c("[0-4]")),a!==null?(u=g(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s===null&&(d=n,i.charCodeAt(n)===49?(s="1",n++):(s=null,c('"1"')),s!==null?(a=g(),a!==null?(u=g(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s===null&&(d=n,/^[1-9]/.test(i.charAt(n))?(s=i.charAt(n),n++):(s=null,c("[1-9]")),s!==null?(a=g(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s===null&&(s=g())))),s}function hf(){var s,a,u,d,_,m,y;return m=n,y=n,s=g(),s=s!==null?s:"",s!==null?(a=g(),a=a!==null?a:"",a!==null?(u=g(),u=u!==null?u:"",u!==null?(d=g(),d=d!==null?d:"",d!==null?(_=g(),_=_!==null?_:"",_!==null?s=[s,a,u,d,_]:(s=null,n=y)):(s=null,n=y)):(s=null,n=y)):(s=null,n=y)):(s=null,n=y),s!==null&&(s=function(b,M){return M=parseInt(M.join("")),R.port=M,M}(m,s)),s===null&&(n=m),s}function _f(){var s,a,u,d;for(s=[],d=n,i.charCodeAt(n)===59?(a=";",n++):(a=null,c('";"')),a!==null?(u=Fo(),u!==null?a=[a,u]:(a=null,n=d)):(a=null,n=d);a!==null;)s.push(a),d=n,i.charCodeAt(n)===59?(a=";",n++):(a=null,c('";"')),a!==null?(u=Fo(),u!==null?a=[a,u]:(a=null,n=d)):(a=null,n=d);return s}function Fo(){var s;return s=pf(),s===null&&(s=gf(),s===null&&(s=mf(),s===null&&(s=vf(),s===null&&(s=yf(),s===null&&(s=Sf(),s===null&&(s=Cf())))))),s}function pf(){var s,a,u,d;return u=n,d=n,i.substr(n,10).toLowerCase()==="transport="?(s=i.substr(n,10),n+=10):(s=null,c('"transport="')),s!==null?(i.substr(n,3).toLowerCase()==="udp"?(a=i.substr(n,3),n+=3):(a=null,c('"udp"')),a===null&&(i.substr(n,3).toLowerCase()==="tcp"?(a=i.substr(n,3),n+=3):(a=null,c('"tcp"')),a===null&&(i.substr(n,4).toLowerCase()==="sctp"?(a=i.substr(n,4),n+=4):(a=null,c('"sctp"')),a===null&&(i.substr(n,3).toLowerCase()==="tls"?(a=i.substr(n,3),n+=3):(a=null,c('"tls"')),a===null&&(a=O())))),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_,m){R.uri_params||(R.uri_params={}),R.uri_params.transport=m.toLowerCase()}(u,s[1])),s===null&&(n=u),s}function gf(){var s,a,u,d;return u=n,d=n,i.substr(n,5).toLowerCase()==="user="?(s=i.substr(n,5),n+=5):(s=null,c('"user="')),s!==null?(i.substr(n,5).toLowerCase()==="phone"?(a=i.substr(n,5),n+=5):(a=null,c('"phone"')),a===null&&(i.substr(n,2).toLowerCase()==="ip"?(a=i.substr(n,2),n+=2):(a=null,c('"ip"')),a===null&&(a=O())),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_,m){R.uri_params||(R.uri_params={}),R.uri_params.user=m.toLowerCase()}(u,s[1])),s===null&&(n=u),s}function mf(){var s,a,u,d;return u=n,d=n,i.substr(n,7).toLowerCase()==="method="?(s=i.substr(n,7),n+=7):(s=null,c('"method="')),s!==null?(a=Ts(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_,m){R.uri_params||(R.uri_params={}),R.uri_params.method=m}(u,s[1])),s===null&&(n=u),s}function vf(){var s,a,u,d;return u=n,d=n,i.substr(n,4).toLowerCase()==="ttl="?(s=i.substr(n,4),n+=4):(s=null,c('"ttl="')),s!==null?(a=Xo(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_,m){R.params||(R.params={}),R.params.ttl=m}(u,s[1])),s===null&&(n=u),s}function yf(){var s,a,u,d;return u=n,d=n,i.substr(n,6).toLowerCase()==="maddr="?(s=i.substr(n,6),n+=6):(s=null,c('"maddr="')),s!==null?(a=Zr(),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s!==null&&(s=function(_,m){R.uri_params||(R.uri_params={}),R.uri_params.maddr=m}(u,s[1])),s===null&&(n=u),s}function Sf(){var s,a,u,d,_,m;return d=n,_=n,i.substr(n,2).toLowerCase()==="lr"?(s=i.substr(n,2),n+=2):(s=null,c('"lr"')),s!==null?(m=n,i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a!==null?(u=O(),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y){R.uri_params||(R.uri_params={}),R.uri_params.lr=void 0}()),s===null&&(n=d),s}function Cf(){var s,a,u,d,_,m;return d=n,_=n,s=Tf(),s!==null?(m=n,i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a!==null?(u=wf(),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y,b,M){R.uri_params||(R.uri_params={}),typeof M=="undefined"?M=void 0:M=M[1],R.uri_params[b.toLowerCase()]=M}(d,s[0],s[1])),s===null&&(n=d),s}function Tf(){var s,a,u;if(u=n,a=ni(),a!==null)for(s=[];a!==null;)s.push(a),a=ni();else s=null;return s!==null&&(s=function(d,_){return _.join("")}(u,s)),s===null&&(n=u),s}function wf(){var s,a,u;if(u=n,a=ni(),a!==null)for(s=[];a!==null;)s.push(a),a=ni();else s=null;return s!==null&&(s=function(d,_){return _.join("")}(u,s)),s===null&&(n=u),s}function ni(){var s;return s=Ef(),s===null&&(s=$(),s===null&&(s=z())),s}function Ef(){var s;return i.charCodeAt(n)===91?(s="[",n++):(s=null,c('"["')),s===null&&(i.charCodeAt(n)===93?(s="]",n++):(s=null,c('"]"')),s===null&&(i.charCodeAt(n)===47?(s="/",n++):(s=null,c('"/"')),s===null&&(i.charCodeAt(n)===58?(s=":",n++):(s=null,c('":"')),s===null&&(i.charCodeAt(n)===38?(s="&",n++):(s=null,c('"&"')),s===null&&(i.charCodeAt(n)===43?(s="+",n++):(s=null,c('"+"')),s===null&&(i.charCodeAt(n)===36?(s="$",n++):(s=null,c('"$"')))))))),s}function Af(){var s,a,u,d,_,m,y;if(m=n,i.charCodeAt(n)===63?(s="?",n++):(s=null,c('"?"')),s!==null)if(a=ys(),a!==null){for(u=[],y=n,i.charCodeAt(n)===38?(d="&",n++):(d=null,c('"&"')),d!==null?(_=ys(),_!==null?d=[d,_]:(d=null,n=y)):(d=null,n=y);d!==null;)u.push(d),y=n,i.charCodeAt(n)===38?(d="&",n++):(d=null,c('"&"')),d!==null?(_=ys(),_!==null?d=[d,_]:(d=null,n=y)):(d=null,n=y);u!==null?s=[s,a,u]:(s=null,n=m)}else s=null,n=m;else s=null,n=m;return s}function ys(){var s,a,u,d,_;return d=n,_=n,s=Rf(),s!==null?(i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a!==null?(u=kf(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y,b){y=y.join("").toLowerCase(),b=b.join(""),R.uri_headers||(R.uri_headers={}),R.uri_headers[y]?R.uri_headers[y].push(b):R.uri_headers[y]=[b]}(d,s[0],s[2])),s===null&&(n=d),s}function Rf(){var s,a;if(a=ri(),a===null&&(a=$(),a===null&&(a=z())),a!==null)for(s=[];a!==null;)s.push(a),a=ri(),a===null&&(a=$(),a===null&&(a=z()));else s=null;return s}function kf(){var s,a;for(s=[],a=ri(),a===null&&(a=$(),a===null&&(a=z()));a!==null;)s.push(a),a=ri(),a===null&&(a=$(),a===null&&(a=z()));return s}function ri(){var s;return i.charCodeAt(n)===91?(s="[",n++):(s=null,c('"["')),s===null&&(i.charCodeAt(n)===93?(s="]",n++):(s=null,c('"]"')),s===null&&(i.charCodeAt(n)===47?(s="/",n++):(s=null,c('"/"')),s===null&&(i.charCodeAt(n)===63?(s="?",n++):(s=null,c('"?"')),s===null&&(i.charCodeAt(n)===58?(s=":",n++):(s=null,c('":"')),s===null&&(i.charCodeAt(n)===43?(s="+",n++):(s=null,c('"+"')),s===null&&(i.charCodeAt(n)===36?(s="$",n++):(s=null,c('"$"')))))))),s}function Qm(){var s;return s=Qf(),s===null&&(s=If()),s}function If(){var s,a,u,d,_,m;return m=n,s=Ts(),s!==null?(a=T(),a!==null?(u=bf(),u!==null?(d=T(),d!==null?(_=jo(),_!==null?s=[s,a,u,d,_]:(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m),s}function bf(){var s;return s=be(),s===null&&(s=$o()),s}function $o(){var s,a,u,d;return d=n,s=Mf(),s!==null?(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a!==null?(u=Of(),u===null&&(u=xf()),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Of(){var s,a,u,d,_;return d=n,s=Pf(),s===null&&(s=Ss()),s!==null?(_=n,i.charCodeAt(n)===63?(a="?",n++):(a=null,c('"?"')),a!==null?(u=$f(),u!==null?a=[a,u]:(a=null,n=_)):(a=null,n=_),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s}function Pf(){var s,a,u,d;return d=n,i.substr(n,2)==="//"?(s="//",n+=2):(s=null,c('"//"')),s!==null?(a=Lf(),a!==null?(u=Ss(),u=u!==null?u:"",u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Ss(){var s,a,u;return u=n,i.charCodeAt(n)===47?(s="/",n++):(s=null,c('"/"')),s!==null?(a=Nf(),a!==null?s=[s,a]:(s=null,n=u)):(s=null,n=u),s}function xf(){var s,a,u,d;if(d=n,s=Df(),s!==null){for(a=[],u=ii();u!==null;)a.push(u),u=ii();a!==null?s=[s,a]:(s=null,n=d)}else s=null,n=d;return s}function ii(){var s;return s=x(),s===null&&(s=$(),s===null&&(s=z())),s}function Df(){var s;return s=$(),s===null&&(s=z(),s===null&&(i.charCodeAt(n)===59?(s=";",n++):(s=null,c('";"')),s===null&&(i.charCodeAt(n)===63?(s="?",n++):(s=null,c('"?"')),s===null&&(i.charCodeAt(n)===58?(s=":",n++):(s=null,c('":"')),s===null&&(i.charCodeAt(n)===64?(s="@",n++):(s=null,c('"@"')),s===null&&(i.charCodeAt(n)===38?(s="&",n++):(s=null,c('"&"')),s===null&&(i.charCodeAt(n)===61?(s="=",n++):(s=null,c('"="')),s===null&&(i.charCodeAt(n)===43?(s="+",n++):(s=null,c('"+"')),s===null&&(i.charCodeAt(n)===36?(s="$",n++):(s=null,c('"$"')),s===null&&(i.charCodeAt(n)===44?(s=",",n++):(s=null,c('","')))))))))))),s}function Nf(){var s,a,u,d,_,m;if(_=n,s=Cs(),s!==null){for(a=[],m=n,i.charCodeAt(n)===47?(u="/",n++):(u=null,c('"/"')),u!==null?(d=Cs(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,i.charCodeAt(n)===47?(u="/",n++):(u=null,c('"/"')),u!==null?(d=Cs(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Cs(){var s,a,u,d,_,m;for(_=n,s=[],a=si();a!==null;)s.push(a),a=si();if(s!==null){for(a=[],m=n,i.charCodeAt(n)===59?(u=";",n++):(u=null,c('";"')),u!==null?(d=Ho(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,i.charCodeAt(n)===59?(u=";",n++):(u=null,c('";"')),u!==null?(d=Ho(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Ho(){var s,a;for(s=[],a=si();a!==null;)s.push(a),a=si();return s}function si(){var s;return s=$(),s===null&&(s=z(),s===null&&(i.charCodeAt(n)===58?(s=":",n++):(s=null,c('":"')),s===null&&(i.charCodeAt(n)===64?(s="@",n++):(s=null,c('"@"')),s===null&&(i.charCodeAt(n)===38?(s="&",n++):(s=null,c('"&"')),s===null&&(i.charCodeAt(n)===61?(s="=",n++):(s=null,c('"="')),s===null&&(i.charCodeAt(n)===43?(s="+",n++):(s=null,c('"+"')),s===null&&(i.charCodeAt(n)===36?(s="$",n++):(s=null,c('"$"')),s===null&&(i.charCodeAt(n)===44?(s=",",n++):(s=null,c('","')))))))))),s}function Mf(){var s,a,u,d,_;if(d=n,_=n,s=v(),s!==null){for(a=[],u=v(),u===null&&(u=g(),u===null&&(i.charCodeAt(n)===43?(u="+",n++):(u=null,c('"+"')),u===null&&(i.charCodeAt(n)===45?(u="-",n++):(u=null,c('"-"')),u===null&&(i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."'))))));u!==null;)a.push(u),u=v(),u===null&&(u=g(),u===null&&(i.charCodeAt(n)===43?(u="+",n++):(u=null,c('"+"')),u===null&&(i.charCodeAt(n)===45?(u="-",n++):(u=null,c('"-"')),u===null&&(i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."'))))));a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s!==null&&(s=function(m){R.scheme=i.substring(n,m)}(d)),s===null&&(n=d),s}function Lf(){var s;return s=Uf(),s===null&&(s=Ff()),s}function Uf(){var s,a,u,d;return u=n,d=n,s=ut(),s!==null?(i.charCodeAt(n)===64?(a="@",n++):(a=null,c('"@"')),a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s=s!==null?s:"",s!==null?(a=vs(),a!==null?s=[s,a]:(s=null,n=u)):(s=null,n=u),s=s!==null?s:"",s}function Ff(){var s,a;if(a=$(),a===null&&(a=z(),a===null&&(i.charCodeAt(n)===36?(a="$",n++):(a=null,c('"$"')),a===null&&(i.charCodeAt(n)===44?(a=",",n++):(a=null,c('","')),a===null&&(i.charCodeAt(n)===59?(a=";",n++):(a=null,c('";"')),a===null&&(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a===null&&(i.charCodeAt(n)===64?(a="@",n++):(a=null,c('"@"')),a===null&&(i.charCodeAt(n)===38?(a="&",n++):(a=null,c('"&"')),a===null&&(i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"'))))))))))),a!==null)for(s=[];a!==null;)s.push(a),a=$(),a===null&&(a=z(),a===null&&(i.charCodeAt(n)===36?(a="$",n++):(a=null,c('"$"')),a===null&&(i.charCodeAt(n)===44?(a=",",n++):(a=null,c('","')),a===null&&(i.charCodeAt(n)===59?(a=";",n++):(a=null,c('";"')),a===null&&(i.charCodeAt(n)===58?(a=":",n++):(a=null,c('":"')),a===null&&(i.charCodeAt(n)===64?(a="@",n++):(a=null,c('"@"')),a===null&&(i.charCodeAt(n)===38?(a="&",n++):(a=null,c('"&"')),a===null&&(i.charCodeAt(n)===61?(a="=",n++):(a=null,c('"="')),a===null&&(i.charCodeAt(n)===43?(a="+",n++):(a=null,c('"+"')))))))))));else s=null;return s}function $f(){var s,a;for(s=[],a=ii();a!==null;)s.push(a),a=ii();return s}function jo(){var s,a,u,d,_,m,y,b;if(y=n,b=n,i.substr(n,3).toLowerCase()==="sip"?(s=i.substr(n,3),n+=3):(s=null,c('"SIP"')),s!==null)if(i.charCodeAt(n)===47?(a="/",n++):(a=null,c('"/"')),a!==null){if(d=g(),d!==null)for(u=[];d!==null;)u.push(d),d=g();else u=null;if(u!==null)if(i.charCodeAt(n)===46?(d=".",n++):(d=null,c('"."')),d!==null){if(m=g(),m!==null)for(_=[];m!==null;)_.push(m),m=g();else _=null;_!==null?s=[s,a,u,d,_]:(s=null,n=b)}else s=null,n=b;else s=null,n=b}else s=null,n=b;else s=null,n=b;return s!==null&&(s=function(M){R.sip_version=i.substring(n,M)}(y)),s===null&&(n=y),s}function Hf(){var s;return i.substr(n,6)==="INVITE"?(s="INVITE",n+=6):(s=null,c('"INVITE"')),s}function jf(){var s;return i.substr(n,3)==="ACK"?(s="ACK",n+=3):(s=null,c('"ACK"')),s}function Vf(){var s;return i.substr(n,7)==="OPTIONS"?(s="OPTIONS",n+=7):(s=null,c('"OPTIONS"')),s}function Bf(){var s;return i.substr(n,3)==="BYE"?(s="BYE",n+=3):(s=null,c('"BYE"')),s}function zf(){var s;return i.substr(n,6)==="CANCEL"?(s="CANCEL",n+=6):(s=null,c('"CANCEL"')),s}function qf(){var s;return i.substr(n,8)==="REGISTER"?(s="REGISTER",n+=8):(s=null,c('"REGISTER"')),s}function Wf(){var s;return i.substr(n,9)==="SUBSCRIBE"?(s="SUBSCRIBE",n+=9):(s=null,c('"SUBSCRIBE"')),s}function Gf(){var s;return i.substr(n,6)==="NOTIFY"?(s="NOTIFY",n+=6):(s=null,c('"NOTIFY"')),s}function Kf(){var s;return i.substr(n,5)==="REFER"?(s="REFER",n+=5):(s=null,c('"REFER"')),s}function Ts(){var s,a;return a=n,s=Hf(),s===null&&(s=jf(),s===null&&(s=Vf(),s===null&&(s=Bf(),s===null&&(s=zf(),s===null&&(s=qf(),s===null&&(s=Wf(),s===null&&(s=Gf(),s===null&&(s=Kf(),s===null&&(s=O()))))))))),s!==null&&(s=function(u){return R.method=i.substring(n,u),R.method}(a)),s===null&&(n=a),s}function Qf(){var s,a,u,d,_,m;return m=n,s=jo(),s!==null?(a=T(),a!==null?(u=Yf(),u!==null?(d=T(),d!==null?(_=Xf(),_!==null?s=[s,a,u,d,_]:(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m),s}function Yf(){var s,a;return a=n,s=Jf(),s!==null&&(s=function(u,d){R.status_code=parseInt(d.join(""))}(a,s)),s===null&&(n=a),s}function Jf(){var s,a,u,d;return d=n,s=g(),s!==null?(a=g(),a!==null?(u=g(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Xf(){var s,a,u;for(u=n,s=[],a=x(),a===null&&(a=$(),a===null&&(a=z(),a===null&&(a=ae(),a===null&&(a=H(),a===null&&(a=T(),a===null&&(a=S()))))));a!==null;)s.push(a),a=x(),a===null&&(a=$(),a===null&&(a=z(),a===null&&(a=ae(),a===null&&(a=H(),a===null&&(a=T(),a===null&&(a=S()))))));return s!==null&&(s=function(d){R.reason_phrase=i.substring(n,d)}(u)),s===null&&(n=u),s}function Ym(){var s,a,u,d,_,m;if(_=n,s=li(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=li(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=li(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Jm(){var s,a,u,d,_,m;return d=n,_=n,s=ee(),s!==null?(m=n,i.charCodeAt(n)===64?(a="@",n++):(a=null,c('"@"')),a!==null?(u=ee(),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y){R=i.substring(n,y)}(d)),s===null&&(n=d),s}function Xm(){var s,a,u,d,_,m,y;if(_=n,s=ie(),s===null)if(m=n,s=ws(),s!==null){for(a=[],y=n,u=de(),u!==null?(d=ws(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=de(),u!==null?(d=ws(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){var M,Z;for(Z=R.multi_header.length,M=0;M<Z;M++)if(R.multi_header[M].parsed===null){R=null;break}R!==null?R=R.multi_header:R=-1}()),s===null&&(n=_),s}function ws(){var s,a,u,d,_,m,y;if(_=n,m=n,s=fe(),s===null&&(s=Wn()),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=Vo(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=Vo(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){var M;R.multi_header||(R.multi_header=[]);try{M=new gr(R.uri,R.display_name,R.params),delete R.uri,delete R.display_name,delete R.params}catch(Z){M=null}R.multi_header.push({possition:n,offset:b,parsed:M})}(_)),s===null&&(n=_),s}function Wn(){var s,a,u,d,_;return _=n,s=Es(),s=s!==null?s:"",s!==null?(a=Je(),a!==null?(u=be(),u!==null?(d=At(),d!==null?s=[s,a,u,d]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s}function Es(){var s,a,u,d,_,m,y;if(_=n,m=n,s=O(),s!==null){for(a=[],y=n,u=I(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=I(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s===null&&(s=se()),s!==null&&(s=function(b,M){typeof M=="string"?R.display_name=M:R.display_name=M[1].reduce(function(Z,ye){return Z+ye[0]+ye[1]},M[0])}(_,s)),s===null&&(n=_),s}function Vo(){var s;return s=Zf(),s===null&&(s=ed(),s===null&&(s=Ne())),s}function Zf(){var s,a,u,d,_;return d=n,_=n,i.substr(n,1).toLowerCase()==="q"?(s=i.substr(n,1),n++):(s=null,c('"q"')),s!==null?(a=te(),a!==null?(u=td(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.params||(R.params={}),R.params.q=y}(d,s[2])),s===null&&(n=d),s}function ed(){var s,a,u,d,_;return d=n,_=n,i.substr(n,7).toLowerCase()==="expires"?(s=i.substr(n,7),n+=7):(s=null,c('"expires"')),s!==null?(a=te(),a!==null?(u=Gn(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.params||(R.params={}),R.params.expires=y}(d,s[2])),s===null&&(n=d),s}function Gn(){var s,a,u;if(u=n,a=g(),a!==null)for(s=[];a!==null;)s.push(a),a=g();else s=null;return s!==null&&(s=function(d,_){return parseInt(_.join(""))}(u,s)),s===null&&(n=u),s}function td(){var s,a,u,d,_,m,y,b;return m=n,y=n,i.charCodeAt(n)===48?(s="0",n++):(s=null,c('"0"')),s!==null?(b=n,i.charCodeAt(n)===46?(a=".",n++):(a=null,c('"."')),a!==null?(u=g(),u=u!==null?u:"",u!==null?(d=g(),d=d!==null?d:"",d!==null?(_=g(),_=_!==null?_:"",_!==null?a=[a,u,d,_]:(a=null,n=b)):(a=null,n=b)):(a=null,n=b)):(a=null,n=b),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=y)):(s=null,n=y),s!==null&&(s=function(M){return parseFloat(i.substring(n,M))}(m)),s===null&&(n=m),s}function Ne(){var s,a,u,d,_,m;return d=n,_=n,s=O(),s!==null?(m=n,a=te(),a!==null?(u=nd(),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y,b,M){R.params||(R.params={}),typeof M=="undefined"?M=void 0:M=M[1],R.params[b.toLowerCase()]=M}(d,s[0],s[1])),s===null&&(n=d),s}function nd(){var s;return s=O(),s===null&&(s=Zr(),s===null&&(s=pr())),s}function Zm(){var s,a,u,d,_,m;if(_=n,s=rd(),s!==null){for(a=[],m=n,u=ue(),u!==null?(d=Bo(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=ue(),u!==null?(d=Bo(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function rd(){var s;return i.substr(n,6).toLowerCase()==="render"?(s=i.substr(n,6),n+=6):(s=null,c('"render"')),s===null&&(i.substr(n,7).toLowerCase()==="session"?(s=i.substr(n,7),n+=7):(s=null,c('"session"')),s===null&&(i.substr(n,4).toLowerCase()==="icon"?(s=i.substr(n,4),n+=4):(s=null,c('"icon"')),s===null&&(i.substr(n,5).toLowerCase()==="alert"?(s=i.substr(n,5),n+=5):(s=null,c('"alert"')),s===null&&(s=O())))),s}function Bo(){var s;return s=id(),s===null&&(s=Ne()),s}function id(){var s,a,u,d;return d=n,i.substr(n,8).toLowerCase()==="handling"?(s=i.substr(n,8),n+=8):(s=null,c('"handling"')),s!==null?(a=te(),a!==null?(i.substr(n,8).toLowerCase()==="optional"?(u=i.substr(n,8),n+=8):(u=null,c('"optional"')),u===null&&(i.substr(n,8).toLowerCase()==="required"?(u=i.substr(n,8),n+=8):(u=null,c('"required"')),u===null&&(u=O())),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function ev(){var s,a,u,d,_,m;if(_=n,s=O(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function tv(){var s,a,u;if(u=n,a=g(),a!==null)for(s=[];a!==null;)s.push(a),a=g();else s=null;return s!==null&&(s=function(d,_){R=parseInt(_.join(""))}(u,s)),s===null&&(n=u),s}function nv(){var s,a;return a=n,s=sd(),s!==null&&(s=function(u){R=i.substring(n,u)}(a)),s===null&&(n=a),s}function sd(){var s,a,u,d,_,m,y,b;if(y=n,s=ld(),s!==null)if(a=_e(),a!==null)if(u=cd(),u!==null){for(d=[],b=n,_=ue(),_!==null?(m=zo(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);_!==null;)d.push(_),b=n,_=ue(),_!==null?(m=zo(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);d!==null?s=[s,a,u,d]:(s=null,n=y)}else s=null,n=y;else s=null,n=y;else s=null,n=y;return s}function ld(){var s;return s=od(),s===null&&(s=ad()),s}function od(){var s;return i.substr(n,4).toLowerCase()==="text"?(s=i.substr(n,4),n+=4):(s=null,c('"text"')),s===null&&(i.substr(n,5).toLowerCase()==="image"?(s=i.substr(n,5),n+=5):(s=null,c('"image"')),s===null&&(i.substr(n,5).toLowerCase()==="audio"?(s=i.substr(n,5),n+=5):(s=null,c('"audio"')),s===null&&(i.substr(n,5).toLowerCase()==="video"?(s=i.substr(n,5),n+=5):(s=null,c('"video"')),s===null&&(i.substr(n,11).toLowerCase()==="application"?(s=i.substr(n,11),n+=11):(s=null,c('"application"')),s===null&&(s=As()))))),s}function ad(){var s;return i.substr(n,7).toLowerCase()==="message"?(s=i.substr(n,7),n+=7):(s=null,c('"message"')),s===null&&(i.substr(n,9).toLowerCase()==="multipart"?(s=i.substr(n,9),n+=9):(s=null,c('"multipart"')),s===null&&(s=As())),s}function As(){var s;return s=O(),s===null&&(s=ud()),s}function ud(){var s,a,u;return u=n,i.substr(n,2).toLowerCase()==="x-"?(s=i.substr(n,2),n+=2):(s=null,c('"x-"')),s!==null?(a=O(),a!==null?s=[s,a]:(s=null,n=u)):(s=null,n=u),s}function cd(){var s;return s=As(),s===null&&(s=O()),s}function zo(){var s,a,u,d;return d=n,s=O(),s!==null?(a=te(),a!==null?(u=fd(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function fd(){var s;return s=O(),s===null&&(s=pr()),s}function rv(){var s,a,u,d;return d=n,s=dd(),s!==null?(a=I(),a!==null?(u=Ts(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function dd(){var s,a,u;if(u=n,a=g(),a!==null)for(s=[];a!==null;)s.push(a),a=g();else s=null;return s!==null&&(s=function(d,_){R.value=parseInt(_.join(""))}(u,s)),s===null&&(n=u),s}function iv(){var s,a;return a=n,s=Gn(),s!==null&&(s=function(u,d){R=d}(a,s)),s===null&&(n=a),s}function sv(){var s,a,u,d,_,m,y;if(_=n,m=n,s=li(),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b,M){R.event=M.join("").toLowerCase()}(_,s[0])),s===null&&(n=_),s}function li(){var s,a,u,d,_,m;if(_=n,s=j(),s!==null){for(a=[],m=n,i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."')),u!==null?(d=j(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,i.charCodeAt(n)===46?(u=".",n++):(u=null,c('"."')),u!==null?(d=j(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function lv(){var s,a,u,d,_,m,y;if(_=n,m=n,s=fe(),s===null&&(s=Wn()),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=qo(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=qo(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){var M=R.tag;try{R=new gr(R.uri,R.display_name,R.params),M&&R.setParam("tag",M)}catch(Z){R=-1}}()),s===null&&(n=_),s}function qo(){var s;return s=Wo(),s===null&&(s=Ne()),s}function Wo(){var s,a,u,d,_;return d=n,_=n,i.substr(n,3).toLowerCase()==="tag"?(s=i.substr(n,3),n+=3):(s=null,c('"tag"')),s!==null?(a=te(),a!==null?(u=O(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.tag=y}(d,s[2])),s===null&&(n=d),s}function ov(){var s,a,u;if(u=n,a=g(),a!==null)for(s=[];a!==null;)s.push(a),a=g();else s=null;return s!==null&&(s=function(d,_){R=parseInt(_.join(""))}(u,s)),s===null&&(n=u),s}function av(){var s,a;return a=n,s=Gn(),s!==null&&(s=function(u,d){R=d}(a,s)),s===null&&(n=a),s}function uv(){var s,a,u,d,_,m,y,b,M,Z;for(b=n,M=n,s=[],a=Es();a!==null;)s.push(a),a=Es();if(s!==null)if(a=Je(),a!==null)if(u=be(),u!==null)if(d=At(),d!==null){for(_=[],Z=n,m=ue(),m!==null?(y=Ne(),y!==null?m=[m,y]:(m=null,n=Z)):(m=null,n=Z);m!==null;)_.push(m),Z=n,m=ue(),m!==null?(y=Ne(),y!==null?m=[m,y]:(m=null,n=Z)):(m=null,n=Z);_!==null?s=[s,a,u,d,_]:(s=null,n=M)}else s=null,n=M;else s=null,n=M;else s=null,n=M;else s=null,n=M;return s!==null&&(s=function(ye){try{R=new gr(R.uri,R.display_name,R.params)}catch(Vt){R=-1}}()),s===null&&(n=b),s}function cv(){var s;return s=Go(),s}function Go(){var s,a,u,d,_,m,y,b;if(y=n,i.substr(n,6).toLowerCase()==="digest"?(s=i.substr(n,6),n+=6):(s=null,c('"Digest"')),s!==null)if(a=I(),a!==null)if(u=Rs(),u!==null){for(d=[],b=n,_=de(),_!==null?(m=Rs(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);_!==null;)d.push(_),b=n,_=de(),_!==null?(m=Rs(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);d!==null?s=[s,a,u,d]:(s=null,n=y)}else s=null,n=y;else s=null,n=y;else s=null,n=y;return s===null&&(s=hd()),s}function hd(){var s,a,u,d,_,m,y,b;if(y=n,s=O(),s!==null)if(a=I(),a!==null)if(u=oi(),u!==null){for(d=[],b=n,_=de(),_!==null?(m=oi(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);_!==null;)d.push(_),b=n,_=de(),_!==null?(m=oi(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);d!==null?s=[s,a,u,d]:(s=null,n=y)}else s=null,n=y;else s=null,n=y;else s=null,n=y;return s}function oi(){var s,a,u,d;return d=n,s=O(),s!==null?(a=te(),a!==null?(u=O(),u===null&&(u=pr()),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Rs(){var s;return s=_d(),s===null&&(s=gd(),s===null&&(s=md(),s===null&&(s=yd(),s===null&&(s=Sd(),s===null&&(s=Cd(),s===null&&(s=Td(),s===null&&(s=oi()))))))),s}function _d(){var s,a,u,d;return d=n,i.substr(n,5).toLowerCase()==="realm"?(s=i.substr(n,5),n+=5):(s=null,c('"realm"')),s!==null?(a=te(),a!==null?(u=pd(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function pd(){var s,a;return a=n,s=se(),s!==null&&(s=function(u,d){R.realm=d}(a,s)),s===null&&(n=a),s}function gd(){var s,a,u,d,_,m,y,b,M;if(b=n,i.substr(n,6).toLowerCase()==="domain"?(s=i.substr(n,6),n+=6):(s=null,c('"domain"')),s!==null)if(a=te(),a!==null)if(u=_n(),u!==null)if(d=ks(),d!==null){if(_=[],M=n,y=T(),y!==null)for(m=[];y!==null;)m.push(y),y=T();else m=null;for(m!==null?(y=ks(),y!==null?m=[m,y]:(m=null,n=M)):(m=null,n=M);m!==null;){if(_.push(m),M=n,y=T(),y!==null)for(m=[];y!==null;)m.push(y),y=T();else m=null;m!==null?(y=ks(),y!==null?m=[m,y]:(m=null,n=M)):(m=null,n=M)}_!==null?(m=pn(),m!==null?s=[s,a,u,d,_,m]:(s=null,n=b)):(s=null,n=b)}else s=null,n=b;else s=null,n=b;else s=null,n=b;else s=null,n=b;return s}function ks(){var s;return s=$o(),s===null&&(s=Ss()),s}function md(){var s,a,u,d;return d=n,i.substr(n,5).toLowerCase()==="nonce"?(s=i.substr(n,5),n+=5):(s=null,c('"nonce"')),s!==null?(a=te(),a!==null?(u=vd(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function vd(){var s,a;return a=n,s=se(),s!==null&&(s=function(u,d){R.nonce=d}(a,s)),s===null&&(n=a),s}function yd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,6).toLowerCase()==="opaque"?(s=i.substr(n,6),n+=6):(s=null,c('"opaque"')),s!==null?(a=te(),a!==null?(u=se(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.opaque=y}(d,s[2])),s===null&&(n=d),s}function Sd(){var s,a,u,d,_;return d=n,i.substr(n,5).toLowerCase()==="stale"?(s=i.substr(n,5),n+=5):(s=null,c('"stale"')),s!==null?(a=te(),a!==null?(_=n,i.substr(n,4).toLowerCase()==="true"?(u=i.substr(n,4),n+=4):(u=null,c('"true"')),u!==null&&(u=function(m){R.stale=!0}()),u===null&&(n=_),u===null&&(_=n,i.substr(n,5).toLowerCase()==="false"?(u=i.substr(n,5),n+=5):(u=null,c('"false"')),u!==null&&(u=function(m){R.stale=!1}()),u===null&&(n=_)),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Cd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,9).toLowerCase()==="algorithm"?(s=i.substr(n,9),n+=9):(s=null,c('"algorithm"')),s!==null?(a=te(),a!==null?(i.substr(n,3).toLowerCase()==="md5"?(u=i.substr(n,3),n+=3):(u=null,c('"MD5"')),u===null&&(i.substr(n,8).toLowerCase()==="md5-sess"?(u=i.substr(n,8),n+=8):(u=null,c('"MD5-sess"')),u===null&&(u=O())),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.algorithm=y.toUpperCase()}(d,s[2])),s===null&&(n=d),s}function Td(){var s,a,u,d,_,m,y,b,M,Z;if(b=n,i.substr(n,3).toLowerCase()==="qop"?(s=i.substr(n,3),n+=3):(s=null,c('"qop"')),s!==null)if(a=te(),a!==null)if(u=_n(),u!==null){if(M=n,d=Is(),d!==null){for(_=[],Z=n,i.charCodeAt(n)===44?(m=",",n++):(m=null,c('","')),m!==null?(y=Is(),y!==null?m=[m,y]:(m=null,n=Z)):(m=null,n=Z);m!==null;)_.push(m),Z=n,i.charCodeAt(n)===44?(m=",",n++):(m=null,c('","')),m!==null?(y=Is(),y!==null?m=[m,y]:(m=null,n=Z)):(m=null,n=Z);_!==null?d=[d,_]:(d=null,n=M)}else d=null,n=M;d!==null?(_=pn(),_!==null?s=[s,a,u,d,_]:(s=null,n=b)):(s=null,n=b)}else s=null,n=b;else s=null,n=b;else s=null,n=b;return s}function Is(){var s,a;return a=n,i.substr(n,8).toLowerCase()==="auth-int"?(s=i.substr(n,8),n+=8):(s=null,c('"auth-int"')),s===null&&(i.substr(n,4).toLowerCase()==="auth"?(s=i.substr(n,4),n+=4):(s=null,c('"auth"')),s===null&&(s=O())),s!==null&&(s=function(u,d){R.qop||(R.qop=[]),R.qop.push(d.toLowerCase())}(a,s)),s===null&&(n=a),s}function fv(){var s,a,u,d,_,m;if(_=n,s=O(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function dv(){var s,a,u,d,_,m,y;if(_=n,m=n,s=bs(),s!==null){for(a=[],y=n,u=de(),u!==null?(d=bs(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=de(),u!==null?(d=bs(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){var M,Z;for(Z=R.multi_header.length,M=0;M<Z;M++)if(R.multi_header[M].parsed===null){R=null;break}R!==null?R=R.multi_header:R=-1}()),s===null&&(n=_),s}function bs(){var s,a,u,d,_,m,y;if(_=n,m=n,s=Wn(),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){var M;R.multi_header||(R.multi_header=[]);try{M=new gr(R.uri,R.display_name,R.params),delete R.uri,delete R.display_name,delete R.params}catch(Z){M=null}R.multi_header.push({possition:n,offset:b,parsed:M})}(_)),s===null&&(n=_),s}function hv(){var s,a,u,d,_,m,y;if(_=n,m=n,i.substr(n,3).toLowerCase()==="sip"?(s=i.substr(n,3),n+=3):(s=null,c('"SIP"')),s===null&&(s=O()),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=Ko(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=Ko(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b,M){if(R.protocol=M.toLowerCase(),R.params||(R.params={}),R.params.text&&R.params.text[0]==='"'){var Z=R.params.text;R.text=Z.substring(1,Z.length-1),delete R.params.text}}(_,s[0])),s===null&&(n=_),s}function Ko(){var s;return s=wd(),s===null&&(s=Ne()),s}function wd(){var s,a,u,d,_,m;if(_=n,m=n,i.substr(n,5).toLowerCase()==="cause"?(s=i.substr(n,5),n+=5):(s=null,c('"cause"')),s!==null)if(a=te(),a!==null){if(d=g(),d!==null)for(u=[];d!==null;)u.push(d),d=g();else u=null;u!==null?s=[s,a,u]:(s=null,n=m)}else s=null,n=m;else s=null,n=m;return s!==null&&(s=function(y,b){R.cause=parseInt(b.join(""))}(_,s[2])),s===null&&(n=_),s}function _v(){var s,a,u,d,_,m;if(_=n,s=O(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function pv(){var s,a,u,d,_,m;if(_=n,s=Os(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=Os(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=Os(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Os(){var s,a,u,d,_,m;if(_=n,s=Wn(),s!==null){for(a=[],m=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function gv(){var s,a,u,d,_,m;if(_=n,s=Ed(),s!==null){for(a=[],m=n,u=ue(),u!==null?(d=Qo(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=ue(),u!==null?(d=Qo(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Ed(){var s,a;return a=n,i.substr(n,6).toLowerCase()==="active"?(s=i.substr(n,6),n+=6):(s=null,c('"active"')),s===null&&(i.substr(n,7).toLowerCase()==="pending"?(s=i.substr(n,7),n+=7):(s=null,c('"pending"')),s===null&&(i.substr(n,10).toLowerCase()==="terminated"?(s=i.substr(n,10),n+=10):(s=null,c('"terminated"')),s===null&&(s=O()))),s!==null&&(s=function(u){R.state=i.substring(n,u)}(a)),s===null&&(n=a),s}function Qo(){var s,a,u,d,_;return d=n,_=n,i.substr(n,6).toLowerCase()==="reason"?(s=i.substr(n,6),n+=6):(s=null,c('"reason"')),s!==null?(a=te(),a!==null?(u=Ad(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){typeof y!="undefined"&&(R.reason=y)}(d,s[2])),s===null&&(n=d),s===null&&(d=n,_=n,i.substr(n,7).toLowerCase()==="expires"?(s=i.substr(n,7),n+=7):(s=null,c('"expires"')),s!==null?(a=te(),a!==null?(u=Gn(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){typeof y!="undefined"&&(R.expires=y)}(d,s[2])),s===null&&(n=d),s===null&&(d=n,_=n,i.substr(n,11).toLowerCase()==="retry_after"?(s=i.substr(n,11),n+=11):(s=null,c('"retry_after"')),s!==null?(a=te(),a!==null?(u=Gn(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){typeof y!="undefined"&&(R.retry_after=y)}(d,s[2])),s===null&&(n=d),s===null&&(s=Ne()))),s}function Ad(){var s;return i.substr(n,11).toLowerCase()==="deactivated"?(s=i.substr(n,11),n+=11):(s=null,c('"deactivated"')),s===null&&(i.substr(n,9).toLowerCase()==="probation"?(s=i.substr(n,9),n+=9):(s=null,c('"probation"')),s===null&&(i.substr(n,8).toLowerCase()==="rejected"?(s=i.substr(n,8),n+=8):(s=null,c('"rejected"')),s===null&&(i.substr(n,7).toLowerCase()==="timeout"?(s=i.substr(n,7),n+=7):(s=null,c('"timeout"')),s===null&&(i.substr(n,6).toLowerCase()==="giveup"?(s=i.substr(n,6),n+=6):(s=null,c('"giveup"')),s===null&&(i.substr(n,10).toLowerCase()==="noresource"?(s=i.substr(n,10),n+=10):(s=null,c('"noresource"')),s===null&&(i.substr(n,9).toLowerCase()==="invariant"?(s=i.substr(n,9),n+=9):(s=null,c('"invariant"')),s===null&&(s=O()))))))),s}function mv(){var s;return s=De(),s=s!==null?s:"",s}function vv(){var s,a,u,d,_,m;if(_=n,s=O(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=O(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s=s!==null?s:"",s}function yv(){var s,a,u,d,_,m,y;if(_=n,m=n,s=fe(),s===null&&(s=Wn()),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=Yo(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=Yo(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){var M=R.tag;try{R=new gr(R.uri,R.display_name,R.params),M&&R.setParam("tag",M)}catch(Z){R=-1}}()),s===null&&(n=_),s}function Yo(){var s;return s=Wo(),s===null&&(s=Ne()),s}function Sv(){var s,a,u,d,_,m;if(_=n,s=Ps(),s!==null){for(a=[],m=n,u=de(),u!==null?(d=Ps(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=de(),u!==null?(d=Ps(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Ps(){var s,a,u,d,_,m,y,b;if(y=n,s=xd(),s!==null)if(a=I(),a!==null)if(u=Md(),u!==null){for(d=[],b=n,_=ue(),_!==null?(m=Jo(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);_!==null;)d.push(_),b=n,_=ue(),_!==null?(m=Jo(),m!==null?_=[_,m]:(_=null,n=b)):(_=null,n=b);d!==null?s=[s,a,u,d]:(s=null,n=y)}else s=null,n=y;else s=null,n=y;else s=null,n=y;return s}function Jo(){var s;return s=Rd(),s===null&&(s=kd(),s===null&&(s=Id(),s===null&&(s=bd(),s===null&&(s=Od(),s===null&&(s=Ne()))))),s}function Rd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,3).toLowerCase()==="ttl"?(s=i.substr(n,3),n+=3):(s=null,c('"ttl"')),s!==null?(a=te(),a!==null?(u=Xo(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.ttl=y}(d,s[2])),s===null&&(n=d),s}function kd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,5).toLowerCase()==="maddr"?(s=i.substr(n,5),n+=5):(s=null,c('"maddr"')),s!==null?(a=te(),a!==null?(u=Zr(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.maddr=y}(d,s[2])),s===null&&(n=d),s}function Id(){var s,a,u,d,_;return d=n,_=n,i.substr(n,8).toLowerCase()==="received"?(s=i.substr(n,8),n+=8):(s=null,c('"received"')),s!==null?(a=te(),a!==null?(u=ei(),u===null&&(u=Uo()),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.received=y}(d,s[2])),s===null&&(n=d),s}function bd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,6).toLowerCase()==="branch"?(s=i.substr(n,6),n+=6):(s=null,c('"branch"')),s!==null?(a=te(),a!==null?(u=O(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.branch=y}(d,s[2])),s===null&&(n=d),s}function Od(){var s,a,u,d,_;return d=n,i.substr(n,5).toLowerCase()==="rport"?(s=i.substr(n,5),n+=5):(s=null,c('"rport"')),s!==null?(_=n,a=te(),a!==null?(u=Pd(),u!==null?a=[a,u]:(a=null,n=_)):(a=null,n=_),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s}function Pd(){var s,a,u,d,_,m,y;return m=n,y=n,s=g(),s=s!==null?s:"",s!==null?(a=g(),a=a!==null?a:"",a!==null?(u=g(),u=u!==null?u:"",u!==null?(d=g(),d=d!==null?d:"",d!==null?(_=g(),_=_!==null?_:"",_!==null?s=[s,a,u,d,_]:(s=null,n=y)):(s=null,n=y)):(s=null,n=y)):(s=null,n=y)):(s=null,n=y),s!==null&&(s=function(b,M){R.rport=parseInt(M.join(""))}(m,s)),s===null&&(n=m),s}function xd(){var s,a,u,d,_,m;return m=n,s=Dd(),s!==null?(a=_e(),a!==null?(u=O(),u!==null?(d=_e(),d!==null?(_=Nd(),_!==null?s=[s,a,u,d,_]:(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m)):(s=null,n=m),s}function Dd(){var s,a;return a=n,i.substr(n,3).toLowerCase()==="sip"?(s=i.substr(n,3),n+=3):(s=null,c('"SIP"')),s===null&&(s=O()),s!==null&&(s=function(u,d){R.protocol=d}(a,s)),s===null&&(n=a),s}function Nd(){var s,a;return a=n,i.substr(n,3).toLowerCase()==="udp"?(s=i.substr(n,3),n+=3):(s=null,c('"UDP"')),s===null&&(i.substr(n,3).toLowerCase()==="tcp"?(s=i.substr(n,3),n+=3):(s=null,c('"TCP"')),s===null&&(i.substr(n,3).toLowerCase()==="tls"?(s=i.substr(n,3),n+=3):(s=null,c('"TLS"')),s===null&&(i.substr(n,4).toLowerCase()==="sctp"?(s=i.substr(n,4),n+=4):(s=null,c('"SCTP"')),s===null&&(s=O())))),s!==null&&(s=function(u,d){R.transport=d}(a,s)),s===null&&(n=a),s}function Md(){var s,a,u,d,_;return d=n,s=Ld(),s!==null?(_=n,a=zn(),a!==null?(u=Ud(),u!==null?a=[a,u]:(a=null,n=_)):(a=null,n=_),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=d)):(s=null,n=d),s}function Ld(){var s,a;return a=n,s=ei(),s===null&&(s=Lo(),s===null&&(s=No())),s!==null&&(s=function(u){R.host=i.substring(n,u)}(a)),s===null&&(n=a),s}function Ud(){var s,a,u,d,_,m,y;return m=n,y=n,s=g(),s=s!==null?s:"",s!==null?(a=g(),a=a!==null?a:"",a!==null?(u=g(),u=u!==null?u:"",u!==null?(d=g(),d=d!==null?d:"",d!==null?(_=g(),_=_!==null?_:"",_!==null?s=[s,a,u,d,_]:(s=null,n=y)):(s=null,n=y)):(s=null,n=y)):(s=null,n=y)):(s=null,n=y),s!==null&&(s=function(b,M){R.port=parseInt(M.join(""))}(m,s)),s===null&&(n=m),s}function Xo(){var s,a,u,d,_;return d=n,_=n,s=g(),s!==null?(a=g(),a=a!==null?a:"",a!==null?(u=g(),u=u!==null?u:"",u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){return parseInt(y.join(""))}(d,s)),s===null&&(n=d),s}function Cv(){var s;return s=Go(),s}function Tv(){var s,a,u,d,_,m;if(_=n,s=Fd(),s!==null){for(a=[],m=n,u=ue(),u!==null?(d=Zo(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=ue(),u!==null?(d=Zo(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function Fd(){var s,a;return a=n,s=Gn(),s!==null&&(s=function(u,d){R.expires=d}(a,s)),s===null&&(n=a),s}function Zo(){var s;return s=$d(),s===null&&(s=Ne()),s}function $d(){var s,a,u,d,_;return d=n,_=n,i.substr(n,9).toLowerCase()==="refresher"?(s=i.substr(n,9),n+=9):(s=null,c('"refresher"')),s!==null?(a=te(),a!==null?(i.substr(n,3).toLowerCase()==="uac"?(u=i.substr(n,3),n+=3):(u=null,c('"uac"')),u===null&&(i.substr(n,3).toLowerCase()==="uas"?(u=i.substr(n,3),n+=3):(u=null,c('"uas"'))),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.refresher=y.toLowerCase()}(d,s[2])),s===null&&(n=d),s}function wv(){var s,a,u,d;return d=n,s=O(),s!==null?(a=re(),a!==null?(u=Hd(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Hd(){var s,a;for(s=[],a=He(),a===null&&(a=H(),a===null&&(a=I()));a!==null;)s.push(a),a=He(),a===null&&(a=H(),a===null&&(a=I()));return s}function Ev(){var s,a;for(s=[],a=k();a!==null;)s.push(a),a=k();return s}function Av(){var s,a,u;return u=n,i.substr(n,5)==="uuid:"?(s="uuid:",n+=5):(s=null,c('"uuid:"')),s!==null?(a=jd(),a!==null?s=[s,a]:(s=null,n=u)):(s=null,n=u),s}function jd(){var s,a,u,d,_,m,y,b,M,Z,ye;return Z=n,ye=n,s=Vd(),s!==null?(i.charCodeAt(n)===45?(a="-",n++):(a=null,c('"-"')),a!==null?(u=Xt(),u!==null?(i.charCodeAt(n)===45?(d="-",n++):(d=null,c('"-"')),d!==null?(_=Xt(),_!==null?(i.charCodeAt(n)===45?(m="-",n++):(m=null,c('"-"')),m!==null?(y=Xt(),y!==null?(i.charCodeAt(n)===45?(b="-",n++):(b=null,c('"-"')),b!==null?(M=Bd(),M!==null?s=[s,a,u,d,_,m,y,b,M]:(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye)):(s=null,n=ye),s!==null&&(s=function(Vt,xs){R=i.substring(n+5,Vt)}(Z,s[0])),s===null&&(n=Z),s}function Xt(){var s,a,u,d,_;return _=n,s=C(),s!==null?(a=C(),a!==null?(u=C(),u!==null?(d=C(),d!==null?s=[s,a,u,d]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s}function Vd(){var s,a,u;return u=n,s=Xt(),s!==null?(a=Xt(),a!==null?s=[s,a]:(s=null,n=u)):(s=null,n=u),s}function Bd(){var s,a,u,d;return d=n,s=Xt(),s!==null?(a=Xt(),a!==null?(u=Xt(),u!==null?s=[s,a,u]:(s=null,n=d)):(s=null,n=d)):(s=null,n=d),s}function Rv(){var s,a,u,d,_,m,y;if(_=n,m=n,s=fe(),s===null&&(s=Wn()),s!==null){for(a=[],y=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);u!==null;)a.push(u),y=n,u=ue(),u!==null?(d=Ne(),d!==null?u=[u,d]:(u=null,n=y)):(u=null,n=y);a!==null?s=[s,a]:(s=null,n=m)}else s=null,n=m;return s!==null&&(s=function(b){try{R=new gr(R.uri,R.display_name,R.params)}catch(M){R=-1}}()),s===null&&(n=_),s}function kv(){var s,a,u,d,_,m;if(_=n,s=zd(),s!==null){for(a=[],m=n,u=ue(),u!==null?(d=ea(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);u!==null;)a.push(u),m=n,u=ue(),u!==null?(d=ea(),d!==null?u=[u,d]:(u=null,n=m)):(u=null,n=m);a!==null?s=[s,a]:(s=null,n=_)}else s=null,n=_;return s}function zd(){var s,a,u,d,_,m;return d=n,_=n,s=ee(),s!==null?(m=n,i.charCodeAt(n)===64?(a="@",n++):(a=null,c('"@"')),a!==null?(u=ee(),u!==null?a=[a,u]:(a=null,n=m)):(a=null,n=m),a=a!==null?a:"",a!==null?s=[s,a]:(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(y){R.call_id=i.substring(n,y)}(d)),s===null&&(n=d),s}function ea(){var s;return s=qd(),s===null&&(s=Wd(),s===null&&(s=Gd(),s===null&&(s=Ne()))),s}function qd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,6)==="to-tag"?(s="to-tag",n+=6):(s=null,c('"to-tag"')),s!==null?(a=te(),a!==null?(u=O(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.to_tag=y}(d,s[2])),s===null&&(n=d),s}function Wd(){var s,a,u,d,_;return d=n,_=n,i.substr(n,8)==="from-tag"?(s="from-tag",n+=8):(s=null,c('"from-tag"')),s!==null?(a=te(),a!==null?(u=O(),u!==null?s=[s,a,u]:(s=null,n=_)):(s=null,n=_)):(s=null,n=_),s!==null&&(s=function(m,y){R.from_tag=y}(d,s[2])),s===null&&(n=d),s}function Gd(){var s,a;return a=n,i.substr(n,10)==="early-only"?(s="early-only",n+=10):(s=null,c('"early-only"')),s!==null&&(s=function(u){R.early_only=!0}()),s===null&&(n=a),s}function Iv(s){s.sort();for(var a=null,u=[],d=0;d<s.length;d++)s[d]!==a&&(u.push(s[d]),a=s[d]);return u}function bv(){for(var s=1,a=1,u=!1,d=0;d<Math.max(n,f);d++){var _=i.charAt(d);_===`
`?(u||s++,a=1,u=!1):_==="\r"||_==="\u2028"||_==="\u2029"?(s++,a=1,u=!0):(a++,u=!1)}return{line:s,column:a}}var Kd=Vn(),gr=Zc(),R={},Ov=o[l]();if(Ov===null||n!==i.length){var ta=Math.max(n,f),Pv=ta<i.length?i.charAt(ta):null,Qd=bv();return new this.SyntaxError(Iv(h),Pv,ta,Qd.line,Qd.column),-1}return R},toSource:function(){return this._source}};return e.SyntaxError=function(r,i,l,o,n){function f(h,c){var p,g;switch(h.length){case 0:p="end of input";break;case 1:p=h[0];break;default:p=h.slice(0,h.length-1).join(", ")+" or "+h[h.length-1]}return g=c?t(c):"end of input","Expected "+p+" but "+g+" found."}this.name="SyntaxError",this.expected=r,this.found=i,this.message=f(r,i),this.offset=l,this.line=o,this.column=n},e.SyntaxError.prototype=Error.prototype,e}()),Pa}var xa,u_;function Vn(){if(u_)return xa;u_=1;function t(c,p){var g;if(typeof Symbol=="undefined"||c[Symbol.iterator]==null){if(Array.isArray(c)||(g=e(c))||p&&c&&typeof c.length=="number"){g&&(c=g);var v=0,C=function(){};return{s:C,n:function(){return v>=c.length?{done:!0}:{done:!1,value:c[v++]}},e:function(S){throw S},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w=!0,k=!1,F;return{s:function(){g=c[Symbol.iterator]()},n:function(){var S=g.next();return w=S.done,S},e:function(S){k=!0,F=S},f:function(){try{!w&&g.return!=null&&g.return()}finally{if(k)throw F}}}}function e(c,p){if(c){if(typeof c=="string")return r(c,p);var g=Object.prototype.toString.call(c).slice(8,-1);if(g==="Object"&&c.constructor&&(g=c.constructor.name),g==="Map"||g==="Set")return Array.from(c);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return r(c,p)}}function r(c,p){(p==null||p>c.length)&&(p=c.length);for(var g=0,v=new Array(p);g<p;g++)v[g]=c[g];return v}function i(c,p){if(!(c instanceof p))throw new TypeError("Cannot call a class as a function")}function l(c,p){for(var g=0;g<p.length;g++){var v=p[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(c,v.key,v)}}function o(c,p,g){return p&&l(c.prototype,p),g&&l(c,g),c}var n=Ue,f=nt(),h=Yt();return xa=function(){o(c,null,[{key:"parse",value:function(g){if(g=h.parse(g,"SIP_URI"),g!==-1)return g}}]);function c(p,g,v,C){var w=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},k=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(i(this,c),!v)throw new TypeError('missing or invalid "host" parameter');this._parameters={},this._headers={},this._scheme=p||n.SIP,this._user=g,this._host=v,this._port=C;for(var F in w)Object.prototype.hasOwnProperty.call(w,F)&&this.setParam(F,w[F]);for(var T in k)Object.prototype.hasOwnProperty.call(k,T)&&this.setHeader(T,k[T])}return o(c,[{key:"setParam",value:function(g,v){g&&(this._parameters[g.toLowerCase()]=typeof v=="undefined"||v===null?null:v.toString())}},{key:"getParam",value:function(g){if(g)return this._parameters[g.toLowerCase()]}},{key:"hasParam",value:function(g){if(g)return this._parameters.hasOwnProperty(g.toLowerCase())&&!0||!1}},{key:"deleteParam",value:function(g){if(g=g.toLowerCase(),this._parameters.hasOwnProperty(g)){var v=this._parameters[g];return delete this._parameters[g],v}}},{key:"clearParams",value:function(){this._parameters={}}},{key:"setHeader",value:function(g,v){this._headers[f.headerize(g)]=Array.isArray(v)?v:[v]}},{key:"getHeader",value:function(g){if(g)return this._headers[f.headerize(g)]}},{key:"hasHeader",value:function(g){if(g)return this._headers.hasOwnProperty(f.headerize(g))&&!0||!1}},{key:"deleteHeader",value:function(g){if(g=f.headerize(g),this._headers.hasOwnProperty(g)){var v=this._headers[g];return delete this._headers[g],v}}},{key:"clearHeaders",value:function(){this._headers={}}},{key:"clone",value:function(){return new c(this._scheme,this._user,this._host,this._port,JSON.parse(JSON.stringify(this._parameters)),JSON.parse(JSON.stringify(this._headers)))}},{key:"toString",value:function(){var g=[],v="".concat(this._scheme,":");this._user&&(v+="".concat(f.escapeUser(this._user),"@")),v+=this._host,(this._port||this._port===0)&&(v+=":".concat(this._port));for(var C in this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,C)&&(v+=";".concat(C),this._parameters[C]!==null&&(v+="=".concat(this._parameters[C])));for(var w in this._headers)if(Object.prototype.hasOwnProperty.call(this._headers,w)){var k=t(this._headers[w]),F;try{for(k.s();!(F=k.n()).done;){var T=F.value;g.push("".concat(w,"=").concat(T))}}catch(S){k.e(S)}finally{k.f()}}return g.length>0&&(v+="?".concat(g.join("&"))),v}},{key:"toAor",value:function(g){var v="".concat(this._scheme,":");return this._user&&(v+="".concat(f.escapeUser(this._user),"@")),v+=this._host,g&&(this._port||this._port===0)&&(v+=":".concat(this._port)),v}},{key:"scheme",get:function(){return this._scheme},set:function(g){this._scheme=g.toLowerCase()}},{key:"user",get:function(){return this._user},set:function(g){this._user=g}},{key:"host",get:function(){return this._host},set:function(g){this._host=g.toLowerCase()}},{key:"port",get:function(){return this._port},set:function(g){this._port=g===0?g:parseInt(g,10)||null}}]),c}(),xa}var c_;function nt(){if(c_)return Pe;c_=1;function t(p){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(v){return typeof v}:t=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},t(p)}function e(p,g){var v;if(typeof Symbol=="undefined"||p[Symbol.iterator]==null){if(Array.isArray(p)||(v=r(p))||g&&p&&typeof p.length=="number"){v&&(p=v);var C=0,w=function(){};return{s:w,n:function(){return C>=p.length?{done:!0}:{done:!1,value:p[C++]}},e:function(E){throw E},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var k=!0,F=!1,T;return{s:function(){v=p[Symbol.iterator]()},n:function(){var E=v.next();return k=E.done,E},e:function(E){F=!0,T=E},f:function(){try{!k&&v.return!=null&&v.return()}finally{if(F)throw T}}}}function r(p,g){if(p){if(typeof p=="string")return i(p,g);var v=Object.prototype.toString.call(p).slice(8,-1);if(v==="Object"&&p.constructor&&(v=p.constructor.name),v==="Map"||v==="Set")return Array.from(p);if(v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v))return i(p,g)}}function i(p,g){(g==null||g>p.length)&&(g=p.length);for(var v=0,C=new Array(g);v<g;v++)C[v]=p[v];return C}var l=Ue,o=Vn(),n=Yt();Pe.str_utf8_length=function(p){return unescape(encodeURIComponent(p)).length};var f=Pe.isFunction=function(p){return p!==void 0?Object.prototype.toString.call(p)==="[object Function]":!1};Pe.isString=function(p){return p!==void 0?Object.prototype.toString.call(p)==="[object String]":!1},Pe.isDecimal=function(p){return!isNaN(p)&&parseFloat(p)===parseInt(p,10)},Pe.isEmpty=function(p){return p===null||p===""||p===void 0||Array.isArray(p)&&p.length===0||typeof p=="number"&&isNaN(p)},Pe.hasMethods=function(p){for(var g=arguments.length,v=new Array(g>1?g-1:0),C=1;C<g;C++)v[C-1]=arguments[C];for(var w=0,k=v;w<k.length;w++){var F=k[w];if(f(p[F]))return!1}return!0};var h=Pe.createRandomToken=function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32,v,C,w="";for(v=0;v<p;v++)C=Math.random()*g|0,w+=C.toString(g);return w};Pe.newTag=function(){return h(10)},Pe.newUUID=function(){var p="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(g){var v=Math.random()*16|0,C=g==="x"?v:v&3|8;return C.toString(16)});return p},Pe.hostType=function(p){if(p){if(p=n.parse(p,"host"),p!==-1)return p.host_type}else return};var c=Pe.escapeUser=function(p){return encodeURIComponent(decodeURIComponent(p)).replace(/%3A/ig,":").replace(/%2B/ig,"+").replace(/%3F/ig,"?").replace(/%2F/ig,"/")};return Pe.normalizeTarget=function(p,g){if(p){if(p instanceof o)return p;if(typeof p=="string"){var v=p.split("@"),C,w;switch(v.length){case 1:if(!g)return;C=p,w=g;break;case 2:C=v[0],w=v[1];break;default:C=v.slice(0,v.length-1).join("@"),w=v[v.length-1]}C=C.replace(/^(sips?|tel):/i,""),/^[-.()]*\+?[0-9\-.()]+$/.test(C)&&(C=C.replace(/[-.()]/g,"")),p="".concat(l.SIP,":").concat(c(C),"@").concat(w);var k;return(k=o.parse(p))?k:void 0}else return}else return},Pe.headerize=function(p){var g={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},v=p.toLowerCase().replace(/_/g,"-").split("-"),C="",w=v.length,k;for(k=0;k<w;k++)k!==0&&(C+="-"),C+=v[k].charAt(0).toUpperCase()+v[k].substring(1);return g[C]&&(C=g[C]),C},Pe.sipErrorCause=function(p){for(var g in l.SIP_ERROR_CAUSES)if(l.SIP_ERROR_CAUSES[g].indexOf(p)!==-1)return l.causes[g];return l.causes.SIP_FAILURE_CODE},Pe.getRandomTestNetIP=function(){function p(g,v){return Math.floor(Math.random()*(v-g+1)+g)}return"192.0.2.".concat(p(1,254))},Pe.calculateMD5=function(p){function g(se,ne){return se<<ne|se>>>32-ne}function v(se,ne){var oe=se&2147483648,fe=ne&2147483648,be=se&1073741824,je=ne&1073741824,we=(se&1073741823)+(ne&1073741823);return be&je?we^2147483648^oe^fe:be|je?we&1073741824?we^3221225472^oe^fe:we^1073741824^oe^fe:we^oe^fe}function C(se,ne,oe){return se&ne|~se&oe}function w(se,ne,oe){return se&oe|ne&~oe}function k(se,ne,oe){return se^ne^oe}function F(se,ne,oe){return ne^(se|~oe)}function T(se,ne,oe,fe,be,je,we){return se=v(se,v(v(C(ne,oe,fe),be),we)),v(g(se,je),ne)}function S(se,ne,oe,fe,be,je,we){return se=v(se,v(v(w(ne,oe,fe),be),we)),v(g(se,je),ne)}function E(se,ne,oe,fe,be,je,we){return se=v(se,v(v(k(ne,oe,fe),be),we)),v(g(se,je),ne)}function x(se,ne,oe,fe,be,je,we){return se=v(se,v(v(F(ne,oe,fe),be),we)),v(g(se,je),ne)}function $(se){for(var ne,oe=se.length,fe=oe+8,be=(fe-fe%64)/64,je=(be+1)*16,we=new Array(je-1),qn=0,ut=0;ut<oe;)ne=(ut-ut%4)/4,qn=ut%4*8,we[ne]=we[ne]|se.charCodeAt(ut)<<qn,ut++;return ne=(ut-ut%4)/4,qn=ut%4*8,we[ne]=we[ne]|128<<qn,we[je-2]=oe<<3,we[je-1]=oe>>>29,we}function W(se){var ne="",oe="",fe,be;for(be=0;be<=3;be++)fe=se>>>be*8&255,oe="0".concat(fe.toString(16)),ne=ne+oe.substr(oe.length-2,2);return ne}function z(se){for(var ne="",oe=0;oe<se.length;oe++){var fe=se.charCodeAt(oe);fe<128?ne+=String.fromCharCode(fe):fe>127&&fe<2048?(ne+=String.fromCharCode(fe>>6|192),ne+=String.fromCharCode(fe&63|128)):(ne+=String.fromCharCode(fe>>12|224),ne+=String.fromCharCode(fe>>6&63|128),ne+=String.fromCharCode(fe&63|128))}return ne}var I=[],D,re,De,He,ae,H,B,O,j,Q=7,ee=12,ie=17,_e=22,te=5,Et=9,rt=14,At=20,Je=4,de=11,ue=16,zn=23,_n=6,pn=10,gn=15,mn=21;for(p=z(p),I=$(p),H=1732584193,B=4023233417,O=2562383102,j=271733878,D=0;D<I.length;D+=16)re=H,De=B,He=O,ae=j,H=T(H,B,O,j,I[D+0],Q,3614090360),j=T(j,H,B,O,I[D+1],ee,3905402710),O=T(O,j,H,B,I[D+2],ie,606105819),B=T(B,O,j,H,I[D+3],_e,3250441966),H=T(H,B,O,j,I[D+4],Q,4118548399),j=T(j,H,B,O,I[D+5],ee,1200080426),O=T(O,j,H,B,I[D+6],ie,2821735955),B=T(B,O,j,H,I[D+7],_e,4249261313),H=T(H,B,O,j,I[D+8],Q,1770035416),j=T(j,H,B,O,I[D+9],ee,2336552879),O=T(O,j,H,B,I[D+10],ie,4294925233),B=T(B,O,j,H,I[D+11],_e,2304563134),H=T(H,B,O,j,I[D+12],Q,1804603682),j=T(j,H,B,O,I[D+13],ee,4254626195),O=T(O,j,H,B,I[D+14],ie,2792965006),B=T(B,O,j,H,I[D+15],_e,1236535329),H=S(H,B,O,j,I[D+1],te,4129170786),j=S(j,H,B,O,I[D+6],Et,3225465664),O=S(O,j,H,B,I[D+11],rt,643717713),B=S(B,O,j,H,I[D+0],At,3921069994),H=S(H,B,O,j,I[D+5],te,3593408605),j=S(j,H,B,O,I[D+10],Et,38016083),O=S(O,j,H,B,I[D+15],rt,3634488961),B=S(B,O,j,H,I[D+4],At,3889429448),H=S(H,B,O,j,I[D+9],te,568446438),j=S(j,H,B,O,I[D+14],Et,3275163606),O=S(O,j,H,B,I[D+3],rt,4107603335),B=S(B,O,j,H,I[D+8],At,1163531501),H=S(H,B,O,j,I[D+13],te,2850285829),j=S(j,H,B,O,I[D+2],Et,4243563512),O=S(O,j,H,B,I[D+7],rt,1735328473),B=S(B,O,j,H,I[D+12],At,2368359562),H=E(H,B,O,j,I[D+5],Je,4294588738),j=E(j,H,B,O,I[D+8],de,2272392833),O=E(O,j,H,B,I[D+11],ue,1839030562),B=E(B,O,j,H,I[D+14],zn,4259657740),H=E(H,B,O,j,I[D+1],Je,2763975236),j=E(j,H,B,O,I[D+4],de,1272893353),O=E(O,j,H,B,I[D+7],ue,4139469664),B=E(B,O,j,H,I[D+10],zn,3200236656),H=E(H,B,O,j,I[D+13],Je,681279174),j=E(j,H,B,O,I[D+0],de,3936430074),O=E(O,j,H,B,I[D+3],ue,3572445317),B=E(B,O,j,H,I[D+6],zn,76029189),H=E(H,B,O,j,I[D+9],Je,3654602809),j=E(j,H,B,O,I[D+12],de,3873151461),O=E(O,j,H,B,I[D+15],ue,530742520),B=E(B,O,j,H,I[D+2],zn,3299628645),H=x(H,B,O,j,I[D+0],_n,4096336452),j=x(j,H,B,O,I[D+7],pn,1126891415),O=x(O,j,H,B,I[D+14],gn,2878612391),B=x(B,O,j,H,I[D+5],mn,4237533241),H=x(H,B,O,j,I[D+12],_n,1700485571),j=x(j,H,B,O,I[D+3],pn,2399980690),O=x(O,j,H,B,I[D+10],gn,4293915773),B=x(B,O,j,H,I[D+1],mn,2240044497),H=x(H,B,O,j,I[D+8],_n,1873313359),j=x(j,H,B,O,I[D+15],pn,4264355552),O=x(O,j,H,B,I[D+6],gn,2734768916),B=x(B,O,j,H,I[D+13],mn,1309151649),H=x(H,B,O,j,I[D+4],_n,4149444226),j=x(j,H,B,O,I[D+11],pn,3174756917),O=x(O,j,H,B,I[D+2],gn,718787259),B=x(B,O,j,H,I[D+9],mn,3951481745),H=v(H,re),B=v(B,De),O=v(O,He),j=v(j,ae);var pr=W(H)+W(B)+W(O)+W(j);return pr.toLowerCase()},Pe.closeMediaStream=function(p){if(p)try{var g;if(p.getTracks){g=p.getTracks();var v=e(g),C;try{for(v.s();!(C=v.n()).done;){var w=C.value;w.stop()}}catch($){v.e($)}finally{v.f()}}else{g=p.getAudioTracks();var k=e(g),F;try{for(k.s();!(F=k.n()).done;){var T=F.value;T.stop()}}catch($){k.e($)}finally{k.f()}g=p.getVideoTracks();var S=e(g),E;try{for(S.s();!(E=S.n()).done;){var x=E.value;x.stop()}}catch($){S.e($)}finally{S.f()}}}catch($){(typeof p.stop=="function"||t(p.stop)==="object")&&p.stop()}},Pe.cloneArray=function(p){return p&&p.slice()||[]},Pe.cloneObject=function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return p&&Object.assign({},p)||g},Pe}var ef={exports:{}},jr=typeof Reflect=="object"?Reflect:null,f_=jr&&typeof jr.apply=="function"?jr.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Cl;jr&&typeof jr.ownKeys=="function"?Cl=jr.ownKeys:Object.getOwnPropertySymbols?Cl=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Cl=function(e){return Object.getOwnPropertyNames(e)};function PS(t){console&&console.warn&&console.warn(t)}var bm=Number.isNaN||function(e){return e!==e};function ge(){ge.init.call(this)}ef.exports=ge;ef.exports.once=MS;ge.EventEmitter=ge;ge.prototype._events=void 0;ge.prototype._eventsCount=0;ge.prototype._maxListeners=void 0;var d_=10;function Po(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ge,"defaultMaxListeners",{enumerable:!0,get:function(){return d_},set:function(t){if(typeof t!="number"||t<0||bm(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");d_=t}});ge.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ge.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||bm(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Om(t){return t._maxListeners===void 0?ge.defaultMaxListeners:t._maxListeners}ge.prototype.getMaxListeners=function(){return Om(this)};ge.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var l=e==="error",o=this._events;if(o!==void 0)l=l&&o.error===void 0;else if(!l)return!1;if(l){var n;if(r.length>0&&(n=r[0]),n instanceof Error)throw n;var f=new Error("Unhandled error."+(n?" ("+n.message+")":""));throw f.context=n,f}var h=o[e];if(h===void 0)return!1;if(typeof h=="function")f_(h,this,r);else for(var c=h.length,p=Mm(h,c),i=0;i<c;++i)f_(p[i],this,r);return!0};function Pm(t,e,r,i){var l,o,n;if(Po(r),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),n=o[e]),n===void 0)n=o[e]=r,++t._eventsCount;else if(typeof n=="function"?n=o[e]=i?[r,n]:[n,r]:i?n.unshift(r):n.push(r),l=Om(t),l>0&&n.length>l&&!n.warned){n.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+n.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=t,f.type=e,f.count=n.length,PS(f)}return t}ge.prototype.addListener=function(e,r){return Pm(this,e,r,!1)};ge.prototype.on=ge.prototype.addListener;ge.prototype.prependListener=function(e,r){return Pm(this,e,r,!0)};function xS(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function xm(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},l=xS.bind(i);return l.listener=r,i.wrapFn=l,l}ge.prototype.once=function(e,r){return Po(r),this.on(e,xm(this,e,r)),this};ge.prototype.prependOnceListener=function(e,r){return Po(r),this.prependListener(e,xm(this,e,r)),this};ge.prototype.removeListener=function(e,r){var i,l,o,n,f;if(Po(r),l=this._events,l===void 0)return this;if(i=l[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete l[e],l.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(o=-1,n=i.length-1;n>=0;n--)if(i[n]===r||i[n].listener===r){f=i[n].listener,o=n;break}if(o<0)return this;o===0?i.shift():DS(i,o),i.length===1&&(l[e]=i[0]),l.removeListener!==void 0&&this.emit("removeListener",e,f||r)}return this};ge.prototype.off=ge.prototype.removeListener;ge.prototype.removeAllListeners=function(e){var r,i,l;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var o=Object.keys(i),n;for(l=0;l<o.length;++l)n=o[l],n!=="removeListener"&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(l=r.length-1;l>=0;l--)this.removeListener(e,r[l]);return this};function Dm(t,e,r){var i=t._events;if(i===void 0)return[];var l=i[e];return l===void 0?[]:typeof l=="function"?r?[l.listener||l]:[l]:r?NS(l):Mm(l,l.length)}ge.prototype.listeners=function(e){return Dm(this,e,!0)};ge.prototype.rawListeners=function(e){return Dm(this,e,!1)};ge.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Nm.call(t,e)};ge.prototype.listenerCount=Nm;function Nm(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ge.prototype.eventNames=function(){return this._eventsCount>0?Cl(this._events):[]};function Mm(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function DS(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function NS(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function MS(t,e){return new Promise(function(r,i){function l(n){t.removeListener(e,o),i(n)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",l),r([].slice.call(arguments))}Lm(t,e,o,{once:!0}),e!=="error"&&LS(t,l,{once:!0})})}function LS(t,e,r){typeof t.on=="function"&&Lm(t,"error",e,r)}function Lm(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function l(o){i.once&&t.removeEventListener(e,l),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Bn=ef.exports,Wu={exports:{}},Da,h_;function US(){if(h_)return Da;h_=1;var t=1e3,e=t*60,r=e*60,i=r*24,l=i*7,o=i*365.25;Da=function(p,g){g=g||{};var v=typeof p;if(v==="string"&&p.length>0)return n(p);if(v==="number"&&isFinite(p))return g.long?h(p):f(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function n(p){if(p=String(p),!(p.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(g){var v=parseFloat(g[1]),C=(g[2]||"ms").toLowerCase();switch(C){case"years":case"year":case"yrs":case"yr":case"y":return v*o;case"weeks":case"week":case"w":return v*l;case"days":case"day":case"d":return v*i;case"hours":case"hour":case"hrs":case"hr":case"h":return v*r;case"minutes":case"minute":case"mins":case"min":case"m":return v*e;case"seconds":case"second":case"secs":case"sec":case"s":return v*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}}function f(p){var g=Math.abs(p);return g>=i?Math.round(p/i)+"d":g>=r?Math.round(p/r)+"h":g>=e?Math.round(p/e)+"m":g>=t?Math.round(p/t)+"s":p+"ms"}function h(p){var g=Math.abs(p);return g>=i?c(p,g,i,"day"):g>=r?c(p,g,r,"hour"):g>=e?c(p,g,e,"minute"):g>=t?c(p,g,t,"second"):p+" ms"}function c(p,g,v,C){var w=g>=v*1.5;return Math.round(p/v)+" "+C+(w?"s":"")}return Da}function FS(t){r.debug=r,r.default=r,r.coerce=h,r.disable=o,r.enable=l,r.enabled=n,r.humanize=US(),r.destroy=c,Object.keys(t).forEach(p=>{r[p]=t[p]}),r.names=[],r.skips=[],r.formatters={};function e(p){let g=0;for(let v=0;v<p.length;v++)g=(g<<5)-g+p.charCodeAt(v),g|=0;return r.colors[Math.abs(g)%r.colors.length]}r.selectColor=e;function r(p){let g,v=null,C,w;function k(...F){if(!k.enabled)return;const T=k,S=Number(new Date),E=S-(g||S);T.diff=E,T.prev=g,T.curr=S,g=S,F[0]=r.coerce(F[0]),typeof F[0]!="string"&&F.unshift("%O");let x=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,(W,z)=>{if(W==="%%")return"%";x++;const I=r.formatters[z];if(typeof I=="function"){const D=F[x];W=I.call(T,D),F.splice(x,1),x--}return W}),r.formatArgs.call(T,F),(T.log||r.log).apply(T,F)}return k.namespace=p,k.useColors=r.useColors(),k.color=r.selectColor(p),k.extend=i,k.destroy=r.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>v!==null?v:(C!==r.namespaces&&(C=r.namespaces,w=r.enabled(p)),w),set:F=>{v=F}}),typeof r.init=="function"&&r.init(k),k}function i(p,g){const v=r(this.namespace+(typeof g=="undefined"?":":g)+p);return v.log=this.log,v}function l(p){r.save(p),r.namespaces=p,r.names=[],r.skips=[];let g;const v=(typeof p=="string"?p:"").split(/[\s,]+/),C=v.length;for(g=0;g<C;g++)v[g]&&(p=v[g].replace(/\*/g,".*?"),p[0]==="-"?r.skips.push(new RegExp("^"+p.slice(1)+"$")):r.names.push(new RegExp("^"+p+"$")))}function o(){const p=[...r.names.map(f),...r.skips.map(f).map(g=>"-"+g)].join(",");return r.enable(""),p}function n(p){if(p[p.length-1]==="*")return!0;let g,v;for(g=0,v=r.skips.length;g<v;g++)if(r.skips[g].test(p))return!1;for(g=0,v=r.names.length;g<v;g++)if(r.names[g].test(p))return!0;return!1}function f(p){return p.toString().substring(2,p.toString().length-2).replace(/\.\*\?$/,"*")}function h(p){return p instanceof Error?p.stack||p.message:p}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var $S=FS;(function(t,e){e.formatArgs=i,e.save=l,e.load=o,e.useColors=r,e.storage=n(),e.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;h.splice(1,0,c,"color: inherit");let p=0,g=0;h[0].replace(/%[a-zA-Z%]/g,v=>{v!=="%%"&&(p++,v==="%c"&&(g=p))}),h.splice(g,0,c)}e.log=console.debug||console.log||(()=>{});function l(h){try{h?e.storage.setItem("debug",h):e.storage.removeItem("debug")}catch(c){}}function o(){let h;try{h=e.storage.getItem("debug")}catch(c){}return!h&&typeof process!="undefined"&&"env"in process&&(h={}.DEBUG),h}function n(){try{return localStorage}catch(h){}}t.exports=$S(e);const{formatters:f}=t.exports;f.j=function(h){try{return JSON.stringify(h)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(Wu,Wu.exports);var tf=Wu.exports;function HS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function __(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function jS(t,e,r){return e&&__(t.prototype,e),r&&__(t,r),t}var yr=tf,Sr="JsSIP",ze=function(){function t(e){HS(this,t),e?(this._debug=yr.default("".concat(Sr,":").concat(e)),this._warn=yr.default("".concat(Sr,":WARN:").concat(e)),this._error=yr.default("".concat(Sr,":ERROR:").concat(e))):(this._debug=yr.default(Sr),this._warn=yr.default("".concat(Sr,":WARN")),this._error=yr.default("".concat(Sr,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return jS(t,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),t}(),Jt={},Um={},Fm={exports:{}},p_=Fm.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(p_).forEach(function(t){var e=p_[t];e.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})});var $m=Fm.exports;(function(t){var e=function(f){return String(Number(f))===f?Number(f):f},r=function(f,h,c,p){if(p&&!c)h[p]=e(f[1]);else for(var g=0;g<c.length;g+=1)f[g+1]!=null&&(h[c[g]]=e(f[g+1]))},i=function(f,h,c){var p=f.name&&f.names;f.push&&!h[f.push]?h[f.push]=[]:p&&!h[f.name]&&(h[f.name]={});var g=f.push?{}:p?h[f.name]:h;r(c.match(f.reg),g,f.names,f.name),f.push&&h[f.push].push(g)},l=$m,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(f){var h={},c=[],p=h;return f.split(/(\r\n|\r|\n)/).filter(o).forEach(function(g){var v=g[0],C=g.slice(2);v==="m"&&(c.push({rtp:[],fmtp:[]}),p=c[c.length-1]);for(var w=0;w<(l[v]||[]).length;w+=1){var k=l[v][w];if(k.reg.test(C))return i(k,p,C)}}),h.media=c,h};var n=function(f,h){var c=h.split(/=(.+)/,2);return c.length===2?f[c[0]]=e(c[1]):c.length===1&&h.length>1&&(f[c[0]]=void 0),f};t.parseParams=function(f){return f.split(/;\s?/).reduce(n,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(f){return f.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(f){for(var h=[],c=f.split(" ").map(e),p=0;p<c.length;p+=3)h.push({component:c[p],ip:c[p+1],port:c[p+2]});return h},t.parseImageAttributes=function(f){return f.split(" ").map(function(h){return h.substring(1,h.length-1).split(",").reduce(n,{})})},t.parseSimulcastStreamList=function(f){return f.split(";").map(function(h){return h.split(",").map(function(c){var p,g=!1;return c[0]!=="~"?p=e(c):(p=e(c.substring(1,c.length)),g=!0),{scid:p,paused:g}})})}})(Um);var Na=$m,VS=/%[sdv%]/g,BS=function(t){var e=1,r=arguments,i=r.length;return t.replace(VS,function(l){if(e>=i)return l;var o=r[e];switch(e+=1,l){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},gi=function(t,e,r){var i=e.format instanceof Function?e.format(e.push?r:r[e.name]):e.format,l=[t+"="+i];if(e.names)for(var o=0;o<e.names.length;o+=1){var n=e.names[o];e.name?l.push(r[e.name][n]):l.push(r[e.names[o]])}else l.push(r[e.name]);return BS.apply(null,l)},zS=["v","o","s","i","u","e","p","c","b","t","r","z","a"],qS=["i","c","b","a"],WS=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(o){o.payloads==null&&(o.payloads="")});var r=e.outerOrder||zS,i=e.innerOrder||qS,l=[];return r.forEach(function(o){Na[o].forEach(function(n){n.name in t&&t[n.name]!=null?l.push(gi(o,n,t)):n.push in t&&t[n.push]!=null&&t[n.push].forEach(function(f){l.push(gi(o,n,f))})})}),t.media.forEach(function(o){l.push(gi("m",Na.m[0],o)),i.forEach(function(n){Na[n].forEach(function(f){f.name in o&&o[f.name]!=null?l.push(gi(n,f,o)):f.push in o&&o[f.push]!=null&&o[f.push].forEach(function(h){l.push(gi(n,f,h))})})})}),l.join(`\r
`)+`\r
`},_r=Um,GS=WS;Jt.write=GS;Jt.parse=_r.parse;Jt.parseParams=_r.parseParams;Jt.parseFmtpConfig=_r.parseFmtpConfig;Jt.parsePayloads=_r.parsePayloads;Jt.parseRemoteCandidates=_r.parseRemoteCandidates;Jt.parseImageAttributes=_r.parseImageAttributes;Jt.parseSimulcastStreamList=_r.parseSimulcastStreamList;function Tl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Tl=function(r){return typeof r}:Tl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Tl(t)}function nf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gu(t,e)}function Gu(t,e){return Gu=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Gu(t,e)}function rf(t){var e=YS();return function(){var i=no(t),l;if(e){var o=no(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return KS(this,l)}}function KS(t,e){return e&&(Tl(e)==="object"||typeof e=="function")?e:QS(t)}function QS(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function no(t){return no=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},no(t)}function bt(t,e){var r;if(typeof Symbol=="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=JS(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var i=0,l=function(){};return{s:l,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(c){throw c},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,n=!1,f;return{s:function(){r=t[Symbol.iterator]()},n:function(){var c=r.next();return o=c.done,c},e:function(c){n=!0,f=c},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(n)throw f}}}}function JS(t,e){if(t){if(typeof t=="string")return g_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g_(t,e)}}function g_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function us(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xo(t,e,r){return e&&m_(t.prototype,e),r&&m_(t,r),t}var Hm=Jt,XS=ze,Ke=Ue,Me=nt(),v_=Zc(),ZS=Yt(),Ma=new XS("SIPMessage"),jm=function(){function t(e,r,i,l,o,n){if(us(this,t),!e||!r||!i)return null;l=l||{},this.ua=i,this.headers={},this.method=e,this.ruri=r,this.body=n,this.extraHeaders=Me.cloneArray(o),this.ua.configuration.extra_headers&&(this.extraHeaders=this.extraHeaders.concat(this.ua.configuration.extra_headers)),l.route_set?this.setHeader("route",l.route_set):i.configuration.use_preloaded_route&&this.setHeader("route","<".concat(i.transport.sip_uri,";lr>")),this.setHeader("via",""),this.setHeader("max-forwards",Ke.MAX_FORWARDS);var f=l.to_uri||r,h=l.to_tag?{tag:l.to_tag}:null,c=typeof l.to_display_name!="undefined"?l.to_display_name:null;this.to=new v_(f,c,h),this.setHeader("to",this.to.toString());var p=l.from_uri||i.configuration.uri,g={tag:l.from_tag||Me.newTag()},v;typeof l.from_display_name!="undefined"?v=l.from_display_name:i.configuration.display_name?v=i.configuration.display_name:v=null,this.from=new v_(p,v,g),this.setHeader("from",this.from.toString());var C=l.call_id||i.configuration.jssip_id+Me.createRandomToken(15);this.call_id=C,this.setHeader("call-id",C);var w=l.cseq||Math.floor(Math.random()*1e4);this.cseq=w,this.setHeader("cseq","".concat(w," ").concat(e))}return xo(t,[{key:"setHeader",value:function(r,i){for(var l=new RegExp("^\\s*".concat(r,"\\s*:"),"i"),o=0;o<this.extraHeaders.length;o++)l.test(this.extraHeaders[o])&&this.extraHeaders.splice(o,1);this.headers[Me.headerize(r)]=Array.isArray(i)?i:[i]}},{key:"getHeader",value:function(r){var i=this.headers[Me.headerize(r)];if(i){if(i[0])return i[0]}else{var l=new RegExp("^\\s*".concat(r,"\\s*:"),"i"),o=bt(this.extraHeaders),n;try{for(o.s();!(n=o.n()).done;){var f=n.value;if(l.test(f))return f.substring(f.indexOf(":")+1).trim()}}catch(h){o.e(h)}finally{o.f()}}}},{key:"getHeaders",value:function(r){var i=this.headers[Me.headerize(r)],l=[];if(i){var o=bt(i),n;try{for(o.s();!(n=o.n()).done;){var f=n.value;l.push(f)}}catch(v){o.e(v)}finally{o.f()}return l}else{var h=new RegExp("^\\s*".concat(r,"\\s*:"),"i"),c=bt(this.extraHeaders),p;try{for(c.s();!(p=c.n()).done;){var g=p.value;h.test(g)&&l.push(g.substring(g.indexOf(":")+1).trim())}}catch(v){c.e(v)}finally{c.f()}return l}}},{key:"hasHeader",value:function(r){if(this.headers[Me.headerize(r)])return!0;var i=new RegExp("^\\s*".concat(r,"\\s*:"),"i"),l=bt(this.extraHeaders),o;try{for(l.s();!(o=l.n()).done;){var n=o.value;if(i.test(n))return!0}}catch(f){l.e(f)}finally{l.f()}return!1}},{key:"parseSDP",value:function(r){return!r&&this.sdp?this.sdp:(this.sdp=Hm.parse(this.body||""),this.sdp)}},{key:"toString",value:function(){var r="".concat(this.method," ").concat(this.ruri,` SIP/2.0\r
`);for(var i in this.headers)if(Object.prototype.hasOwnProperty.call(this.headers,i)){var l=bt(this.headers[i]),o;try{for(l.s();!(o=l.n()).done;){var n=o.value;r+="".concat(i,": ").concat(n,`\r
`)}}catch(C){l.e(C)}finally{l.f()}}var f=bt(this.extraHeaders),h;try{for(f.s();!(h=f.n()).done;){var c=h.value;r+="".concat(c.trim(),`\r
`)}}catch(C){f.e(C)}finally{f.f()}var p=[];switch(this.method){case Ke.REGISTER:p.push("path","gruu");break;case Ke.INVITE:this.ua.configuration.session_timers&&p.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&p.push("gruu"),p.push("ice","replaces");break;case Ke.UPDATE:this.ua.configuration.session_timers&&p.push("timer"),p.push("ice");break}p.push("outbound");var g=this.ua.configuration.user_agent||Ke.USER_AGENT;if(r+="Allow: ".concat(Ke.ALLOWED_METHODS,`\r
`),r+="Supported: ".concat(p,`\r
`),r+="User-Agent: ".concat(g,`\r
`),this.body){var v=Me.str_utf8_length(this.body);r+="Content-Length: ".concat(v,`\r
\r
`),r+=this.body}else r+=`Content-Length: 0\r
\r
`;return r}},{key:"clone",value:function(){var r=new t(this.method,this.ruri,this.ua);return Object.keys(this.headers).forEach(function(i){r.headers[i]=this.headers[i].slice()},this),r.body=this.body,r.extraHeaders=Me.cloneArray(this.extraHeaders),r.to=this.to,r.from=this.from,r.call_id=this.call_id,r.cseq=this.cseq,r}}]),t}(),eC=function(t){nf(r,t);var e=rf(r);function r(i,l,o,n,f){var h;return us(this,r),h=e.call(this,Ke.INVITE,i,l,o,n,f),h.transaction=null,h}return xo(r,[{key:"cancel",value:function(l){this.transaction.cancel(l)}},{key:"clone",value:function(){var l=new r(this.ruri,this.ua);return Object.keys(this.headers).forEach(function(o){l.headers[o]=this.headers[o].slice()},this),l.body=this.body,l.extraHeaders=Me.cloneArray(this.extraHeaders),l.to=this.to,l.from=this.from,l.call_id=this.call_id,l.cseq=this.cseq,l.transaction=this.transaction,l}}]),r}(jm),Vm=function(){function t(){us(this,t),this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null,this.sdp=null}return xo(t,[{key:"addHeader",value:function(r,i){var l={raw:i};r=Me.headerize(r),this.headers[r]?this.headers[r].push(l):this.headers[r]=[l]}},{key:"getHeader",value:function(r){var i=this.headers[Me.headerize(r)];if(i){if(i[0])return i[0].raw}else return}},{key:"getHeaders",value:function(r){var i=this.headers[Me.headerize(r)],l=[];if(!i)return[];var o=bt(i),n;try{for(o.s();!(n=o.n()).done;){var f=n.value;l.push(f.raw)}}catch(h){o.e(h)}finally{o.f()}return l}},{key:"hasHeader",value:function(r){return!!this.headers[Me.headerize(r)]}},{key:"parseHeader",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(r=Me.headerize(r),this.headers[r]){if(i>=this.headers[r].length){Ma.debug('not so many "'.concat(r,'" headers present'));return}}else{Ma.debug('header "'.concat(r,'" not present'));return}var l=this.headers[r][i],o=l.raw;if(l.parsed)return l.parsed;var n=ZS.parse(o,r.replace(/-/g,"_"));if(n===-1){this.headers[r].splice(i,1),Ma.debug('error parsing "'.concat(r,'" header field with value "').concat(o,'"'));return}else return l.parsed=n,n}},{key:"s",value:function(r,i){return this.parseHeader(r,i)}},{key:"setHeader",value:function(r,i){var l={raw:i};this.headers[Me.headerize(r)]=[l]}},{key:"parseSDP",value:function(r){return!r&&this.sdp?this.sdp:(this.sdp=Hm.parse(this.body||""),this.sdp)}},{key:"toString",value:function(){return this.data}}]),t}(),tC=function(t){nf(r,t);var e=rf(r);function r(i){var l;return us(this,r),l=e.call(this),l.ua=i,l.headers={},l.ruri=null,l.transport=null,l.server_transaction=null,l}return xo(r,[{key:"reply",value:function(l,o,n,f,h,c){var p=[],g=this.getHeader("To");if(l=l||null,o=o||null,!l||l<100||l>699)throw new TypeError("Invalid status_code: ".concat(l));if(o&&typeof o!="string"&&!(o instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(o));o=o||Ke.REASON_PHRASE[l]||"",n=Me.cloneArray(n),this.ua.configuration.extra_headers&&(n=n.concat(this.ua.configuration.extra_headers));var v="SIP/2.0 ".concat(l," ").concat(o,`\r
`);if(this.method===Ke.INVITE&&l>100&&l<=200){var C=this.getHeaders("record-route"),w=bt(C),k;try{for(w.s();!(k=w.n()).done;){var F=k.value;v+="Record-Route: ".concat(F,`\r
`)}}catch(D){w.e(D)}finally{w.f()}}var T=this.getHeaders("via"),S=bt(T),E;try{for(S.s();!(E=S.n()).done;){var x=E.value;v+="Via: ".concat(x,`\r
`)}}catch(D){S.e(D)}finally{S.f()}!this.to_tag&&l>100?g+=";tag=".concat(Me.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(g+=";tag=".concat(this.to_tag)),v+="To: ".concat(g,`\r
`),v+="From: ".concat(this.getHeader("From"),`\r
`),v+="Call-ID: ".concat(this.call_id,`\r
`),v+="CSeq: ".concat(this.cseq," ").concat(this.method,`\r
`);var $=bt(n),W;try{for($.s();!(W=$.n()).done;){var z=W.value;v+="".concat(z.trim(),`\r
`)}}catch(D){$.e(D)}finally{$.f()}switch(this.method){case Ke.INVITE:this.ua.configuration.session_timers&&p.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&p.push("gruu"),p.push("ice","replaces");break;case Ke.UPDATE:this.ua.configuration.session_timers&&p.push("timer"),f&&p.push("ice"),p.push("replaces")}if(p.push("outbound"),this.method===Ke.OPTIONS?(v+="Allow: ".concat(Ke.ALLOWED_METHODS,`\r
`),v+="Accept: ".concat(Ke.ACCEPTED_BODY_TYPES,`\r
`)):l===405?v+="Allow: ".concat(Ke.ALLOWED_METHODS,`\r
`):l===415&&(v+="Accept: ".concat(Ke.ACCEPTED_BODY_TYPES,`\r
`)),v+="Supported: ".concat(p,`\r
`),f){var I=Me.str_utf8_length(f);v+=`Content-Type: application/sdp\r
`,v+="Content-Length: ".concat(I,`\r
\r
`),v+=f}else v+="Content-Length: ".concat(0,`\r
\r
`);this.server_transaction.receiveResponse(l,v,h,c)}},{key:"reply_sl",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=this.getHeaders("via");if(!l||l<100||l>699)throw new TypeError("Invalid status_code: ".concat(l));if(o&&typeof o!="string"&&!(o instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(o));o=o||Ke.REASON_PHRASE[l]||"";var f="SIP/2.0 ".concat(l," ").concat(o,`\r
`),h=bt(n),c;try{for(h.s();!(c=h.n()).done;){var p=c.value;f+="Via: ".concat(p,`\r
`)}}catch(k){h.e(k)}finally{h.f()}var g=this.getHeader("To");if(!this.to_tag&&l>100?g+=";tag=".concat(Me.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(g+=";tag=".concat(this.to_tag)),f+="To: ".concat(g,`\r
`),f+="From: ".concat(this.getHeader("From"),`\r
`),f+="Call-ID: ".concat(this.call_id,`\r
`),f+="CSeq: ".concat(this.cseq," ").concat(this.method,`\r
`),this.ua.configuration.extra_headers){var v=bt(this.ua.configuration.extra_headers),C;try{for(v.s();!(C=v.n()).done;){var w=C.value;f+="".concat(w.trim(),`\r
`)}}catch(k){v.e(k)}finally{v.f()}}f+="Content-Length: ".concat(0,`\r
\r
`),this.transport.send(f)}}]),r}(Vm),nC=function(t){nf(r,t);var e=rf(r);function r(){var i;return us(this,r),i=e.call(this),i.headers={},i.status_code=null,i.reason_phrase=null,i}return r}(Vm),hn={OutgoingRequest:jm,InitialOutgoingInviteRequest:eC,IncomingRequest:tC,IncomingResponse:nC};function rC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function iC(t,e,r){return e&&y_(t.prototype,e),r&&y_(t,r),t}var sC=ze,Zt=nt(),Mt=new sC("DigestAuthentication"),lC=function(){function t(e){rC(this,t),this._credentials=e,this._cnonce=null,this._nc=0,this._ncHex="00000000",this._algorithm=null,this._realm=null,this._nonce=null,this._opaque=null,this._stale=null,this._qop=null,this._method=null,this._uri=null,this._ha1=null,this._response=null}return iC(t,[{key:"get",value:function(r){switch(r){case"realm":return this._realm;case"ha1":return this._ha1;default:Mt.warn('get() | cannot get "%s" parameter',r);return}}},{key:"authenticate",value:function(r,i){var l=r.method,o=r.ruri,n=r.body,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(this._algorithm=i.algorithm,this._realm=i.realm,this._nonce=i.nonce,this._opaque=i.opaque,this._stale=i.stale,this._algorithm){if(this._algorithm!=="MD5")return Mt.warn('authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this._algorithm="MD5";if(!this._nonce)return Mt.warn("authenticate() | challenge without Digest nonce, authentication aborted"),!1;if(!this._realm)return Mt.warn("authenticate() | challenge without Digest realm, authentication aborted"),!1;if(!this._credentials.password){if(!this._credentials.ha1)return Mt.warn("authenticate() | no plain SIP password nor ha1 provided, authentication aborted"),!1;if(this._credentials.realm!==this._realm)return Mt.warn('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]',this._credentials.realm,this._realm),!1}if(i.qop)if(i.qop.indexOf("auth-int")>-1)this._qop="auth-int";else if(i.qop.indexOf("auth")>-1)this._qop="auth";else return Mt.warn('authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;else this._qop=null;this._method=l,this._uri=o,this._cnonce=f||Zt.createRandomToken(12),this._nc+=1;var h=Number(this._nc).toString(16);this._ncHex="00000000".substr(0,8-h.length)+h,this._nc===4294967296&&(this._nc=1,this._ncHex="00000001"),this._credentials.password?this._ha1=Zt.calculateMD5("".concat(this._credentials.username,":").concat(this._realm,":").concat(this._credentials.password)):this._ha1=this._credentials.ha1;var c,p;return this._qop==="auth"?(c="".concat(this._method,":").concat(this._uri),p=Zt.calculateMD5(c),Mt.debug('authenticate() | using qop=auth [a2:"%s"]',c),this._response=Zt.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth:").concat(p))):this._qop==="auth-int"?(c="".concat(this._method,":").concat(this._uri,":").concat(Zt.calculateMD5(n||"")),p=Zt.calculateMD5(c),Mt.debug('authenticate() | using qop=auth-int [a2:"%s"]',c),this._response=Zt.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth-int:").concat(p))):this._qop===null&&(c="".concat(this._method,":").concat(this._uri),p=Zt.calculateMD5(c),Mt.debug('authenticate() | using qop=null [a2:"%s"]',c),this._response=Zt.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(p))),Mt.debug("authenticate() | response generated"),!0}},{key:"toString",value:function(){var r=[];if(!this._response)throw new Error("response field does not exist, cannot generate Authorization header");return r.push("algorithm=".concat(this._algorithm)),r.push('username="'.concat(this._credentials.username,'"')),r.push('realm="'.concat(this._realm,'"')),r.push('nonce="'.concat(this._nonce,'"')),r.push('uri="'.concat(this._uri,'"')),r.push('response="'.concat(this._response,'"')),this._opaque&&r.push('opaque="'.concat(this._opaque,'"')),this._qop&&(r.push("qop=".concat(this._qop)),r.push('cnonce="'.concat(this._cnonce,'"')),r.push("nc=".concat(this._ncHex))),"Digest ".concat(r.join(", "))}}]),t}(),en=500,oC=4e3,S_=5e3,Bm={T1:en,T2:oC,T4:S_,TIMER_B:64*en,TIMER_D:0*en,TIMER_F:64*en,TIMER_H:64*en,TIMER_I:0*en,TIMER_J:0*en,TIMER_K:0*S_,TIMER_L:64*en,TIMER_M:64*en,PROVISIONAL_RESPONSE_INTERVAL:6e4};function wl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wl=function(r){return typeof r}:wl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},wl(t)}function cs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fs(t,e,r){return e&&C_(t.prototype,e),r&&C_(t,r),t}function ds(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ku(t,e)}function Ku(t,e){return Ku=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Ku(t,e)}function hs(t){var e=uC();return function(){var i=ro(t),l;if(e){var o=ro(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return aC(this,l)}}function aC(t,e){return e&&(wl(e)==="object"||typeof e=="function")?e:Un(t)}function Un(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function ro(t){return ro=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ro(t)}var _s=Bn.EventEmitter,ps=ze,Ui=Ue,T_=hn,Qt=Bm,w_=new ps("NonInviteClientTransaction"),Ys=new ps("InviteClientTransaction"),cC=new ps("AckClientTransaction"),E_=new ps("NonInviteServerTransaction"),Js=new ps("InviteServerTransaction"),K={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},fC=function(t){ds(r,t);var e=hs(r);function r(i,l,o,n){var f;cs(this,r),f=e.call(this),f.type=K.NON_INVITE_CLIENT,f.id="z9hG4bK".concat(Math.floor(Math.random()*1e7)),f.ua=i,f.transport=l,f.request=o,f.eventHandlers=n;var h="SIP/2.0/".concat(l.via_transport);return h+=" ".concat(i.configuration.via_host,";branch=").concat(f.id),f.request.setHeader("via",h),f.ua.newTransaction(Un(f)),f}return fs(r,[{key:"stateChanged",value:function(l){this.state=l,this.emit("stateChanged")}},{key:"send",value:function(){var l=this;this.stateChanged(K.STATUS_TRYING),this.F=setTimeout(function(){l.timer_F()},Qt.TIMER_F),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){w_.debug("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.F),clearTimeout(this.K),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onTransportError()}},{key:"timer_F",value:function(){w_.debug("Timer F expired for transaction ".concat(this.id)),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout()}},{key:"timer_K",value:function(){this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"receiveResponse",value:function(l){var o=this,n=l.status_code;if(n<200)switch(this.state){case K.STATUS_TRYING:case K.STATUS_PROCEEDING:this.stateChanged(K.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(l);break}else switch(this.state){case K.STATUS_TRYING:case K.STATUS_PROCEEDING:this.stateChanged(K.STATUS_COMPLETED),clearTimeout(this.F),n===408?this.eventHandlers.onRequestTimeout():this.eventHandlers.onReceiveResponse(l),this.K=setTimeout(function(){o.timer_K()},Qt.TIMER_K);break;case K.STATUS_COMPLETED:break}}},{key:"C",get:function(){return K}}]),r}(_s),dC=function(t){ds(r,t);var e=hs(r);function r(i,l,o,n){var f;cs(this,r),f=e.call(this),f.type=K.INVITE_CLIENT,f.id="z9hG4bK".concat(Math.floor(Math.random()*1e7)),f.ua=i,f.transport=l,f.request=o,f.eventHandlers=n,o.transaction=Un(f);var h="SIP/2.0/".concat(l.via_transport);return h+=" ".concat(i.configuration.via_host,";branch=").concat(f.id),f.request.setHeader("via",h),f.ua.newTransaction(Un(f)),f}return fs(r,[{key:"stateChanged",value:function(l){this.state=l,this.emit("stateChanged")}},{key:"send",value:function(){var l=this;this.stateChanged(K.STATUS_CALLING),this.B=setTimeout(function(){l.timer_B()},Qt.TIMER_B),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){clearTimeout(this.B),clearTimeout(this.D),clearTimeout(this.M),this.state!==K.STATUS_ACCEPTED&&(Ys.debug("transport error occurred, deleting transaction ".concat(this.id)),this.eventHandlers.onTransportError()),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_M",value:function(){Ys.debug("Timer M expired for transaction ".concat(this.id)),this.state===K.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"timer_B",value:function(){Ys.debug("Timer B expired for transaction ".concat(this.id)),this.state===K.STATUS_CALLING&&(this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout())}},{key:"timer_D",value:function(){Ys.debug("Timer D expired for transaction ".concat(this.id)),clearTimeout(this.B),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"sendACK",value:function(l){var o=this,n=new T_.OutgoingRequest(Ui.ACK,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});n.setHeader("from",this.request.getHeader("from")),n.setHeader("via",this.request.getHeader("via")),n.setHeader("to",l.getHeader("to")),this.D=setTimeout(function(){o.timer_D()},Qt.TIMER_D),this.transport.send(n)}},{key:"cancel",value:function(l){if(this.state===K.STATUS_PROCEEDING){var o=new T_.OutgoingRequest(Ui.CANCEL,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});o.setHeader("from",this.request.getHeader("from")),o.setHeader("via",this.request.getHeader("via")),o.setHeader("to",this.request.getHeader("to")),l&&o.setHeader("reason",l),this.transport.send(o)}}},{key:"receiveResponse",value:function(l){var o=this,n=l.status_code;if(n>=100&&n<=199)switch(this.state){case K.STATUS_CALLING:this.stateChanged(K.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(l);break;case K.STATUS_PROCEEDING:this.eventHandlers.onReceiveResponse(l);break}else if(n>=200&&n<=299)switch(this.state){case K.STATUS_CALLING:case K.STATUS_PROCEEDING:this.stateChanged(K.STATUS_ACCEPTED),this.M=setTimeout(function(){o.timer_M()},Qt.TIMER_M),this.eventHandlers.onReceiveResponse(l);break;case K.STATUS_ACCEPTED:this.eventHandlers.onReceiveResponse(l);break}else if(n>=300&&n<=699)switch(this.state){case K.STATUS_CALLING:case K.STATUS_PROCEEDING:this.stateChanged(K.STATUS_COMPLETED),this.sendACK(l),this.eventHandlers.onReceiveResponse(l);break;case K.STATUS_COMPLETED:this.sendACK(l);break}}},{key:"C",get:function(){return K}}]),r}(_s),hC=function(t){ds(r,t);var e=hs(r);function r(i,l,o,n){var f;cs(this,r),f=e.call(this),f.id="z9hG4bK".concat(Math.floor(Math.random()*1e7)),f.transport=l,f.request=o,f.eventHandlers=n;var h="SIP/2.0/".concat(l.via_transport);return h+=" ".concat(i.configuration.via_host,";branch=").concat(f.id),f.request.setHeader("via",h),f}return fs(r,[{key:"send",value:function(){this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){cC.debug("transport error occurred for transaction ".concat(this.id)),this.eventHandlers.onTransportError()}},{key:"C",get:function(){return K}}]),r}(_s),_C=function(t){ds(r,t);var e=hs(r);function r(i,l,o){var n;return cs(this,r),n=e.call(this),n.type=K.NON_INVITE_SERVER,n.id=o.via_branch,n.ua=i,n.transport=l,n.request=o,n.last_response="",o.server_transaction=Un(n),n.state=K.STATUS_TRYING,i.newTransaction(Un(n)),n}return fs(r,[{key:"stateChanged",value:function(l){this.state=l,this.emit("stateChanged")}},{key:"timer_J",value:function(){E_.debug("Timer J expired for transaction ".concat(this.id)),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"onTransportError",value:function(){this.transportError||(this.transportError=!0,E_.debug("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.J),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"receiveResponse",value:function(l,o,n,f){var h=this;if(l===100)switch(this.state){case K.STATUS_TRYING:this.stateChanged(K.STATUS_PROCEEDING),this.transport.send(o)||this.onTransportError();break;case K.STATUS_PROCEEDING:this.last_response=o,this.transport.send(o)?n&&n():(this.onTransportError(),f&&f());break}else if(l>=200&&l<=699)switch(this.state){case K.STATUS_TRYING:case K.STATUS_PROCEEDING:this.stateChanged(K.STATUS_COMPLETED),this.last_response=o,this.J=setTimeout(function(){h.timer_J()},Qt.TIMER_J),this.transport.send(o)?n&&n():(this.onTransportError(),f&&f());break;case K.STATUS_COMPLETED:break}}},{key:"C",get:function(){return K}}]),r}(_s),pC=function(t){ds(r,t);var e=hs(r);function r(i,l,o){var n;return cs(this,r),n=e.call(this),n.type=K.INVITE_SERVER,n.id=o.via_branch,n.ua=i,n.transport=l,n.request=o,n.last_response="",o.server_transaction=Un(n),n.state=K.STATUS_PROCEEDING,i.newTransaction(Un(n)),n.resendProvisionalTimer=null,o.reply(100),n}return fs(r,[{key:"stateChanged",value:function(l){this.state=l,this.emit("stateChanged")}},{key:"timer_H",value:function(){Js.debug("Timer H expired for transaction ".concat(this.id)),this.state===K.STATUS_COMPLETED&&Js.debug("ACK not received, dialog will be terminated"),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_I",value:function(){this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_L",value:function(){Js.debug("Timer L expired for transaction ".concat(this.id)),this.state===K.STATUS_ACCEPTED&&(this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"onTransportError",value:function(){this.transportError||(this.transportError=!0,Js.debug("transport error occurred, deleting transaction ".concat(this.id)),this.resendProvisionalTimer!==null&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),clearTimeout(this.I),this.stateChanged(K.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"resend_provisional",value:function(){this.transport.send(this.last_response)||this.onTransportError()}},{key:"receiveResponse",value:function(l,o,n,f){var h=this;if(l>=100&&l<=199)switch(this.state){case K.STATUS_PROCEEDING:this.transport.send(o)||this.onTransportError(),this.last_response=o;break}if(l>100&&l<=199&&this.state===K.STATUS_PROCEEDING)this.resendProvisionalTimer===null&&(this.resendProvisionalTimer=setInterval(function(){h.resend_provisional()},Qt.PROVISIONAL_RESPONSE_INTERVAL));else if(l>=200&&l<=299)switch(this.state){case K.STATUS_PROCEEDING:this.stateChanged(K.STATUS_ACCEPTED),this.last_response=o,this.L=setTimeout(function(){h.timer_L()},Qt.TIMER_L),this.resendProvisionalTimer!==null&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case K.STATUS_ACCEPTED:this.transport.send(o)?n&&n():(this.onTransportError(),f&&f());break}else if(l>=300&&l<=699)switch(this.state){case K.STATUS_PROCEEDING:this.resendProvisionalTimer!==null&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(o)?(this.stateChanged(K.STATUS_COMPLETED),this.H=setTimeout(function(){h.timer_H()},Qt.TIMER_H),n&&n()):(this.onTransportError(),f&&f());break}}},{key:"C",get:function(){return K}}]),r}(_s);function gC(t,e){var r=t._transactions,i;switch(e.method){case Ui.INVITE:if(i=r.ist[e.via_branch],i){switch(i.state){case K.STATUS_PROCEEDING:i.transport.send(i.last_response);break;case K.STATUS_ACCEPTED:break}return!0}break;case Ui.ACK:if(i=r.ist[e.via_branch],i){if(i.state===K.STATUS_ACCEPTED)return!1;if(i.state===K.STATUS_COMPLETED)return i.state=K.STATUS_CONFIRMED,i.I=setTimeout(function(){i.timer_I()},Qt.TIMER_I),!0}else return!1;break;case Ui.CANCEL:return i=r.ist[e.via_branch],i?(e.reply_sl(200),i.state!==K.STATUS_PROCEEDING):(e.reply_sl(481),!0);default:if(i=r.nist[e.via_branch],i){switch(i.state){case K.STATUS_TRYING:break;case K.STATUS_PROCEEDING:case K.STATUS_COMPLETED:i.transport.send(i.last_response);break}return!0}break}}var gs={C:K,NonInviteClientTransaction:fC,InviteClientTransaction:dC,AckClientTransaction:hC,NonInviteServerTransaction:_C,InviteServerTransaction:pC,checkTransaction:gC};function mC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function vC(t,e,r){return e&&A_(t.prototype,e),r&&A_(t,r),t}var yC=ze,R_=Ue,SC=lC,La=gs,CC=new yC("RequestSender"),Ua={onRequestTimeout:function(){},onTransportError:function(){},onReceiveResponse:function(){},onAuthenticated:function(){}},ms=function(){function t(e,r,i){mC(this,t),this._ua=e,this._eventHandlers=i,this._method=r.method,this._request=r,this._auth=null,this._challenged=!1,this._staled=!1;for(var l in Ua)Object.prototype.hasOwnProperty.call(Ua,l)&&(this._eventHandlers[l]||(this._eventHandlers[l]=Ua[l]));e.status===e.C.STATUS_USER_CLOSED&&(this._method!==R_.BYE||this._method!==R_.ACK)&&this._eventHandlers.onTransportError()}return vC(t,[{key:"send",value:function(){var r=this,i={onRequestTimeout:function(){r._eventHandlers.onRequestTimeout()},onTransportError:function(){r._eventHandlers.onTransportError()},onReceiveResponse:function(o){r._receiveResponse(o)}};switch(this._method){case"INVITE":this.clientTransaction=new La.InviteClientTransaction(this._ua,this._ua.transport,this._request,i);break;case"ACK":this.clientTransaction=new La.AckClientTransaction(this._ua,this._ua.transport,this._request,i);break;default:this.clientTransaction=new La.NonInviteClientTransaction(this._ua,this._ua.transport,this._request,i)}this._ua._configuration.authorization_jwt&&this._request.setHeader("Authorization",this._ua._configuration.authorization_jwt),this.clientTransaction.send()}},{key:"_receiveResponse",value:function(r){var i,l,o=r.status_code;if((o===401||o===407)&&(this._ua.configuration.password!==null||this._ua.configuration.ha1!==null)){if(r.status_code===401?(i=r.parseHeader("www-authenticate"),l="authorization"):(i=r.parseHeader("proxy-authenticate"),l="proxy-authorization"),!i){CC.debug("".concat(r.status_code," with wrong or missing challenge, cannot authenticate")),this._eventHandlers.onReceiveResponse(r);return}if(!this._challenged||!this._staled&&i.stale===!0){if(this._auth||(this._auth=new SC({username:this._ua.configuration.authorization_user,password:this._ua.configuration.password,realm:this._ua.configuration.realm,ha1:this._ua.configuration.ha1})),!this._auth.authenticate(this._request,i)){this._eventHandlers.onReceiveResponse(r);return}this._challenged=!0,this._ua.set("realm",this._auth.get("realm")),this._ua.set("ha1",this._auth.get("ha1")),i.stale&&(this._staled=!0),this._request=this._request.clone(),this._request.cseq+=1,this._request.setHeader("cseq","".concat(this._request.cseq," ").concat(this._method)),this._request.setHeader(l,this._auth.toString()),this._eventHandlers.onAuthenticated(this._request),this.send()}else this._eventHandlers.onReceiveResponse(r)}else this._eventHandlers.onReceiveResponse(r)}}]),t}();function TC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function wC(t,e,r){return e&&k_(t.prototype,e),r&&k_(t,r),t}var EC=ze,Fa=nt(),Qn=Ue,I_=hn,b_=ms,mi=new EC("Registrator"),Xs=10,AC=function(){function t(e,r){TC(this,t),this._reg_id=1,this._ua=e,this._transport=r,this._registrar=e.configuration.registrar_server,this._expires=e.configuration.register_expires,this._call_id=Fa.createRandomToken(22),this._cseq=0,this._to_uri=e.configuration.uri,this._registrationTimer=null,this._registering=!1,this._registered=!1,this._contact=this._ua.contact.toString(),this._contact+=";+sip.ice",this._extraHeaders=[],this._extraContactParams="",this._sipInstance='"<urn:uuid:'.concat(this._ua.configuration.instance_id,'>"'),this._contact+=";reg-id=".concat(this._reg_id),this._contact+=";+sip.instance=".concat(this._sipInstance)}return wC(t,[{key:"setExtraHeaders",value:function(r){Array.isArray(r)||(r=[]),this._extraHeaders=r.slice()}},{key:"setExtraContactParams",value:function(r){r instanceof Object||(r={}),this._extraContactParams="";for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var l=r[i];this._extraContactParams+=";".concat(i),l&&(this._extraContactParams+="=".concat(l))}}},{key:"register",value:function(){var r=this;if(this._registering){mi.debug("Register request in progress...");return}var i=this._extraHeaders.slice();i.push("Contact: ".concat(this._contact,";expires=").concat(this._expires).concat(this._extraContactParams)),i.push("Expires: ".concat(this._expires));var l=new I_.OutgoingRequest(Qn.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},i),o=new b_(this._ua,l,{onRequestTimeout:function(){r._registrationFailure(null,Qn.causes.REQUEST_TIMEOUT)},onTransportError:function(){r._registrationFailure(null,Qn.causes.CONNECTION_ERROR)},onAuthenticated:function(){r._cseq+=1},onReceiveResponse:function(f){if(f.cseq===r._cseq)switch(r._registrationTimer!==null&&(clearTimeout(r._registrationTimer),r._registrationTimer=null),!0){case/^1[0-9]{2}$/.test(f.status_code):break;case/^2[0-9]{2}$/.test(f.status_code):{if(r._registering=!1,!f.hasHeader("Contact")){mi.debug("no Contact header in response to REGISTER, response ignored");break}var h=f.headers.Contact.reduce(function(C,w){return C.concat(w.parsed)},[]),c=h.find(function(C){return r._sipInstance===C.getParam("+sip.instance")&&r._reg_id===parseInt(C.getParam("reg-id"))});if(c||(c=h.find(function(C){return C.uri.user===r._ua.contact.uri.user})),!c){mi.debug("no Contact header pointing to us, response ignored");break}var p=c.getParam("expires");!p&&f.hasHeader("expires")&&(p=f.getHeader("expires")),p||(p=r._expires),p=Number(p),p<Xs&&(p=Xs);var g=p>64?p*1e3/2+Math.floor((p/2-32)*1e3*Math.random()):p*1e3-5e3;r._registrationTimer=setTimeout(function(){r._registrationTimer=null,r._ua.listeners("registrationExpiring").length===0?r.register():r._ua.emit("registrationExpiring")},g),c.hasParam("temp-gruu")&&(r._ua.contact.temp_gruu=c.getParam("temp-gruu").replace(/"/g,"")),c.hasParam("pub-gruu")&&(r._ua.contact.pub_gruu=c.getParam("pub-gruu").replace(/"/g,"")),r._registered||(r._registered=!0,r._ua.registered({response:f}));break}case/^423$/.test(f.status_code):{f.hasHeader("min-expires")?(r._expires=Number(f.getHeader("min-expires")),r._expires<Xs&&(r._expires=Xs),r.register()):(mi.debug("423 response received for REGISTER without Min-Expires"),r._registrationFailure(f,Qn.causes.SIP_FAILURE_CODE));break}default:{var v=Fa.sipErrorCause(f.status_code);r._registrationFailure(f,v)}}}});this._registering=!0,o.send()}},{key:"unregister",value:function(){var r=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._registered){mi.debug("already unregistered");return}this._registered=!1,this._registrationTimer!==null&&(clearTimeout(this._registrationTimer),this._registrationTimer=null);var l=this._extraHeaders.slice();i.all?l.push("Contact: *".concat(this._extraContactParams)):l.push("Contact: ".concat(this._contact,";expires=0").concat(this._extraContactParams)),l.push("Expires: 0");var o=new I_.OutgoingRequest(Qn.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},l),n=new b_(this._ua,o,{onRequestTimeout:function(){r._unregistered(null,Qn.causes.REQUEST_TIMEOUT)},onTransportError:function(){r._unregistered(null,Qn.causes.CONNECTION_ERROR)},onAuthenticated:function(){r._cseq+=1},onReceiveResponse:function(h){switch(!0){case/^1[0-9]{2}$/.test(h.status_code):break;case/^2[0-9]{2}$/.test(h.status_code):r._unregistered(h);break;default:{var c=Fa.sipErrorCause(h.status_code);r._unregistered(h,c)}}}});n.send()}},{key:"close",value:function(){this._registered&&this.unregister()}},{key:"onTransportClosed",value:function(){this._registering=!1,this._registrationTimer!==null&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),this._registered&&(this._registered=!1,this._ua.unregistered({}))}},{key:"_registrationFailure",value:function(r,i){this._registering=!1,this._ua.registrationFailed({response:r||null,cause:i}),this._registered&&(this._registered=!1,this._ua.unregistered({response:r||null,cause:i}))}},{key:"_unregistered",value:function(r,i){this._registering=!1,this._registered=!1,this._ua.unregistered({response:r||null,cause:i||null})}},{key:"registered",get:function(){return this._registered}}]),t}();function RC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function kC(t,e,r){return e&&O_(t.prototype,e),r&&O_(t,r),t}var $a=Ue,Zs=gs,IC=ms,Ha={onRequestTimeout:function(){},onTransportError:function(){},onSuccessResponse:function(){},onErrorResponse:function(){},onAuthenticated:function(){},onDialogError:function(){}},bC=function(){function t(e,r,i){RC(this,t),this._dialog=e,this._ua=e._ua,this._request=r,this._eventHandlers=i,this._reattempt=!1,this._reattemptTimer=null;for(var l in Ha)Object.prototype.hasOwnProperty.call(Ha,l)&&(this._eventHandlers[l]||(this._eventHandlers[l]=Ha[l]))}return kC(t,[{key:"send",value:function(){var r=this,i=new IC(this._ua,this._request,{onRequestTimeout:function(){r._eventHandlers.onRequestTimeout()},onTransportError:function(){r._eventHandlers.onTransportError()},onAuthenticated:function(n){r._eventHandlers.onAuthenticated(n)},onReceiveResponse:function(n){r._receiveResponse(n)}});if(i.send(),(this._request.method===$a.INVITE||this._request.method===$a.UPDATE&&this._request.body)&&i.clientTransaction.state!==Zs.C.STATUS_TERMINATED){this._dialog.uac_pending_reply=!0;var l=function o(){(i.clientTransaction.state===Zs.C.STATUS_ACCEPTED||i.clientTransaction.state===Zs.C.STATUS_COMPLETED||i.clientTransaction.state===Zs.C.STATUS_TERMINATED)&&(i.clientTransaction.removeListener("stateChanged",o),r._dialog.uac_pending_reply=!1)};i.clientTransaction.on("stateChanged",l)}}},{key:"_receiveResponse",value:function(r){var i=this;r.status_code===408||r.status_code===481?this._eventHandlers.onDialogError(r):r.method===$a.INVITE&&r.status_code===491?this._reattempt?r.status_code>=200&&r.status_code<300?this._eventHandlers.onSuccessResponse(r):r.status_code>=300&&this._eventHandlers.onErrorResponse(r):(this._request.cseq=this._dialog.local_seqnum+=1,this._reattemptTimer=setTimeout(function(){i._dialog.isTerminated()||(i._reattempt=!0,i.send())},1e3)):r.status_code>=200&&r.status_code<300?this._eventHandlers.onSuccessResponse(r):r.status_code>=300&&this._eventHandlers.onErrorResponse(r)}},{key:"request",get:function(){return this._request}}]),t}();function OC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x_(t,e,r){return e&&P_(t.prototype,e),r&&P_(t,r),t}var PC=ze,D_=hn,yn=Ue,vi=gs,xC=bC,ja=nt(),Va=new PC("Dialog"),Sn={STATUS_EARLY:1,STATUS_CONFIRMED:2,STATUS_TERMINATED:3},DC=function(){x_(t,null,[{key:"C",get:function(){return Sn}}]);function t(e,r,i){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Sn.STATUS_CONFIRMED;if(OC(this,t),this._owner=e,this._ua=e._ua,this._uac_pending_reply=!1,this._uas_pending_reply=!1,!r.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};r instanceof D_.IncomingResponse&&(l=r.status_code<200?Sn.STATUS_EARLY:Sn.STATUS_CONFIRMED);var o=r.parseHeader("contact");i==="UAS"?(this._id={call_id:r.call_id,local_tag:r.to_tag,remote_tag:r.from_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this._state=l,this._remote_seqnum=r.cseq,this._local_uri=r.parseHeader("to").uri,this._remote_uri=r.parseHeader("from").uri,this._remote_target=o.uri,this._route_set=r.getHeaders("record-route"),this._ack_seqnum=this._remote_seqnum):i==="UAC"&&(this._id={call_id:r.call_id,local_tag:r.from_tag,remote_tag:r.to_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this._state=l,this._local_seqnum=r.cseq,this._local_uri=r.parseHeader("from").uri,this._remote_uri=r.parseHeader("to").uri,this._remote_target=o.uri,this._route_set=r.getHeaders("record-route").reverse(),this._ack_seqnum=null),this._ua.newDialog(this),Va.debug("new ".concat(i," dialog created with status ").concat(this._state===Sn.STATUS_EARLY?"EARLY":"CONFIRMED"))}return x_(t,[{key:"isTerminated",value:function(){return this._status===Sn.STATUS_TERMINATED}},{key:"update",value:function(r,i){this._state=Sn.STATUS_CONFIRMED,Va.debug("dialog ".concat(this._id.toString(),"  changed to CONFIRMED state")),i==="UAC"&&(this._route_set=r.getHeaders("record-route").reverse())}},{key:"terminate",value:function(){Va.debug("dialog ".concat(this._id.toString()," deleted")),this._ua.destroyDialog(this),this._state=Sn.STATUS_TERMINATED}},{key:"sendRequest",value:function(r){var i=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=ja.cloneArray(l.extraHeaders),n=ja.cloneObject(l.eventHandlers),f=l.body||null,h=this._createRequest(r,o,f);n.onAuthenticated=function(){i._local_seqnum+=1};var c=new xC(this,h,n);return c.send(),h}},{key:"receiveRequest",value:function(r){this._checkInDialogRequest(r)&&(r.method===yn.ACK&&this._ack_seqnum!==null?this._ack_seqnum=null:r.method===yn.INVITE&&(this._ack_seqnum=r.cseq),this._owner.receiveRequest(r))}},{key:"_createRequest",value:function(r,i,l){i=ja.cloneArray(i),this._local_seqnum||(this._local_seqnum=Math.floor(Math.random()*1e4));var o=r===yn.CANCEL||r===yn.ACK?this._local_seqnum:this._local_seqnum+=1,n=new D_.OutgoingRequest(r,this._remote_target,this._ua,{cseq:o,call_id:this._id.call_id,from_uri:this._local_uri,from_tag:this._id.local_tag,to_uri:this._remote_uri,to_tag:this._id.remote_tag,route_set:this._route_set},i,l);return n}},{key:"_checkInDialogRequest",value:function(r){var i=this;if(!this._remote_seqnum)this._remote_seqnum=r.cseq;else if(r.cseq<this._remote_seqnum)if(r.method===yn.ACK){if(this._ack_seqnum===null||r.cseq!==this._ack_seqnum)return!1}else return r.reply(500),!1;else r.cseq>this._remote_seqnum&&(this._remote_seqnum=r.cseq);if(r.method===yn.INVITE||r.method===yn.UPDATE&&r.body){if(this._uac_pending_reply===!0)r.reply(491);else if(this._uas_pending_reply===!0){var l=(Math.random()*10|0)+1;return r.reply(500,null,["Retry-After:".concat(l)]),!1}else{this._uas_pending_reply=!0;var o=function n(){(r.server_transaction.state===vi.C.STATUS_ACCEPTED||r.server_transaction.state===vi.C.STATUS_COMPLETED||r.server_transaction.state===vi.C.STATUS_TERMINATED)&&(r.server_transaction.removeListener("stateChanged",n),i._uas_pending_reply=!1)};r.server_transaction.on("stateChanged",o)}r.hasHeader("contact")&&r.server_transaction.on("stateChanged",function(){r.server_transaction.state===vi.C.STATUS_ACCEPTED&&(i._remote_target=r.parseHeader("contact").uri)})}else r.method===yn.NOTIFY&&r.hasHeader("contact")&&r.server_transaction.on("stateChanged",function(){r.server_transaction.state===vi.C.STATUS_COMPLETED&&(i._remote_target=r.parseHeader("contact").uri)});return!0}},{key:"id",get:function(){return this._id}},{key:"local_seqnum",get:function(){return this._local_seqnum},set:function(r){this._local_seqnum=r}},{key:"owner",get:function(){return this._owner}},{key:"uac_pending_reply",get:function(){return this._uac_pending_reply},set:function(r){this._uac_pending_reply=r}},{key:"uas_pending_reply",get:function(){return this._uas_pending_reply}}]),t}(),sf={exports:{}};function El(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?El=function(r){return typeof r}:El=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},El(t)}function NC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function MC(t,e,r){return e&&N_(t.prototype,e),r&&N_(t,r),t}function LC(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qu(t,e)}function Qu(t,e){return Qu=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Qu(t,e)}function UC(t){var e=HC();return function(){var i=io(t),l;if(e){var o=io(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return FC(this,l)}}function FC(t,e){return e&&(El(e)==="object"||typeof e=="function")?e:$C(t)}function $C(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function io(t){return io=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},io(t)}var jC=Bn.EventEmitter,VC=ze,BC=Ue,zC=jn,M_=nt(),qC=new VC("RTCSession:DTMF"),zm={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};sf.exports=function(t){LC(r,t);var e=UC(r);function r(i){var l;return NC(this,r),l=e.call(this),l._session=i,l._direction=null,l._tone=null,l._duration=null,l._request=null,l}return MC(r,[{key:"send",value:function(l){var o=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(l===void 0)throw new TypeError("Not enough arguments");if(this._direction="outgoing",this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new zC.InvalidStateError(this._session.status);var f=M_.cloneArray(n.extraHeaders);if(this.eventHandlers=M_.cloneObject(n.eventHandlers),typeof l=="string")l=l.toUpperCase();else if(typeof l=="number")l=l.toString();else throw new TypeError("Invalid tone: ".concat(l));if(l.match(/^[0-9A-DR#*]$/))this._tone=l;else throw new TypeError("Invalid tone: ".concat(l));this._duration=n.duration,f.push("Content-Type: application/dtmf-relay");var h="Signal=".concat(this._tone,`\r
`);h+="Duration=".concat(this._duration),this._session.newDTMF({originator:"local",dtmf:this,request:this._request}),this._session.sendRequest(BC.INFO,{extraHeaders:f,eventHandlers:{onSuccessResponse:function(p){o.emit("succeeded",{originator:"remote",response:p})},onErrorResponse:function(p){o.eventHandlers.onFailed&&o.eventHandlers.onFailed(),o.emit("failed",{originator:"remote",response:p})},onRequestTimeout:function(){o._session.onRequestTimeout()},onTransportError:function(){o._session.onTransportError()},onDialogError:function(){o._session.onDialogError()}},body:h})}},{key:"init_incoming",value:function(l){var o=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,n=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(this._direction="incoming",this._request=l,l.reply(200),l.body){var f=l.body.split(`
`);f.length>=1&&o.test(f[0])&&(this._tone=f[0].replace(o,"$2")),f.length>=2&&n.test(f[1])&&(this._duration=parseInt(f[1].replace(n,"$2"),10))}this._duration||(this._duration=zm.DEFAULT_DURATION),this._tone?this._session.newDTMF({originator:"remote",dtmf:this,request:l}):qC.debug("invalid INFO DTMF received, discarded")}},{key:"tone",get:function(){return this._tone}},{key:"duration",get:function(){return this._duration}}]),r}(jC);sf.exports.C=zm;var WC=sf.exports;function Al(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Al=function(r){return typeof r}:Al=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Al(t)}function GC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function KC(t,e,r){return e&&L_(t.prototype,e),r&&L_(t,r),t}function QC(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yu(t,e)}function Yu(t,e){return Yu=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Yu(t,e)}function YC(t){var e=ZC();return function(){var i=so(t),l;if(e){var o=so(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return JC(this,l)}}function JC(t,e){return e&&(Al(e)==="object"||typeof e=="function")?e:XC(t)}function XC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZC(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function so(t){return so=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},so(t)}var eT=Bn.EventEmitter,tT=Ue,nT=jn,rT=nt(),iT=function(t){QC(r,t);var e=YC(r);function r(i){var l;return GC(this,r),l=e.call(this),l._session=i,l._direction=null,l._contentType=null,l._body=null,l}return KC(r,[{key:"send",value:function(l,o){var n=this,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._direction="outgoing",l===void 0)throw new TypeError("Not enough arguments");if(this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new nT.InvalidStateError(this._session.status);this._contentType=l,this._body=o;var h=rT.cloneArray(f.extraHeaders);h.push("Content-Type: ".concat(l)),this._session.newInfo({originator:"local",info:this,request:this.request}),this._session.sendRequest(tT.INFO,{extraHeaders:h,eventHandlers:{onSuccessResponse:function(p){n.emit("succeeded",{originator:"remote",response:p})},onErrorResponse:function(p){n.emit("failed",{originator:"remote",response:p})},onTransportError:function(){n._session.onTransportError()},onRequestTimeout:function(){n._session.onRequestTimeout()},onDialogError:function(){n._session.onDialogError()}},body:o})}},{key:"init_incoming",value:function(l){this._direction="incoming",this.request=l,l.reply(200),this._contentType=l.hasHeader("Content-Type")?l.getHeader("Content-Type").toLowerCase():void 0,this._body=l.body,this._session.newInfo({originator:"remote",info:this,request:l})}},{key:"contentType",get:function(){return this._contentType}},{key:"body",get:function(){return this._body}}]),r}(eT);function sT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lT(t,e,r){return e&&U_(t.prototype,e),r&&U_(t,r),t}var oT=ze,F_=Ue,aT=new oT("RTCSession:ReferNotifier"),Ba={event_type:"refer",body_type:"message/sipfrag;version=2.0",expires:300},uT=function(){function t(e,r,i){sT(this,t),this._session=e,this._id=r,this._expires=i||Ba.expires,this._active=!0,this.notify(100)}return lT(t,[{key:"notify",value:function(r,i){if(aT.debug("notify()"),this._active!==!1){i=i||F_.REASON_PHRASE[r]||"";var l;r>=200?l="terminated;reason=noresource":l="active;expires=".concat(this._expires),this._session.sendRequest(F_.NOTIFY,{extraHeaders:["Event: ".concat(Ba.event_type,";id=").concat(this._id),"Subscription-State: ".concat(l),"Content-Type: ".concat(Ba.body_type)],body:"SIP/2.0 ".concat(r," ").concat(i),eventHandlers:{onErrorResponse:function(){this._active=!1}}})}}}]),t}();function Rl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rl=function(r){return typeof r}:Rl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Rl(t)}function cT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fT(t,e,r){return e&&$_(t.prototype,e),r&&$_(t,r),t}function dT(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ju(t,e)}function Ju(t,e){return Ju=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Ju(t,e)}function hT(t){var e=gT();return function(){var i=lo(t),l;if(e){var o=lo(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return _T(this,l)}}function _T(t,e){return e&&(Rl(e)==="object"||typeof e=="function")?e:pT(t)}function pT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function lo(t){return lo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},lo(t)}var mT=Bn.EventEmitter,vT=ze,yi=Ue,yT=Yt(),H_=nt(),Yn=new vT("RTCSession:ReferSubscriber"),ST=function(t){dT(r,t);var e=hT(r);function r(i){var l;return cT(this,r),l=e.call(this),l._id=null,l._session=i,l}return fT(r,[{key:"sendRefer",value:function(l){var o=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yn.debug("sendRefer()");var f=H_.cloneArray(n.extraHeaders),h=H_.cloneObject(n.eventHandlers);for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&this.on(c,h[c]);var p=null;n.replaces&&(p=n.replaces._request.call_id,p+=";to-tag=".concat(n.replaces._to_tag),p+=";from-tag=".concat(n.replaces._from_tag),p=encodeURIComponent(p));var g="Refer-To: <".concat(l).concat(p?"?Replaces=".concat(p):"",">");if(f.push(g),!f.some(function(w){return w.toLowerCase().startsWith("referred-by:")})){var v="Referred-By: <".concat(this._session._ua._configuration.uri._scheme,":").concat(this._session._ua._configuration.uri._user,"@").concat(this._session._ua._configuration.uri._host,">");f.push(v)}f.push("Contact: ".concat(this._session.contact));var C=this._session.sendRequest(yi.REFER,{extraHeaders:f,eventHandlers:{onSuccessResponse:function(k){o._requestSucceeded(k)},onErrorResponse:function(k){o._requestFailed(k,yi.causes.REJECTED)},onTransportError:function(){o._requestFailed(null,yi.causes.CONNECTION_ERROR)},onRequestTimeout:function(){o._requestFailed(null,yi.causes.REQUEST_TIMEOUT)},onDialogError:function(){o._requestFailed(null,yi.causes.DIALOG_ERROR)}}});this._id=C.cseq}},{key:"receiveNotify",value:function(l){if(Yn.debug("receiveNotify()"),!!l.body){var o=yT.parse(l.body.trim().split(`\r
`,1)[0],"Status_Line");if(o===-1){Yn.debug('receiveNotify() | error parsing NOTIFY body: "'.concat(l.body,'"'));return}switch(!0){case/^100$/.test(o.status_code):this.emit("trying",{request:l,status_line:o});break;case/^1[0-9]{2}$/.test(o.status_code):this.emit("progress",{request:l,status_line:o});break;case/^2[0-9]{2}$/.test(o.status_code):this.emit("accepted",{request:l,status_line:o});break;default:this.emit("failed",{request:l,status_line:o});break}}}},{key:"_requestSucceeded",value:function(l){Yn.debug("REFER succeeded"),Yn.debug('emit "requestSucceeded"'),this.emit("requestSucceeded",{response:l})}},{key:"_requestFailed",value:function(l,o){Yn.debug("REFER failed"),Yn.debug('emit "requestFailed"'),this.emit("requestFailed",{response:l||null,cause:o})}},{key:"id",get:function(){return this._id}}]),r}(mT);function kl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kl=function(r){return typeof r}:kl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},kl(t)}function tn(t,e){var r;if(typeof Symbol=="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=CT(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var i=0,l=function(){};return{s:l,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(c){throw c},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,n=!1,f;return{s:function(){r=t[Symbol.iterator]()},n:function(){var c=r.next();return o=c.done,c},e:function(c){n=!0,f=c},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(n)throw f}}}}function CT(t,e){if(t){if(typeof t=="string")return j_(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j_(t,e)}}function j_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function TT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function B_(t,e,r){return e&&V_(t.prototype,e),r&&V_(t,r),t}function wT(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xu(t,e)}function Xu(t,e){return Xu=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Xu(t,e)}function ET(t){var e=kT();return function(){var i=oo(t),l;if(e){var o=oo(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return AT(this,l)}}function AT(t,e){return e&&(kl(e)==="object"||typeof e=="function")?e:RT(t)}function RT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function oo(t){return oo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},oo(t)}var IT=Bn.EventEmitter,z_=Jt,bT=ze,G=Ue,Jn=jn,q_=gs,Ee=nt(),Si=Bm,OT=hn,el=DC,PT=ms,mt=WC,W_=iT,xT=uT,DT=ST,G_=Vn(),N=new bT("RTCSession"),U={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9},tl=["audio","video"],NT=function(t){wT(r,t);var e=ET(r);B_(r,null,[{key:"C",get:function(){return U}}]);function r(i){var l;return TT(this,r),N.debug("new"),l=e.call(this),l._id=null,l._ua=i,l._status=U.STATUS_NULL,l._dialog=null,l._earlyDialogs={},l._contact=null,l._from_tag=null,l._to_tag=null,l._connection=null,l._connectionPromiseQueue=Promise.resolve(),l._request=null,l._is_canceled=!1,l._cancel_reason="",l._is_confirmed=!1,l._late_sdp=!1,l._rtcOfferConstraints=null,l._rtcAnswerConstraints=null,l._localMediaStream=null,l._localMediaStreamLocallyGenerated=!1,l._rtcReady=!0,l._iceReady=!1,l._timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},l._direction=null,l._local_identity=null,l._remote_identity=null,l._start_time=null,l._end_time=null,l._tones=null,l._audioMuted=!1,l._videoMuted=!1,l._localHold=!1,l._remoteHold=!1,l._sessionTimers={enabled:l._ua.configuration.session_timers,refreshMethod:l._ua.configuration.session_timers_refresh_method,defaultExpires:G.SESSION_EXPIRES,currentExpires:null,running:!1,refresher:!1,timer:null},l._referSubscribers={},l._data={},l}return B_(r,[{key:"isInProgress",value:function(){switch(this._status){case U.STATUS_NULL:case U.STATUS_INVITE_SENT:case U.STATUS_1XX_RECEIVED:case U.STATUS_INVITE_RECEIVED:case U.STATUS_WAITING_FOR_ANSWER:return!0;default:return!1}}},{key:"isEstablished",value:function(){switch(this._status){case U.STATUS_ANSWERED:case U.STATUS_WAITING_FOR_ACK:case U.STATUS_CONFIRMED:return!0;default:return!1}}},{key:"isEnded",value:function(){switch(this._status){case U.STATUS_CANCELED:case U.STATUS_TERMINATED:return!0;default:return!1}}},{key:"isMuted",value:function(){return{audio:this._audioMuted,video:this._videoMuted}}},{key:"isOnHold",value:function(){return{local:this._localHold,remote:this._remoteHold}}},{key:"connect",value:function(l){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;N.debug("connect()");var f=l,h=Ee.cloneObject(o.eventHandlers),c=Ee.cloneArray(o.extraHeaders),p=Ee.cloneObject(o.mediaConstraints,{audio:!0,video:!0}),g=o.mediaStream||null,v=Ee.cloneObject(o.pcConfig,{iceServers:[]}),C=o.rtcConstraints||null,w=o.rtcOfferConstraints||null;if(this._rtcOfferConstraints=w,this._rtcAnswerConstraints=o.rtcAnswerConstraints||null,this._data=o.data||this._data,l===void 0)throw new TypeError("Not enough arguments");if(this._status!==U.STATUS_NULL)throw new Jn.InvalidStateError(this._status);if(!window.RTCPeerConnection)throw new Jn.NotSupportedError("WebRTC not supported");if(l=this._ua.normalizeTarget(l),!l)throw new TypeError("Invalid target: ".concat(f));this._sessionTimers.enabled&&Ee.isDecimal(o.sessionTimersExpires)&&(o.sessionTimersExpires>=G.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=o.sessionTimersExpires:this._sessionTimers.defaultExpires=G.SESSION_EXPIRES);for(var k in h)Object.prototype.hasOwnProperty.call(h,k)&&this.on(k,h[k]);this._from_tag=Ee.newTag();var F=o.anonymous||!1,T={from_tag:this._from_tag};this._contact=this._ua.contact.toString({anonymous:F,outbound:!0}),F?(T.from_display_name="Anonymous",T.from_uri=new G_("sip","anonymous","anonymous.invalid"),c.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString())),c.push("Privacy: id")):o.fromUserName&&(T.from_uri=new G_("sip",o.fromUserName,this._ua.configuration.uri.host),c.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString()))),o.fromDisplayName&&(T.from_display_name=o.fromDisplayName),c.push("Contact: ".concat(this._contact)),c.push("Content-Type: application/sdp"),this._sessionTimers.enabled&&c.push("Session-Expires: ".concat(this._sessionTimers.defaultExpires).concat(this._ua.configuration.session_timers_force_refresher?";refresher=uac":"")),this._request=new OT.InitialOutgoingInviteRequest(l,this._ua,T,c),this._id=this._request.call_id+this._from_tag,this._createRTCConnection(v,C),this._direction="outgoing",this._local_identity=this._request.from,this._remote_identity=this._request.to,n&&n(this),this._newRTCSession("local",this._request),this._sendInitialRequest(p,w,g)}},{key:"init_incoming",value:function(l,o){var n=this;N.debug("init_incoming()");var f,h=l.hasHeader("Content-Type")?l.getHeader("Content-Type").toLowerCase():void 0;if(l.body&&h!=="application/sdp"){l.reply(415);return}if(this._status=U.STATUS_INVITE_RECEIVED,this._from_tag=l.from_tag,this._id=l.call_id+this._from_tag,this._request=l,this._contact=this._ua.contact.toString(),l.hasHeader("expires")&&(f=l.getHeader("expires")*1e3),l.to_tag=Ee.newTag(),!this._createDialog(l,"UAS",!0)){l.reply(500,"Missing Contact header field");return}l.body?this._late_sdp=!1:this._late_sdp=!0,this._status=U.STATUS_WAITING_FOR_ANSWER,this._timers.userNoAnswerTimer=setTimeout(function(){l.reply(408),n._failed("local",null,G.causes.NO_ANSWER)},this._ua.configuration.no_answer_timeout),f&&(this._timers.expiresTimer=setTimeout(function(){n._status===U.STATUS_WAITING_FOR_ANSWER&&(l.reply(487),n._failed("system",null,G.causes.EXPIRES))},f)),this._direction="incoming",this._local_identity=l.to,this._remote_identity=l.from,o&&o(this),this._newRTCSession("remote",l),this._status!==U.STATUS_TERMINATED&&(l.reply(180,null,["Contact: ".concat(this._contact)]),this._progress("local",null))}},{key:"answer",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};N.debug("answer()");var n=this._request,f=Ee.cloneArray(o.extraHeaders),h=Ee.cloneObject(o.mediaConstraints),c=o.mediaStream||null,p=Ee.cloneObject(o.pcConfig,{iceServers:[]}),g=o.rtcConstraints||null,v=o.rtcAnswerConstraints||null,C=Ee.cloneObject(o.rtcOfferConstraints),w,k=!1,F=!1,T=!1,S=!1;if(this._rtcAnswerConstraints=v,this._rtcOfferConstraints=o.rtcOfferConstraints||null,this._data=o.data||this._data,this._direction!=="incoming")throw new Jn.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this._status!==U.STATUS_WAITING_FOR_ANSWER)throw new Jn.InvalidStateError(this._status);if(this._sessionTimers.enabled&&Ee.isDecimal(o.sessionTimersExpires)&&(o.sessionTimersExpires>=G.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=o.sessionTimersExpires:this._sessionTimers.defaultExpires=G.SESSION_EXPIRES),this._status=U.STATUS_ANSWERED,!this._createDialog(n,"UAS")){n.reply(500,"Error creating dialog");return}clearTimeout(this._timers.userNoAnswerTimer),f.unshift("Contact: ".concat(this._contact));var E=n.parseSDP();Array.isArray(E.media)||(E.media=[E.media]);var x=tn(E.media),$;try{for(x.s();!($=x.n()).done;){var W=$.value;W.type==="audio"&&(k=!0,(!W.direction||W.direction==="sendrecv")&&(T=!0)),W.type==="video"&&(F=!0,(!W.direction||W.direction==="sendrecv")&&(S=!0))}}catch(ae){x.e(ae)}finally{x.f()}if(c&&h.audio===!1){w=c.getAudioTracks();var z=tn(w),I;try{for(z.s();!(I=z.n()).done;){var D=I.value;c.removeTrack(D)}}catch(ae){z.e(ae)}finally{z.f()}}if(c&&h.video===!1){w=c.getVideoTracks();var re=tn(w),De;try{for(re.s();!(De=re.n()).done;){var He=De.value;c.removeTrack(He)}}catch(ae){re.e(ae)}finally{re.f()}}!c&&h.audio===void 0&&(h.audio=T),!c&&h.video===void 0&&(h.video=S),!c&&!k&&!C.offerToReceiveAudio&&(h.audio=!1),!c&&!F&&!C.offerToReceiveVideo&&(h.video=!1),this._createRTCConnection(p,g),Promise.resolve().then(function(){if(c)return c;if(h.audio||h.video)return l._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(h).catch(function(ae){throw l._status===U.STATUS_TERMINATED?new Error("terminated"):(n.reply(480),l._failed("local",null,G.causes.USER_DENIED_MEDIA_ACCESS),N.warn('emit "getusermediafailed" [error:%o]',ae),l.emit("getusermediafailed",ae),new Error("getUserMedia() failed"))})}).then(function(ae){if(l._status===U.STATUS_TERMINATED)throw new Error("terminated");l._localMediaStream=ae,ae&&ae.getTracks().forEach(function(H){l._connection.addTrack(H,ae)})}).then(function(){if(!l._late_sdp){var ae={originator:"remote",type:"offer",sdp:n.body};N.debug('emit "sdp"'),l.emit("sdp",ae);var H=new RTCSessionDescription({type:"offer",sdp:ae.sdp});return l._connectionPromiseQueue=l._connectionPromiseQueue.then(function(){return l._connection.setRemoteDescription(H)}).catch(function(B){throw n.reply(488),l._failed("system",null,G.causes.WEBRTC_ERROR),N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',B),l.emit("peerconnection:setremotedescriptionfailed",B),new Error("peerconnection.setRemoteDescription() failed")}),l._connectionPromiseQueue}}).then(function(){if(l._status===U.STATUS_TERMINATED)throw new Error("terminated");return l._connecting(n),l._late_sdp?l._createLocalDescription("offer",l._rtcOfferConstraints).catch(function(){throw n.reply(500),new Error("_createLocalDescription() failed")}):l._createLocalDescription("answer",v).catch(function(){throw n.reply(500),new Error("_createLocalDescription() failed")})}).then(function(ae){if(l._status===U.STATUS_TERMINATED)throw new Error("terminated");l._handleSessionTimersInIncomingRequest(n,f),n.reply(200,null,f,ae,function(){l._status=U.STATUS_WAITING_FOR_ACK,l._setInvite2xxTimer(n,ae),l._setACKTimer(),l._accepted("local")},function(){l._failed("system",null,G.causes.CONNECTION_ERROR)})}).catch(function(ae){l._status!==U.STATUS_TERMINATED&&N.warn(ae)})}},{key:"terminate",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};N.debug("terminate()");var n=o.cause||G.causes.BYE,f=Ee.cloneArray(o.extraHeaders),h=o.body,c,p=o.status_code,g=o.reason_phrase;if(this._status===U.STATUS_TERMINATED)throw new Jn.InvalidStateError(this._status);switch(this._status){case U.STATUS_NULL:case U.STATUS_INVITE_SENT:case U.STATUS_1XX_RECEIVED:if(N.debug("canceling session"),p&&(p<200||p>=700))throw new TypeError("Invalid status_code: ".concat(p));p&&(g=g||G.REASON_PHRASE[p]||"",c="SIP ;cause=".concat(p,' ;text="').concat(g,'"')),this._status===U.STATUS_NULL||this._status===U.STATUS_INVITE_SENT?(this._is_canceled=!0,this._cancel_reason=c):this._status===U.STATUS_1XX_RECEIVED&&this._request.cancel(c),this._status=U.STATUS_CANCELED,this._failed("local",null,G.causes.CANCELED);break;case U.STATUS_WAITING_FOR_ANSWER:case U.STATUS_ANSWERED:if(N.debug("rejecting session"),p=p||480,p<300||p>=700)throw new TypeError("Invalid status_code: ".concat(p));this._request.reply(p,g,f,h),this._failed("local",null,G.causes.REJECTED);break;case U.STATUS_WAITING_FOR_ACK:case U.STATUS_CONFIRMED:if(N.debug("terminating session"),g=o.reason_phrase||G.REASON_PHRASE[p]||"",p&&(p<200||p>=700))throw new TypeError("Invalid status_code: ".concat(p));if(p&&f.push("Reason: SIP ;cause=".concat(p,'; text="').concat(g,'"')),this._status===U.STATUS_WAITING_FOR_ACK&&this._direction==="incoming"&&this._request.server_transaction.state!==q_.C.STATUS_TERMINATED){var v=this._dialog;this.receiveRequest=function(C){var w=C.method;w===G.ACK&&(l.sendRequest(G.BYE,{extraHeaders:f,body:h}),v.terminate())},this._request.server_transaction.on("stateChanged",function(){l._request.server_transaction.state===q_.C.STATUS_TERMINATED&&(l.sendRequest(G.BYE,{extraHeaders:f,body:h}),v.terminate())}),this._ended("local",null,n),this._dialog=v,this._ua.newDialog(v)}else this.sendRequest(G.BYE,{extraHeaders:f,body:h}),this._ended("local",null,n)}}},{key:"sendDTMF",value:function(l){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};N.debug("sendDTMF() | tones: %s",l);var n=0,f=o.duration||null,h=o.interToneGap||null,c=o.transportType||G.DTMF_TRANSPORT.INFO;if(l===void 0)throw new TypeError("Not enough arguments");if(this._status!==U.STATUS_CONFIRMED&&this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_1XX_RECEIVED)throw new Jn.InvalidStateError(this._status);if(c!==G.DTMF_TRANSPORT.INFO&&c!==G.DTMF_TRANSPORT.RFC2833)throw new TypeError("invalid transportType: ".concat(c));if(typeof l=="number"&&(l=l.toString()),!l||typeof l!="string"||!l.match(/^[0-9A-DR#*,]+$/i))throw new TypeError("Invalid tones: ".concat(l));if(f&&!Ee.isDecimal(f))throw new TypeError("Invalid tone duration: ".concat(f));if(f?f<mt.C.MIN_DURATION?(N.debug('"duration" value is lower than the minimum allowed, setting it to '.concat(mt.C.MIN_DURATION," milliseconds")),f=mt.C.MIN_DURATION):f>mt.C.MAX_DURATION?(N.debug('"duration" value is greater than the maximum allowed, setting it to '.concat(mt.C.MAX_DURATION," milliseconds")),f=mt.C.MAX_DURATION):f=Math.abs(f):f=mt.C.DEFAULT_DURATION,o.duration=f,h&&!Ee.isDecimal(h))throw new TypeError("Invalid interToneGap: ".concat(h));if(h?h<mt.C.MIN_INTER_TONE_GAP?(N.debug('"interToneGap" value is lower than the minimum allowed, setting it to '.concat(mt.C.MIN_INTER_TONE_GAP," milliseconds")),h=mt.C.MIN_INTER_TONE_GAP):h=Math.abs(h):h=mt.C.DEFAULT_INTER_TONE_GAP,c===G.DTMF_TRANSPORT.RFC2833){var p=this._getDTMFRTPSender();p&&(l=p.toneBuffer+l,p.insertDTMF(l,f,h));return}if(this._tones){this._tones+=l;return}this._tones=l,g.call(this);function g(){var v=this,C;if(this._status===U.STATUS_TERMINATED||!this._tones||n>=this._tones.length){this._tones=null;return}var w=this._tones[n];if(n+=1,w===",")C=2e3;else{var k=new mt(this);o.eventHandlers={onFailed:function(){v._tones=null}},k.send(w,o),C=f+h}setTimeout(g.bind(this),C)}}},{key:"sendInfo",value:function(l,o){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(N.debug("sendInfo()"),this._status!==U.STATUS_CONFIRMED&&this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_1XX_RECEIVED)throw new Jn.InvalidStateError(this._status);var f=new W_(this);f.send(l,o,n)}},{key:"mute",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{audio:!0,video:!1};N.debug("mute()");var o=!1,n=!1;this._audioMuted===!1&&l.audio&&(o=!0,this._audioMuted=!0,this._toggleMuteAudio(!0)),this._videoMuted===!1&&l.video&&(n=!0,this._videoMuted=!0,this._toggleMuteVideo(!0)),(o===!0||n===!0)&&this._onmute({audio:o,video:n})}},{key:"unmute",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{audio:!0,video:!0};N.debug("unmute()");var o=!1,n=!1;this._audioMuted===!0&&l.audio&&(o=!0,this._audioMuted=!1,this._localHold===!1&&this._toggleMuteAudio(!1)),this._videoMuted===!0&&l.video&&(n=!0,this._videoMuted=!1,this._localHold===!1&&this._toggleMuteVideo(!1)),(o===!0||n===!0)&&this._onunmute({audio:o,video:n})}},{key:"hold",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(N.debug("hold()"),this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_CONFIRMED||this._localHold===!0||!this._isReadyToReOffer())return!1;this._localHold=!0,this._onhold("local");var f={succeeded:function(){n&&n()},failed:function(){l.terminate({cause:G.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Hold Failed"})}};return o.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:f,extraHeaders:o.extraHeaders}):this._sendReinvite({eventHandlers:f,extraHeaders:o.extraHeaders}),!0}},{key:"unhold",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(N.debug("unhold()"),this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_CONFIRMED||this._localHold===!1||!this._isReadyToReOffer())return!1;this._localHold=!1,this._onunhold("local");var f={succeeded:function(){n&&n()},failed:function(){l.terminate({cause:G.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Unhold Failed"})}};return o.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:f,extraHeaders:o.extraHeaders}):this._sendReinvite({eventHandlers:f,extraHeaders:o.extraHeaders}),!0}},{key:"renegotiate",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;N.debug("renegotiate()");var f=o.rtcOfferConstraints||null;if(this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_CONFIRMED||!this._isReadyToReOffer())return!1;var h={succeeded:function(){n&&n()},failed:function(){l.terminate({cause:G.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Media Renegotiation Failed"})}};return this._setLocalMediaStatus(),o.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:h,rtcOfferConstraints:f,extraHeaders:o.extraHeaders}):this._sendReinvite({eventHandlers:h,rtcOfferConstraints:f,extraHeaders:o.extraHeaders}),!0}},{key:"refer",value:function(l,o){var n=this;N.debug("refer()");var f=l;if(this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_CONFIRMED)return!1;if(l=this._ua.normalizeTarget(l),!l)throw new TypeError("Invalid target: ".concat(f));var h=new DT(this);h.sendRefer(l,o);var c=h.id;return this._referSubscribers[c]=h,h.on("requestFailed",function(){delete n._referSubscribers[c]}),h.on("accepted",function(){delete n._referSubscribers[c]}),h.on("failed",function(){delete n._referSubscribers[c]}),h}},{key:"sendRequest",value:function(l,o){return N.debug("sendRequest()"),this._dialog.sendRequest(l,o)}},{key:"receiveRequest",value:function(l){var o=this;if(N.debug("receiveRequest()"),l.method===G.CANCEL)(this._status===U.STATUS_WAITING_FOR_ANSWER||this._status===U.STATUS_ANSWERED)&&(this._status=U.STATUS_CANCELED,this._request.reply(487),this._failed("remote",l,G.causes.CANCELED));else switch(l.method){case G.ACK:if(this._status!==U.STATUS_WAITING_FOR_ACK)return;if(this._status=U.STATUS_CONFIRMED,clearTimeout(this._timers.ackTimer),clearTimeout(this._timers.invite2xxTimer),this._late_sdp){if(!l.body){this.terminate({cause:G.causes.MISSING_SDP,status_code:400});break}var n={originator:"remote",type:"answer",sdp:l.body};N.debug('emit "sdp"'),this.emit("sdp",n);var f=new RTCSessionDescription({type:"answer",sdp:n.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return o._connection.setRemoteDescription(f)}).then(function(){o._is_confirmed||o._confirmed("remote",l)}).catch(function(c){o.terminate({cause:G.causes.BAD_MEDIA_DESCRIPTION,status_code:488}),N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',c),o.emit("peerconnection:setremotedescriptionfailed",c)})}else this._is_confirmed||this._confirmed("remote",l);break;case G.BYE:this._status===U.STATUS_CONFIRMED||this._status===U.STATUS_WAITING_FOR_ACK?(l.reply(200),this._ended("remote",l,G.causes.BYE)):this._status===U.STATUS_INVITE_RECEIVED||this._status===U.STATUS_WAITING_FOR_ANSWER?(l.reply(200),this._request.reply(487,"BYE Received"),this._ended("remote",l,G.causes.BYE)):l.reply(403,"Wrong Status");break;case G.INVITE:this._status===U.STATUS_CONFIRMED?l.hasHeader("replaces")?this._receiveReplaces(l):this._receiveReinvite(l):l.reply(403,"Wrong Status");break;case G.INFO:if(this._status===U.STATUS_1XX_RECEIVED||this._status===U.STATUS_WAITING_FOR_ANSWER||this._status===U.STATUS_ANSWERED||this._status===U.STATUS_WAITING_FOR_ACK||this._status===U.STATUS_CONFIRMED){var h=l.hasHeader("Content-Type")?l.getHeader("Content-Type").toLowerCase():void 0;h&&h.match(/^application\/dtmf-relay/i)?new mt(this).init_incoming(l):h!==void 0?new W_(this).init_incoming(l):l.reply(415)}else l.reply(403,"Wrong Status");break;case G.UPDATE:this._status===U.STATUS_CONFIRMED?this._receiveUpdate(l):l.reply(403,"Wrong Status");break;case G.REFER:this._status===U.STATUS_CONFIRMED?this._receiveRefer(l):l.reply(403,"Wrong Status");break;case G.NOTIFY:this._status===U.STATUS_CONFIRMED?this._receiveNotify(l):l.reply(403,"Wrong Status");break;default:l.reply(501)}}},{key:"onTransportError",value:function(){N.warn("onTransportError()"),this._status!==U.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:G.causes.CONNECTION_ERROR,cause:G.causes.CONNECTION_ERROR})}},{key:"onRequestTimeout",value:function(){N.warn("onRequestTimeout()"),this._status!==U.STATUS_TERMINATED&&this.terminate({status_code:408,reason_phrase:G.causes.REQUEST_TIMEOUT,cause:G.causes.REQUEST_TIMEOUT})}},{key:"onDialogError",value:function(){N.warn("onDialogError()"),this._status!==U.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:G.causes.DIALOG_ERROR,cause:G.causes.DIALOG_ERROR})}},{key:"newDTMF",value:function(l){N.debug("newDTMF()"),this.emit("newDTMF",l)}},{key:"newInfo",value:function(l){N.debug("newInfo()"),this.emit("newInfo",l)}},{key:"_isReadyToReOffer",value:function(){return this._rtcReady?this._dialog?this._dialog.uac_pending_reply===!0||this._dialog.uas_pending_reply===!0?(N.debug("_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress"),!1):!0:(N.debug("_isReadyToReOffer() | session not established yet"),!1):(N.debug("_isReadyToReOffer() | internal WebRTC status not ready"),!1)}},{key:"_close",value:function(){if(N.debug("close()"),this._localMediaStream&&this._localMediaStreamLocallyGenerated&&(N.debug("close() | closing local MediaStream"),Ee.closeMediaStream(this._localMediaStream)),this._status!==U.STATUS_TERMINATED){if(this._status=U.STATUS_TERMINATED,this._connection)try{this._connection.close()}catch(f){N.warn("close() | error closing the RTCPeerConnection: %o",f)}for(var l in this._timers)Object.prototype.hasOwnProperty.call(this._timers,l)&&clearTimeout(this._timers[l]);clearTimeout(this._sessionTimers.timer),this._dialog&&(this._dialog.terminate(),delete this._dialog);for(var o in this._earlyDialogs)Object.prototype.hasOwnProperty.call(this._earlyDialogs,o)&&(this._earlyDialogs[o].terminate(),delete this._earlyDialogs[o]);for(var n in this._referSubscribers)Object.prototype.hasOwnProperty.call(this._referSubscribers,n)&&delete this._referSubscribers[n];this._ua.destroyRTCSession(this)}}},{key:"_setInvite2xxTimer",value:function(l,o){var n=Si.T1;function f(){this._status===U.STATUS_WAITING_FOR_ACK&&(l.reply(200,null,["Contact: ".concat(this._contact)],o),n<Si.T2&&(n=n*2,n>Si.T2&&(n=Si.T2)),this._timers.invite2xxTimer=setTimeout(f.bind(this),n))}this._timers.invite2xxTimer=setTimeout(f.bind(this),n)}},{key:"_setACKTimer",value:function(){var l=this;this._timers.ackTimer=setTimeout(function(){l._status===U.STATUS_WAITING_FOR_ACK&&(N.debug("no ACK received, terminating the session"),clearTimeout(l._timers.invite2xxTimer),l.sendRequest(G.BYE),l._ended("remote",null,G.causes.NO_ACK))},Si.TIMER_H)}},{key:"_createRTCConnection",value:function(l,o){var n=this;this._connection=new RTCPeerConnection(l,o),this._connection.addEventListener("iceconnectionstatechange",function(){var f=n._connection.iceConnectionState;f==="failed"&&n.terminate({cause:G.causes.RTP_TIMEOUT,status_code:408,reason_phrase:G.causes.RTP_TIMEOUT})}),N.debug('emit "peerconnection"'),this.emit("peerconnection",{peerconnection:this._connection})}},{key:"_createLocalDescription",value:function(l,o){var n=this;if(N.debug("createLocalDescription()"),l!=="offer"&&l!=="answer")throw new Error('createLocalDescription() | invalid type "'.concat(l,'"'));var f=this._connection;return this._rtcReady=!1,Promise.resolve().then(function(){return l==="offer"?f.createOffer(o).catch(function(h){return N.warn('emit "peerconnection:createofferfailed" [error:%o]',h),n.emit("peerconnection:createofferfailed",h),Promise.reject(h)}):f.createAnswer(o).catch(function(h){return N.warn('emit "peerconnection:createanswerfailed" [error:%o]',h),n.emit("peerconnection:createanswerfailed",h),Promise.reject(h)})}).then(function(h){return f.setLocalDescription(h).catch(function(c){return n._rtcReady=!0,N.warn('emit "peerconnection:setlocaldescriptionfailed" [error:%o]',c),n.emit("peerconnection:setlocaldescriptionfailed",c),Promise.reject(c)})}).then(function(){var h=o&&o.iceRestart;if(f.iceGatheringState==="complete"&&!h||f.iceGatheringState==="gathering"&&n._iceReady){n._rtcReady=!0;var c={originator:"local",type:l,sdp:f.localDescription.sdp};return N.debug('emit "sdp"'),n.emit("sdp",c),Promise.resolve(c.sdp)}return new Promise(function(p){var g=!1,v,C;n._iceReady=!1;var w=function(){f.removeEventListener("icecandidate",v),f.removeEventListener("icegatheringstatechange",C),g=!0,n._rtcReady=!0,n._iceReady=!0;var F={originator:"local",type:l,sdp:f.localDescription.sdp};N.debug('emit "sdp"'),n.emit("sdp",F),p(F.sdp)};f.addEventListener("icecandidate",v=function(F){var T=F.candidate;T?n.emit("icecandidate",{candidate:T,ready:w}):g||w()}),f.addEventListener("icegatheringstatechange",C=function(){f.iceGatheringState==="complete"&&!g&&w()})})})}},{key:"_createDialog",value:function(l,o,n){var f=o==="UAS"?l.to_tag:l.from_tag,h=o==="UAS"?l.from_tag:l.to_tag,c=l.call_id+f+h,p=this._earlyDialogs[c];if(n)return p?!0:(p=new el(this,l,o,el.C.STATUS_EARLY),p.error?(N.debug(p.error),this._failed("remote",l,G.causes.INTERNAL_ERROR),!1):(this._earlyDialogs[c]=p,!0));if(this._from_tag=l.from_tag,this._to_tag=l.to_tag,p)return p.update(l,o),this._dialog=p,delete this._earlyDialogs[c],!0;var g=new el(this,l,o);return g.error?(N.debug(g.error),this._failed("remote",l,G.causes.INTERNAL_ERROR),!1):(this._dialog=g,!0)}},{key:"_receiveReinvite",value:function(l){var o=this;N.debug("receiveReinvite()");var n=l.hasHeader("Content-Type")?l.getHeader("Content-Type").toLowerCase():void 0,f={request:l,callback:void 0,reject:c.bind(this)},h=!1;function c(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};h=!0;var v=g.status_code||403,C=g.reason_phrase||"",w=Ee.cloneArray(g.extraHeaders);if(this._status!==U.STATUS_CONFIRMED)return!1;if(v<300||v>=700)throw new TypeError("Invalid status_code: ".concat(v));l.reply(v,C,w)}if(this.emit("reinvite",f),h)return;if(this._late_sdp=!1,!l.body){this._late_sdp=!0,this._remoteHold&&(this._remoteHold=!1,this._onunhold("remote")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return o._createLocalDescription("offer",o._rtcOfferConstraints)}).then(function(g){p.call(o,g)}).catch(function(){l.reply(500)});return}if(n!=="application/sdp"){N.debug("invalid Content-Type"),l.reply(415);return}this._processInDialogSdpOffer(l).then(function(g){o._status!==U.STATUS_TERMINATED&&p.call(o,g)}).catch(function(g){N.warn(g)});function p(g){var v=this,C=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(l,C),this._late_sdp&&(g=this._mangleOffer(g)),l.reply(200,null,C,g,function(){v._status=U.STATUS_WAITING_FOR_ACK,v._setInvite2xxTimer(l,g),v._setACKTimer()}),typeof f.callback=="function"&&f.callback()}}},{key:"_receiveUpdate",value:function(l){var o=this;N.debug("receiveUpdate()");var n=l.hasHeader("Content-Type")?l.getHeader("Content-Type").toLowerCase():void 0,f={request:l,callback:void 0,reject:c.bind(this)},h=!1;function c(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};h=!0;var v=g.status_code||403,C=g.reason_phrase||"",w=Ee.cloneArray(g.extraHeaders);if(this._status!==U.STATUS_CONFIRMED)return!1;if(v<300||v>=700)throw new TypeError("Invalid status_code: ".concat(v));l.reply(v,C,w)}if(this.emit("update",f),h)return;if(!l.body){p.call(this,null);return}if(n!=="application/sdp"){N.debug("invalid Content-Type"),l.reply(415);return}this._processInDialogSdpOffer(l).then(function(g){o._status!==U.STATUS_TERMINATED&&p.call(o,g)}).catch(function(g){N.warn(g)});function p(g){var v=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(l,v),l.reply(200,null,v,g),typeof f.callback=="function"&&f.callback()}}},{key:"_processInDialogSdpOffer",value:function(l){var o=this;N.debug("_processInDialogSdpOffer()");var n=l.parseSDP(),f=!1,h=tn(n.media),c;try{for(h.s();!(c=h.n()).done;){var p=c.value;if(tl.indexOf(p.type)!==-1){var g=p.direction||n.direction||"sendrecv";if(g==="sendonly"||g==="inactive")f=!0;else{f=!1;break}}}}catch(w){h.e(w)}finally{h.f()}var v={originator:"remote",type:"offer",sdp:l.body};N.debug('emit "sdp"'),this.emit("sdp",v);var C=new RTCSessionDescription({type:"offer",sdp:v.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(o._status===U.STATUS_TERMINATED)throw new Error("terminated");return o._connection.setRemoteDescription(C).catch(function(w){throw l.reply(488),N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',w),o.emit("peerconnection:setremotedescriptionfailed",w),w})}).then(function(){if(o._status===U.STATUS_TERMINATED)throw new Error("terminated");o._remoteHold===!0&&f===!1?(o._remoteHold=!1,o._onunhold("remote")):o._remoteHold===!1&&f===!0&&(o._remoteHold=!0,o._onhold("remote"))}).then(function(){if(o._status===U.STATUS_TERMINATED)throw new Error("terminated");return o._createLocalDescription("answer",o._rtcAnswerConstraints).catch(function(w){throw l.reply(500),N.warn('emit "peerconnection:createtelocaldescriptionfailed" [error:%o]',w),w})}).catch(function(w){N.warn("_processInDialogSdpOffer() failed [error: %o]",w)}),this._connectionPromiseQueue}},{key:"_receiveRefer",value:function(l){var o=this;if(N.debug("receiveRefer()"),!l.refer_to){N.debug("no Refer-To header field present in REFER"),l.reply(400);return}if(l.refer_to.uri.scheme!==G.SIP){N.debug("Refer-To header field points to a non-SIP URI scheme"),l.reply(416);return}l.reply(202);var n=new xT(this,l.cseq);N.debug('emit "refer"'),this.emit("refer",{request:l,accept:function(p,g){f.call(o,p,g)},reject:function(){h.call(o)}});function f(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(c=typeof c=="function"?c:null,this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_CONFIRMED)return!1;var g=new r(this._ua);if(g.on("progress",function(C){var w=C.response;n.notify(w.status_code,w.reason_phrase)}),g.on("accepted",function(C){var w=C.response;n.notify(w.status_code,w.reason_phrase)}),g.on("_failed",function(C){var w=C.message,k=C.cause;w?n.notify(w.status_code,w.reason_phrase):n.notify(487,k)}),l.refer_to.uri.hasHeader("replaces")){var v=decodeURIComponent(l.refer_to.uri.getHeader("replaces"));p.extraHeaders=Ee.cloneArray(p.extraHeaders),p.extraHeaders.push("Replaces: ".concat(v))}g.connect(l.refer_to.uri.toAor(),p,c)}function h(){n.notify(603)}}},{key:"_receiveNotify",value:function(l){switch(N.debug("receiveNotify()"),l.event||l.reply(400),l.event.event){case"refer":{var o,n;if(l.event.params&&l.event.params.id)o=l.event.params.id,n=this._referSubscribers[o];else if(Object.keys(this._referSubscribers).length===1)n=this._referSubscribers[Object.keys(this._referSubscribers)[0]];else{l.reply(400,"Missing event id parameter");return}if(!n){l.reply(481,"Subscription does not exist");return}n.receiveNotify(l),l.reply(200);break}default:l.reply(489)}}},{key:"_receiveReplaces",value:function(l){var o=this;N.debug("receiveReplaces()");function n(h){var c=this;if(this._status!==U.STATUS_WAITING_FOR_ACK&&this._status!==U.STATUS_CONFIRMED)return!1;var p=new r(this._ua);p.on("confirmed",function(){c.terminate()}),p.init_incoming(l,h)}function f(){N.debug("Replaced INVITE rejected by the user"),l.reply(486)}this.emit("replaces",{request:l,accept:function(c){n.call(o,c)},reject:function(){f.call(o)}})}},{key:"_sendInitialRequest",value:function(l,o,n){var f=this,h=new PT(this._ua,this._request,{onRequestTimeout:function(){f.onRequestTimeout()},onTransportError:function(){f.onTransportError()},onAuthenticated:function(p){f._request=p},onReceiveResponse:function(p){f._receiveInviteResponse(p)}});Promise.resolve().then(function(){if(n)return n;if(l.audio||l.video)return f._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(l).catch(function(c){throw f._status===U.STATUS_TERMINATED?new Error("terminated"):(f._failed("local",null,G.causes.USER_DENIED_MEDIA_ACCESS),N.warn('emit "getusermediafailed" [error:%o]',c),f.emit("getusermediafailed",c),c)})}).then(function(c){if(f._status===U.STATUS_TERMINATED)throw new Error("terminated");return f._localMediaStream=c,c&&c.getTracks().forEach(function(p){f._connection.addTrack(p,c)}),f._connecting(f._request),f._createLocalDescription("offer",o).catch(function(p){throw f._failed("local",null,G.causes.WEBRTC_ERROR),p})}).then(function(c){if(f._is_canceled||f._status===U.STATUS_TERMINATED)throw new Error("terminated");f._request.body=c,f._status=U.STATUS_INVITE_SENT,N.debug('emit "sending" [request:%o]',f._request),f.emit("sending",{request:f._request}),h.send()}).catch(function(c){f._status!==U.STATUS_TERMINATED&&N.warn(c)})}},{key:"_getDTMFRTPSender",value:function(){var l=this._connection.getSenders().find(function(o){return o.track&&o.track.kind==="audio"});if(!(l&&l.dtmf)){N.warn("sendDTMF() | no local audio track to send DTMF with");return}return l.dtmf}},{key:"_receiveInviteResponse",value:function(l){var o=this;if(N.debug("receiveInviteResponse()"),this._dialog&&l.status_code>=200&&l.status_code<=299)if(this._dialog.id.call_id===l.call_id&&this._dialog.id.local_tag===l.from_tag&&this._dialog.id.remote_tag===l.to_tag){this.sendRequest(G.ACK);return}else{var n=new el(this,l,"UAC");if(n.error!==void 0){N.debug(n.error);return}this.sendRequest(G.ACK),this.sendRequest(G.BYE);return}if(this._is_canceled){l.status_code>=100&&l.status_code<200?this._request.cancel(this._cancel_reason):l.status_code>=200&&l.status_code<299&&this._acceptAndTerminate(l);return}if(!(this._status!==U.STATUS_INVITE_SENT&&this._status!==U.STATUS_1XX_RECEIVED))switch(!0){case/^100$/.test(l.status_code):this._status=U.STATUS_1XX_RECEIVED;break;case/^1[0-9]{2}$/.test(l.status_code):{if(!l.to_tag){N.debug("1xx response received without to tag");break}if(l.hasHeader("contact")&&!this._createDialog(l,"UAC",!0))break;if(this._status=U.STATUS_1XX_RECEIVED,!l.body){this._progress("remote",l);break}var f={originator:"remote",type:"answer",sdp:l.body};N.debug('emit "sdp"'),this.emit("sdp",f);var h=new RTCSessionDescription({type:"answer",sdp:f.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return o._connection.setRemoteDescription(h)}).then(function(){return o._progress("remote",l)}).catch(function(v){N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',v),o.emit("peerconnection:setremotedescriptionfailed",v)});break}case/^2[0-9]{2}$/.test(l.status_code):{if(this._status=U.STATUS_CONFIRMED,!l.body){this._acceptAndTerminate(l,400,G.causes.MISSING_SDP),this._failed("remote",l,G.causes.BAD_MEDIA_DESCRIPTION);break}if(!this._createDialog(l,"UAC"))break;var c={originator:"remote",type:"answer",sdp:l.body};N.debug('emit "sdp"'),this.emit("sdp",c);var p=new RTCSessionDescription({type:"answer",sdp:c.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(o._connection.signalingState==="stable")return o._connection.createOffer(o._rtcOfferConstraints).then(function(v){return o._connection.setLocalDescription(v)}).catch(function(v){o._acceptAndTerminate(l,500,v.toString()),o._failed("local",l,G.causes.WEBRTC_ERROR)})}).then(function(){o._connection.setRemoteDescription(p).then(function(){o._handleSessionTimersInIncomingResponse(l),o._accepted("remote",l),o.sendRequest(G.ACK),o._confirmed("local",null)}).catch(function(v){o._acceptAndTerminate(l,488,"Not Acceptable Here"),o._failed("remote",l,G.causes.BAD_MEDIA_DESCRIPTION),N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',v),o.emit("peerconnection:setremotedescriptionfailed",v)})});break}default:{var g=Ee.sipErrorCause(l.status_code);this._failed("remote",l,g)}}}},{key:"_sendReinvite",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};N.debug("sendReinvite()");var n=Ee.cloneArray(o.extraHeaders),f=Ee.cloneObject(o.eventHandlers),h=o.rtcOfferConstraints||this._rtcOfferConstraints||null,c=!1;n.push("Contact: ".concat(this._contact)),n.push("Content-Type: application/sdp"),this._sessionTimers.running&&n.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return l._createLocalDescription("offer",h)}).then(function(v){v=l._mangleOffer(v);var C={originator:"local",type:"offer",sdp:v};N.debug('emit "sdp"'),l.emit("sdp",C),l.sendRequest(G.INVITE,{extraHeaders:n,body:v,eventHandlers:{onSuccessResponse:function(k){p.call(l,k),c=!0},onErrorResponse:function(k){g.call(l,k)},onTransportError:function(){l.onTransportError()},onRequestTimeout:function(){l.onRequestTimeout()},onDialogError:function(){l.onDialogError()}}})}).catch(function(){g()});function p(v){var C=this;if(this._status!==U.STATUS_TERMINATED&&(this.sendRequest(G.ACK),!c)){if(this._handleSessionTimersInIncomingResponse(v),v.body){if(!v.hasHeader("Content-Type")||v.getHeader("Content-Type").toLowerCase()!=="application/sdp"){g.call(this);return}}else{g.call(this);return}var w={originator:"remote",type:"answer",sdp:v.body};N.debug('emit "sdp"'),this.emit("sdp",w);var k=new RTCSessionDescription({type:"answer",sdp:w.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return C._connection.setRemoteDescription(k)}).then(function(){f.succeeded&&f.succeeded(v)}).catch(function(F){g.call(C),N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',F),C.emit("peerconnection:setremotedescriptionfailed",F)})}}function g(v){f.failed&&f.failed(v)}}},{key:"_sendUpdate",value:function(){var l=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};N.debug("sendUpdate()");var n=Ee.cloneArray(o.extraHeaders),f=Ee.cloneObject(o.eventHandlers),h=o.rtcOfferConstraints||this._rtcOfferConstraints||null,c=o.sdpOffer||!1,p=!1;n.push("Contact: ".concat(this._contact)),this._sessionTimers.running&&n.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),c?(n.push("Content-Type: application/sdp"),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return l._createLocalDescription("offer",h)}).then(function(C){C=l._mangleOffer(C);var w={originator:"local",type:"offer",sdp:C};N.debug('emit "sdp"'),l.emit("sdp",w),l.sendRequest(G.UPDATE,{extraHeaders:n,body:C,eventHandlers:{onSuccessResponse:function(F){g.call(l,F),p=!0},onErrorResponse:function(F){v.call(l,F)},onTransportError:function(){l.onTransportError()},onRequestTimeout:function(){l.onRequestTimeout()},onDialogError:function(){l.onDialogError()}}})}).catch(function(){v.call(l)})):this.sendRequest(G.UPDATE,{extraHeaders:n,eventHandlers:{onSuccessResponse:function(w){g.call(l,w)},onErrorResponse:function(w){v.call(l,w)},onTransportError:function(){l.onTransportError()},onRequestTimeout:function(){l.onRequestTimeout()},onDialogError:function(){l.onDialogError()}}});function g(C){var w=this;if(this._status!==U.STATUS_TERMINATED&&!p)if(this._handleSessionTimersInIncomingResponse(C),c){if(C.body){if(!C.hasHeader("Content-Type")||C.getHeader("Content-Type").toLowerCase()!=="application/sdp"){v.call(this);return}}else{v.call(this);return}var k={originator:"remote",type:"answer",sdp:C.body};N.debug('emit "sdp"'),this.emit("sdp",k);var F=new RTCSessionDescription({type:"answer",sdp:k.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return w._connection.setRemoteDescription(F)}).then(function(){f.succeeded&&f.succeeded(C)}).catch(function(T){v.call(w),N.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',T),w.emit("peerconnection:setremotedescriptionfailed",T)})}else f.succeeded&&f.succeeded(C)}function v(C){f.failed&&f.failed(C)}}},{key:"_acceptAndTerminate",value:function(l,o,n){N.debug("acceptAndTerminate()");var f=[];o&&(n=n||G.REASON_PHRASE[o]||"",f.push("Reason: SIP ;cause=".concat(o,'; text="').concat(n,'"'))),(this._dialog||this._createDialog(l,"UAC"))&&(this.sendRequest(G.ACK),this.sendRequest(G.BYE,{extraHeaders:f})),this._status=U.STATUS_TERMINATED}},{key:"_mangleOffer",value:function(l){if(!this._localHold&&!this._remoteHold)return l;if(l=z_.parse(l),this._localHold&&!this._remoteHold){N.debug("mangleOffer() | me on hold, mangling offer");var o=tn(l.media),n;try{for(o.s();!(n=o.n()).done;){var f=n.value;tl.indexOf(f.type)!==-1&&(f.direction?f.direction==="sendrecv"?f.direction="sendonly":f.direction==="recvonly"&&(f.direction="inactive"):f.direction="sendonly")}}catch(w){o.e(w)}finally{o.f()}}else if(this._localHold&&this._remoteHold){N.debug("mangleOffer() | both on hold, mangling offer");var h=tn(l.media),c;try{for(h.s();!(c=h.n()).done;){var p=c.value;tl.indexOf(p.type)!==-1&&(p.direction="inactive")}}catch(w){h.e(w)}finally{h.f()}}else if(this._remoteHold){N.debug("mangleOffer() | remote on hold, mangling offer");var g=tn(l.media),v;try{for(g.s();!(v=g.n()).done;){var C=v.value;tl.indexOf(C.type)!==-1&&(C.direction?C.direction==="sendrecv"?C.direction="recvonly":C.direction==="recvonly"&&(C.direction="inactive"):C.direction="recvonly")}}catch(w){g.e(w)}finally{g.f()}}return z_.write(l)}},{key:"_setLocalMediaStatus",value:function(){var l=!0,o=!0;(this._localHold||this._remoteHold)&&(l=!1,o=!1),this._audioMuted&&(l=!1),this._videoMuted&&(o=!1),this._toggleMuteAudio(!l),this._toggleMuteVideo(!o)}},{key:"_handleSessionTimersInIncomingRequest",value:function(l,o){if(this._sessionTimers.enabled){var n;l.session_expires&&l.session_expires>=G.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=l.session_expires,n=l.session_expires_refresher||"uas"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,n="uas"),o.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(n)),this._sessionTimers.refresher=n==="uas",this._runSessionTimer()}}},{key:"_handleSessionTimersInIncomingResponse",value:function(l){if(this._sessionTimers.enabled){var o;l.session_expires&&l.session_expires>=G.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=l.session_expires,o=l.session_expires_refresher||"uac"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,o="uac"),this._sessionTimers.refresher=o==="uac",this._runSessionTimer()}}},{key:"_runSessionTimer",value:function(){var l=this,o=this._sessionTimers.currentExpires;this._sessionTimers.running=!0,clearTimeout(this._sessionTimers.timer),this._sessionTimers.refresher?this._sessionTimers.timer=setTimeout(function(){l._status!==U.STATUS_TERMINATED&&l._isReadyToReOffer()&&(N.debug("runSessionTimer() | sending session refresh request"),l._sessionTimers.refreshMethod===G.UPDATE?l._sendUpdate():l._sendReinvite())},o*500):this._sessionTimers.timer=setTimeout(function(){l._status!==U.STATUS_TERMINATED&&(N.warn("runSessionTimer() | timer expired, terminating the session"),l.terminate({cause:G.causes.REQUEST_TIMEOUT,status_code:408,reason_phrase:"Session Timer Expired"}))},o*1100)}},{key:"_toggleMuteAudio",value:function(l){var o=this._connection.getSenders().filter(function(c){return c.track&&c.track.kind==="audio"}),n=tn(o),f;try{for(n.s();!(f=n.n()).done;){var h=f.value;h.track.enabled=!l}}catch(c){n.e(c)}finally{n.f()}}},{key:"_toggleMuteVideo",value:function(l){var o=this._connection.getSenders().filter(function(c){return c.track&&c.track.kind==="video"}),n=tn(o),f;try{for(n.s();!(f=n.n()).done;){var h=f.value;h.track.enabled=!l}}catch(c){n.e(c)}finally{n.f()}}},{key:"_newRTCSession",value:function(l,o){N.debug("newRTCSession()"),this._ua.newRTCSession(this,{originator:l,session:this,request:o})}},{key:"_connecting",value:function(l){N.debug("session connecting"),N.debug('emit "connecting"'),this.emit("connecting",{request:l})}},{key:"_progress",value:function(l,o){N.debug("session progress"),N.debug('emit "progress"'),this.emit("progress",{originator:l,response:o||null})}},{key:"_accepted",value:function(l,o){N.debug("session accepted"),this._start_time=new Date,N.debug('emit "accepted"'),this.emit("accepted",{originator:l,response:o||null})}},{key:"_confirmed",value:function(l,o){N.debug("session confirmed"),this._is_confirmed=!0,N.debug('emit "confirmed"'),this.emit("confirmed",{originator:l,ack:o||null})}},{key:"_ended",value:function(l,o,n){N.debug("session ended"),this._end_time=new Date,this._close(),N.debug('emit "ended"'),this.emit("ended",{originator:l,message:o||null,cause:n})}},{key:"_failed",value:function(l,o,n){N.debug("session failed"),N.debug('emit "_failed"'),this.emit("_failed",{originator:l,message:o||null,cause:n}),this._close(),N.debug('emit "failed"'),this.emit("failed",{originator:l,message:o||null,cause:n})}},{key:"_onhold",value:function(l){N.debug("session onhold"),this._setLocalMediaStatus(),N.debug('emit "hold"'),this.emit("hold",{originator:l})}},{key:"_onunhold",value:function(l){N.debug("session onunhold"),this._setLocalMediaStatus(),N.debug('emit "unhold"'),this.emit("unhold",{originator:l})}},{key:"_onmute",value:function(l){var o=l.audio,n=l.video;N.debug("session onmute"),this._setLocalMediaStatus(),N.debug('emit "muted"'),this.emit("muted",{audio:o,video:n})}},{key:"_onunmute",value:function(l){var o=l.audio,n=l.video;N.debug("session onunmute"),this._setLocalMediaStatus(),N.debug('emit "unmuted"'),this.emit("unmuted",{audio:o,video:n})}},{key:"C",get:function(){return U}},{key:"causes",get:function(){return G.causes}},{key:"id",get:function(){return this._id}},{key:"connection",get:function(){return this._connection}},{key:"contact",get:function(){return this._contact}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}},{key:"start_time",get:function(){return this._start_time}},{key:"end_time",get:function(){return this._end_time}},{key:"data",get:function(){return this._data},set:function(l){this._data=l}},{key:"status",get:function(){return this._status}}]),r}(IT);function Il(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Il=function(r){return typeof r}:Il=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Il(t)}function MT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function LT(t,e,r){return e&&K_(t.prototype,e),r&&K_(t,r),t}function UT(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zu(t,e)}function Zu(t,e){return Zu=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},Zu(t,e)}function FT(t){var e=jT();return function(){var i=ao(t),l;if(e){var o=ao(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return $T(this,l)}}function $T(t,e){return e&&(Il(e)==="object"||typeof e=="function")?e:HT(t)}function HT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function ao(t){return ao=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ao(t)}var VT=Bn.EventEmitter,BT=ze,za=Ue,zT=hn,Ci=nt(),qT=ms,Q_=jn,WT=Vn(),nl=new BT("Message"),GT=function(t){UT(r,t);var e=FT(r);function r(i){var l;return MT(this,r),l=e.call(this),l._ua=i,l._request=null,l._closed=!1,l._direction=null,l._local_identity=null,l._remote_identity=null,l._is_replied=!1,l._data={},l}return LT(r,[{key:"send",value:function(l,o){var n=this,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=l;if(l===void 0||o===void 0)throw new TypeError("Not enough arguments");if(l=this._ua.normalizeTarget(l),!l)throw new TypeError("Invalid target: ".concat(h));var c=Ci.cloneArray(f.extraHeaders),p=Ci.cloneObject(f.eventHandlers),g=f.contentType||"text/plain",v={};f.fromUserName&&(v.from_uri=new WT("sip",f.fromUserName,this._ua.configuration.uri.host),c.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString()))),f.fromDisplayName&&(v.from_display_name=f.fromDisplayName);for(var C in p)Object.prototype.hasOwnProperty.call(p,C)&&this.on(C,p[C]);c.push("Content-Type: ".concat(g)),this._request=new zT.OutgoingRequest(za.MESSAGE,l,this._ua,v,c),o&&(this._request.body=o);var w=new qT(this._ua,this._request,{onRequestTimeout:function(){n._onRequestTimeout()},onTransportError:function(){n._onTransportError()},onReceiveResponse:function(F){n._receiveResponse(F)}});this._newMessage("local",this._request),w.send()}},{key:"init_incoming",value:function(l){this._request=l,this._newMessage("remote",l),this._is_replied||(this._is_replied=!0,l.reply(200)),this._close()}},{key:"accept",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=Ci.cloneArray(l.extraHeaders),n=l.body;if(this._direction!=="incoming")throw new Q_.NotSupportedError('"accept" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");this._is_replied=!0,this._request.reply(200,null,o,n)}},{key:"reject",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=l.status_code||480,n=l.reason_phrase,f=Ci.cloneArray(l.extraHeaders),h=l.body;if(this._direction!=="incoming")throw new Q_.NotSupportedError('"reject" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");if(o<300||o>=700)throw new TypeError("Invalid status_code: ".concat(o));this._is_replied=!0,this._request.reply(o,n,f,h)}},{key:"_receiveResponse",value:function(l){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(l.status_code):break;case/^2[0-9]{2}$/.test(l.status_code):this._succeeded("remote",l);break;default:{var o=Ci.sipErrorCause(l.status_code);this._failed("remote",l,o);break}}}},{key:"_onRequestTimeout",value:function(){this._closed||this._failed("system",null,za.causes.REQUEST_TIMEOUT)}},{key:"_onTransportError",value:function(){this._closed||this._failed("system",null,za.causes.CONNECTION_ERROR)}},{key:"_close",value:function(){this._closed=!0,this._ua.destroyMessage(this)}},{key:"_newMessage",value:function(l,o){l==="remote"?(this._direction="incoming",this._local_identity=o.to,this._remote_identity=o.from):l==="local"&&(this._direction="outgoing",this._local_identity=o.from,this._remote_identity=o.to),this._ua.newMessage(this,{originator:l,message:this,request:o})}},{key:"_failed",value:function(l,o,n){nl.debug("MESSAGE failed"),this._close(),nl.debug('emit "failed"'),this.emit("failed",{originator:l,response:o||null,cause:n})}},{key:"_succeeded",value:function(l,o){nl.debug("MESSAGE succeeded"),this._close(),nl.debug('emit "succeeded"'),this.emit("succeeded",{originator:l,response:o})}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}}]),r}(VT);function bl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bl=function(r){return typeof r}:bl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},bl(t)}function KT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function QT(t,e,r){return e&&Y_(t.prototype,e),r&&Y_(t,r),t}function YT(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ec(t,e)}function ec(t,e){return ec=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},ec(t,e)}function JT(t){var e=ew();return function(){var i=uo(t),l;if(e){var o=uo(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return XT(this,l)}}function XT(t,e){return e&&(bl(e)==="object"||typeof e=="function")?e:ZT(t)}function ZT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ew(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(t)}var tw=Bn.EventEmitter,nw=ze,qa=Ue,rw=hn,Ti=nt(),iw=ms,J_=jn,rl=new nw("Options"),sw=function(t){YT(r,t);var e=JT(r);function r(i){var l;return KT(this,r),l=e.call(this),l._ua=i,l._request=null,l._closed=!1,l._direction=null,l._local_identity=null,l._remote_identity=null,l._is_replied=!1,l._data={},l}return QT(r,[{key:"send",value:function(l,o){var n=this,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=l;if(l===void 0)throw new TypeError("A target is required for OPTIONS");if(l=this._ua.normalizeTarget(l),!l)throw new TypeError("Invalid target: ".concat(h));var c=Ti.cloneArray(f.extraHeaders),p=Ti.cloneObject(f.eventHandlers),g=f.contentType||"application/sdp";for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&this.on(v,p[v]);c.push("Content-Type: ".concat(g)),this._request=new rw.OutgoingRequest(qa.OPTIONS,l,this._ua,null,c),o&&(this._request.body=o);var C=new iw(this._ua,this._request,{onRequestTimeout:function(){n._onRequestTimeout()},onTransportError:function(){n._onTransportError()},onReceiveResponse:function(k){n._receiveResponse(k)}});this._newOptions("local",this._request),C.send()}},{key:"init_incoming",value:function(l){this._request=l,this._newOptions("remote",l),this._is_replied||(this._is_replied=!0,l.reply(200)),this._close()}},{key:"accept",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=Ti.cloneArray(l.extraHeaders),n=l.body;if(this._direction!=="incoming")throw new J_.NotSupportedError('"accept" not supported for outgoing Options');if(this._is_replied)throw new Error("incoming Options already replied");this._is_replied=!0,this._request.reply(200,null,o,n)}},{key:"reject",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=l.status_code||480,n=l.reason_phrase,f=Ti.cloneArray(l.extraHeaders),h=l.body;if(this._direction!=="incoming")throw new J_.NotSupportedError('"reject" not supported for outgoing Options');if(this._is_replied)throw new Error("incoming Options already replied");if(o<300||o>=700)throw new TypeError("Invalid status_code: ".concat(o));this._is_replied=!0,this._request.reply(o,n,f,h)}},{key:"_receiveResponse",value:function(l){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(l.status_code):break;case/^2[0-9]{2}$/.test(l.status_code):this._succeeded("remote",l);break;default:{var o=Ti.sipErrorCause(l.status_code);this._failed("remote",l,o);break}}}},{key:"_onRequestTimeout",value:function(){this._closed||this._failed("system",null,qa.causes.REQUEST_TIMEOUT)}},{key:"_onTransportError",value:function(){this._closed||this._failed("system",null,qa.causes.CONNECTION_ERROR)}},{key:"_close",value:function(){this._closed=!0,this._ua.destroyMessage(this)}},{key:"_newOptions",value:function(l,o){l==="remote"?(this._direction="incoming",this._local_identity=o.to,this._remote_identity=o.from):l==="local"&&(this._direction="outgoing",this._local_identity=o.from,this._remote_identity=o.to),this._ua.newOptions(this,{originator:l,message:this,request:o})}},{key:"_failed",value:function(l,o,n){rl.debug("OPTIONS failed"),this._close(),rl.debug('emit "failed"'),this.emit("failed",{originator:l,response:o||null,cause:n})}},{key:"_succeeded",value:function(l,o){rl.debug("OPTIONS succeeded"),this._close(),rl.debug('emit "succeeded"'),this.emit("succeeded",{originator:l,response:o})}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}}]),r}(tw),lf={},lw=ze,Wa=nt(),ow=Yt(),wi=new lw("Socket");lf.isSocket=function(t){if(Array.isArray(t))return!1;if(typeof t=="undefined")return wi.warn("undefined JsSIP.Socket instance"),!1;try{if(!Wa.isString(t.url))throw wi.warn("missing or invalid JsSIP.Socket url property"),new Error("Missing or invalid JsSIP.Socket url property");if(!Wa.isString(t.via_transport))throw wi.warn("missing or invalid JsSIP.Socket via_transport property"),new Error("Missing or invalid JsSIP.Socket via_transport property");if(ow.parse(t.sip_uri,"SIP_URI")===-1)throw wi.warn("missing or invalid JsSIP.Socket sip_uri property"),new Error("missing or invalid JsSIP.Socket sip_uri property")}catch(e){return!1}try{["connect","disconnect","send"].forEach(function(e){if(!Wa.isFunction(t[e]))throw wi.warn("missing or invalid JsSIP.Socket method: ".concat(e)),new Error("Missing or invalid JsSIP.Socket method: ".concat(e))})}catch(e){return!1}return!0};function aw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X_(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function uw(t,e,r){return e&&X_(t.prototype,e),r&&X_(t,r),t}var cw=ze,fw=lf,Z_=Ue,ct=new cw("Transport"),Rt={STATUS_CONNECTED:0,STATUS_CONNECTING:1,STATUS_DISCONNECTED:2,SOCKET_STATUS_READY:0,SOCKET_STATUS_ERROR:1,recovery_options:{min_interval:Z_.CONNECTION_RECOVERY_MIN_INTERVAL,max_interval:Z_.CONNECTION_RECOVERY_MAX_INTERVAL}},dw=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rt.recovery_options;aw(this,t),ct.debug("new()"),this.status=Rt.STATUS_DISCONNECTED,this.socket=null,this.sockets=[],this.recovery_options=r,this.recover_attempts=0,this.recovery_timer=null,this.close_requested=!1;try{this.textDecoder=new TextDecoder("utf8")}catch(i){ct.warn("cannot use TextDecoder: ".concat(i))}if(typeof e=="undefined")throw new TypeError("Invalid argument. undefined 'sockets' argument");e instanceof Array||(e=[e]),e.forEach(function(i){if(!fw.isSocket(i.socket))throw new TypeError("Invalid argument. invalid 'JsSIP.Socket' instance");if(i.weight&&!Number(i.weight))throw new TypeError("Invalid argument. 'weight' attribute is not a number");this.sockets.push({socket:i.socket,weight:i.weight||0,status:Rt.SOCKET_STATUS_READY})},this),this._getSocket()}return uw(t,[{key:"connect",value:function(){if(ct.debug("connect()"),this.isConnected()){ct.debug("Transport is already connected");return}else if(this.isConnecting()){ct.debug("Transport is connecting");return}this.close_requested=!1,this.status=Rt.STATUS_CONNECTING,this.onconnecting({socket:this.socket,attempts:this.recover_attempts}),this.close_requested||(this.socket.onconnect=this._onConnect.bind(this),this.socket.ondisconnect=this._onDisconnect.bind(this),this.socket.ondata=this._onData.bind(this),this.socket.connect())}},{key:"disconnect",value:function(){ct.debug("close()"),this.close_requested=!0,this.recover_attempts=0,this.status=Rt.STATUS_DISCONNECTED,this.recovery_timer!==null&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.socket.onconnect=function(){},this.socket.ondisconnect=function(){},this.socket.ondata=function(){},this.socket.disconnect(),this.ondisconnect({socket:this.socket,error:!1})}},{key:"send",value:function(r){if(ct.debug("send()"),!this.isConnected())return ct.warn("unable to send message, transport is not connected"),!1;var i=r.toString();return ct.debug(`sending message:

`.concat(i,`
`)),this.socket.send(i)}},{key:"isConnected",value:function(){return this.status===Rt.STATUS_CONNECTED}},{key:"isConnecting",value:function(){return this.status===Rt.STATUS_CONNECTING}},{key:"_reconnect",value:function(){var r=this;this.recover_attempts+=1;var i=Math.floor(Math.random()*Math.pow(2,this.recover_attempts)+1);i<this.recovery_options.min_interval?i=this.recovery_options.min_interval:i>this.recovery_options.max_interval&&(i=this.recovery_options.max_interval),ct.debug("reconnection attempt: ".concat(this.recover_attempts,". next connection attempt in ").concat(i," seconds")),this.recovery_timer=setTimeout(function(){!r.close_requested&&!(r.isConnected()||r.isConnecting())&&(r._getSocket(),r.connect())},i*1e3)}},{key:"_getSocket",value:function(){var r=[];if(this.sockets.forEach(function(l){l.status!==Rt.SOCKET_STATUS_ERROR&&(r.length===0?r.push(l):l.weight>r[0].weight?r=[l]:l.weight===r[0].weight&&r.push(l))}),r.length===0){this.sockets.forEach(function(l){l.status=Rt.SOCKET_STATUS_READY}),this._getSocket();return}var i=Math.floor(Math.random()*r.length);this.socket=r[i].socket}},{key:"_onConnect",value:function(){this.recover_attempts=0,this.status=Rt.STATUS_CONNECTED,this.recovery_timer!==null&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.onconnect({socket:this})}},{key:"_onDisconnect",value:function(r,i,l){this.status=Rt.STATUS_DISCONNECTED,this.ondisconnect({socket:this.socket,error:r,code:i,reason:l}),!this.close_requested&&(this.sockets.forEach(function(o){this.socket===o.socket&&(o.status=Rt.SOCKET_STATUS_ERROR)},this),this._reconnect(r))}},{key:"_onData",value:function(r){if(r===`\r
`){ct.debug("received message with CRLF Keep Alive response");return}else if(typeof r!="string"){try{this.textDecoder?r=this.textDecoder.decode(r):r=String.fromCharCode.apply(null,new Uint8Array(r))}catch(i){ct.debug("received binary message failed to be converted into string, message discarded");return}ct.debug(`received binary message:

`.concat(r,`
`))}else ct.debug(`received text message:

`.concat(r,`
`));this.ondata({transport:this,message:r})}},{key:"via_transport",get:function(){return this.socket.via_transport}},{key:"url",get:function(){return this.socket.url}},{key:"sip_uri",get:function(){return this.socket.sip_uri}}]),t}(),qm={};function ep(t,e){var r;if(typeof Symbol=="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=hw(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var i=0,l=function(){};return{s:l,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(c){throw c},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,n=!1,f;return{s:function(){r=t[Symbol.iterator]()},n:function(){var c=r.next();return o=c.done,c},e:function(c){n=!0,f=c},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(n)throw f}}}}function hw(t,e){if(t){if(typeof t=="string")return tp(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tp(t,e)}}function tp(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var _w=ze,tc=Yt(),nc=hn,il=new _w("Parser");qm.parseMessage=function(t,e){var r,i,l=t.indexOf(`\r
`);if(l===-1){il.warn("parseMessage() | no CRLF found, not a SIP message");return}var o=t.substring(0,l),n=tc.parse(o,"Request_Response");if(n===-1){il.warn('parseMessage() | error parsing first line of SIP message: "'.concat(o,'"'));return}else n.status_code?(r=new nc.IncomingResponse,r.status_code=n.status_code,r.reason_phrase=n.reason_phrase):(r=new nc.IncomingRequest(e),r.method=n.method,r.ruri=n.uri);r.data=t;for(var f=l+2;;){if(l=pw(t,f),l===-2){i=f+2;break}else if(l===-1){il.warn("parseMessage() | malformed message");return}if(n=gw(r,t,f,l),n!==!0){il.warn("parseMessage() |",n.error);return}f=l+2}if(r.hasHeader("content-length")){var h=r.getHeader("content-length");r.body=t.substr(i,h)}else r.body=t.substring(i);return r};function pw(t,e){var r=e,i=0,l=0;if(t.substring(r,r+2).match(/(^\r\n)/))return-2;for(;i===0;){if(l=t.indexOf(`\r
`,r),l===-1)return l;!t.substring(l+2,l+4).match(/(^\r\n)/)&&t.charAt(l+2).match(/(^\s+)/)?r=l+2:i=l}return i}function gw(t,e,r,i){var l,o=e.indexOf(":",r),n=e.substring(r,o).trim(),f=e.substring(o+1,i).trim();switch(n.toLowerCase()){case"via":case"v":t.addHeader("via",f),t.getHeaders("via").length===1?(l=t.parseHeader("Via"),l&&(t.via=l,t.via_branch=l.branch)):l=0;break;case"from":case"f":t.setHeader("from",f),l=t.parseHeader("from"),l&&(t.from=l,t.from_tag=l.getParam("tag"));break;case"to":case"t":t.setHeader("to",f),l=t.parseHeader("to"),l&&(t.to=l,t.to_tag=l.getParam("tag"));break;case"record-route":if(l=tc.parse(f,"Record_Route"),l===-1)l=void 0;else{var h=ep(l),c;try{for(h.s();!(c=h.n()).done;){var p=c.value;t.addHeader("record-route",f.substring(p.possition,p.offset)),t.headers["Record-Route"][t.getHeaders("record-route").length-1].parsed=p.parsed}}catch(w){h.e(w)}finally{h.f()}}break;case"call-id":case"i":t.setHeader("call-id",f),l=t.parseHeader("call-id"),l&&(t.call_id=f);break;case"contact":case"m":if(l=tc.parse(f,"Contact"),l===-1)l=void 0;else{var g=ep(l),v;try{for(g.s();!(v=g.n()).done;){var C=v.value;t.addHeader("contact",f.substring(C.possition,C.offset)),t.headers.Contact[t.getHeaders("contact").length-1].parsed=C.parsed}}catch(w){g.e(w)}finally{g.f()}}break;case"content-length":case"l":t.setHeader("content-length",f),l=t.parseHeader("content-length");break;case"content-type":case"c":t.setHeader("content-type",f),l=t.parseHeader("content-type");break;case"cseq":t.setHeader("cseq",f),l=t.parseHeader("cseq"),l&&(t.cseq=l.value),t instanceof nc.IncomingResponse&&(t.method=l.method);break;case"max-forwards":t.setHeader("max-forwards",f),l=t.parseHeader("max-forwards");break;case"www-authenticate":t.setHeader("www-authenticate",f),l=t.parseHeader("www-authenticate");break;case"proxy-authenticate":t.setHeader("proxy-authenticate",f),l=t.parseHeader("proxy-authenticate");break;case"session-expires":case"x":t.setHeader("session-expires",f),l=t.parseHeader("session-expires"),l&&(t.session_expires=l.expires,t.session_expires_refresher=l.refresher);break;case"refer-to":case"r":t.setHeader("refer-to",f),l=t.parseHeader("refer-to"),l&&(t.refer_to=l);break;case"replaces":t.setHeader("replaces",f),l=t.parseHeader("replaces"),l&&(t.replaces=l);break;case"event":case"o":t.setHeader("event",f),l=t.parseHeader("event"),l&&(t.event=l);break;default:t.addHeader(n,f),l=0}return l===void 0?{error:'error parsing header "'.concat(n,'"')}:!0}function Ol(t,e){var r;if(typeof Symbol=="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=mw(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var i=0,l=function(){};return{s:l,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(c){throw c},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,n=!1,f;return{s:function(){r=t[Symbol.iterator]()},n:function(){var c=r.next();return o=c.done,c},e:function(c){n=!0,f=c},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(n)throw f}}}}function mw(t,e){if(t){if(typeof t=="string")return np(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return np(t,e)}}function np(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var vw=ze,Wm=Ue,rp=hn,of=nt(),af=new vw("sanityCheck"),yw=[bw],Sw=[ww,Ew,Aw,Rw],Cw=[kw,Iw],me,qt,Gm,Tw=function(t,e,r){me=t,qt=e,Gm=r;var i=Ol(yw),l;try{for(i.s();!(l=i.n()).done;){var o=l.value;if(o()===!1)return!1}}catch(v){i.e(v)}finally{i.f()}if(me instanceof rp.IncomingRequest){var n=Ol(Sw),f;try{for(n.s();!(f=n.n()).done;){var h=f.value;if(h()===!1)return!1}}catch(v){n.e(v)}finally{n.f()}}else if(me instanceof rp.IncomingResponse){var c=Ol(Cw),p;try{for(c.s();!(p=c.n()).done;){var g=p.value;if(g()===!1)return!1}}catch(v){c.e(v)}finally{c.f()}}return!0};function ww(){if(me.s("to").uri.scheme!=="sip")return rs(416),!1}function Ew(){if(!me.to_tag&&me.call_id.substr(0,5)===qt.configuration.jssip_id)return rs(482),!1}function Aw(){var t=of.str_utf8_length(me.body),e=me.getHeader("content-length");if(t<e)return rs(400),!1}function Rw(){var t=me.from_tag,e=me.call_id,r=me.cseq,i;if(!me.to_tag)if(me.method===Wm.INVITE){if(qt._transactions.ist[me.via_branch])return!1;for(var l in qt._transactions.ist)if(Object.prototype.hasOwnProperty.call(qt._transactions.ist,l)&&(i=qt._transactions.ist[l],i.request.from_tag===t&&i.request.call_id===e&&i.request.cseq===r))return rs(482),!1}else{if(qt._transactions.nist[me.via_branch])return!1;for(var o in qt._transactions.nist)if(Object.prototype.hasOwnProperty.call(qt._transactions.nist,o)&&(i=qt._transactions.nist[o],i.request.from_tag===t&&i.request.call_id===e&&i.request.cseq===r))return rs(482),!1}}function kw(){if(me.getHeaders("via").length>1)return af.debug("more than one Via header field present in the response, dropping the response"),!1}function Iw(){var t=of.str_utf8_length(me.body),e=me.getHeader("content-length");if(t<e)return af.debug("message body length is lower than the value in Content-Length header field, dropping the response"),!1}function bw(){for(var t=["from","to","call_id","cseq","via"],e=0,r=t;e<r.length;e++){var i=r[e];if(!me.hasHeader(i))return af.debug("missing mandatory header field : ".concat(i,", dropping the response")),!1}}function rs(t){var e=me.getHeaders("via"),r,i="SIP/2.0 ".concat(t," ").concat(Wm.REASON_PHRASE[t],`\r
`),l=Ol(e),o;try{for(l.s();!(o=l.n()).done;){var n=o.value;i+="Via: ".concat(n,`\r
`)}}catch(f){l.e(f)}finally{l.f()}r=me.getHeader("To"),me.to_tag||(r+=";tag=".concat(of.newTag())),i+="To: ".concat(r,`\r
`),i+="From: ".concat(me.getHeader("From"),`\r
`),i+="Call-ID: ".concat(me.call_id,`\r
`),i+="CSeq: ".concat(me.cseq," ").concat(me.method,`\r
`),i+=`\r
`,Gm.send(i)}var uf={};function ip(t,e){var r;if(typeof Symbol=="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=Ow(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var i=0,l=function(){};return{s:l,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(c){throw c},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,n=!1,f;return{s:function(){r=t[Symbol.iterator]()},n:function(){var c=r.next();return o=c.done,c},e:function(c){n=!0,f=c},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(n)throw f}}}}function Ow(t,e){if(t){if(typeof t=="string")return sp(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sp(t,e)}}function sp(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var Nr=nt(),ir=Ue,Ga=Yt(),lp=Vn(),Ka=lf,Qa=jn;uf.settings={authorization_user:null,password:null,realm:null,ha1:null,authorization_jwt:null,display_name:null,uri:null,contact_uri:null,instance_id:null,use_preloaded_route:!1,session_timers:!0,session_timers_refresh_method:ir.UPDATE,session_timers_force_refresher:!1,no_answer_timeout:60,register:!0,register_expires:600,registrar_server:null,sockets:null,connection_recovery_max_interval:ir.CONNECTION_RECOVERY_MAX_INTERVAL,connection_recovery_min_interval:ir.CONNECTION_RECOVERY_MIN_INTERVAL,extra_headers:null,via_host:"".concat(Nr.createRandomToken(12),".invalid")};var sl={mandatory:{sockets:function(e){var r=[];if(Ka.isSocket(e))r.push({socket:e});else if(Array.isArray(e)&&e.length){var i=ip(e),l;try{for(i.s();!(l=i.n()).done;){var o=l.value;Object.prototype.hasOwnProperty.call(o,"socket")&&Ka.isSocket(o.socket)?r.push(o):Ka.isSocket(o)&&r.push({socket:o})}}catch(n){i.e(n)}finally{i.f()}}else return;return r},uri:function(e){/^sip:/i.test(e)||(e="".concat(ir.SIP,":").concat(e));var r=lp.parse(e);if(r)return r.user?r:void 0}},optional:{authorization_user:function(e){if(Ga.parse('"'.concat(e,'"'),"quoted_string")!==-1)return e},authorization_jwt:function(e){if(typeof e=="string")return e},user_agent:function(e){if(typeof e=="string")return e},connection_recovery_max_interval:function(e){if(Nr.isDecimal(e)){var r=Number(e);if(r>0)return r}},connection_recovery_min_interval:function(e){if(Nr.isDecimal(e)){var r=Number(e);if(r>0)return r}},contact_uri:function(e){if(typeof e=="string"){var r=Ga.parse(e,"SIP_URI");if(r!==-1)return r}},display_name:function(e){return e},instance_id:function(e){if(/^uuid:/i.test(e)&&(e=e.substr(5)),Ga.parse(e,"uuid")!==-1)return e},no_answer_timeout:function(e){if(Nr.isDecimal(e)){var r=Number(e);if(r>0)return r}},session_timers:function(e){if(typeof e=="boolean")return e},session_timers_refresh_method:function(e){if(typeof e=="string"&&(e=e.toUpperCase(),e===ir.INVITE||e===ir.UPDATE))return e},session_timers_force_refresher:function(e){if(typeof e=="boolean")return e},password:function(e){return String(e)},realm:function(e){return String(e)},ha1:function(e){return String(e)},register:function(e){if(typeof e=="boolean")return e},register_expires:function(e){if(Nr.isDecimal(e)){var r=Number(e);if(r>0)return r}},registrar_server:function(e){/^sip:/i.test(e)||(e="".concat(ir.SIP,":").concat(e));var r=lp.parse(e);if(r)return r.user?void 0:r},use_preloaded_route:function(e){if(typeof e=="boolean")return e},extra_headers:function(e){var r=[];if(Array.isArray(e)&&e.length){var i=ip(e),l;try{for(i.s();!(l=i.n()).done;){var o=l.value;typeof o=="string"&&r.push(o)}}catch(n){i.e(n)}finally{i.f()}}else return;return r}}};uf.load=function(t,e){for(var r in sl.mandatory)if(e.hasOwnProperty(r)){var i=e[r],l=sl.mandatory[r](i);if(l!==void 0)t[r]=l;else throw new Qa.ConfigurationError(r,i)}else throw new Qa.ConfigurationError(r);for(var o in sl.optional)if(e.hasOwnProperty(o)){var n=e[o];if(Nr.isEmpty(n))continue;var f=sl.optional[o](n);if(f!==void 0)t[o]=f;else throw new Qa.ConfigurationError(o,n)}};function Pl(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pl=function(r){return typeof r}:Pl=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Pl(t)}function Pw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function op(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ap(t,e,r){return e&&op(t.prototype,e),r&&op(t,r),t}function xw(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rc(t,e)}function rc(t,e){return rc=Object.setPrototypeOf||function(i,l){return i.__proto__=l,i},rc(t,e)}function Dw(t){var e=Mw();return function(){var i=co(t),l;if(e){var o=co(this).constructor;l=Reflect.construct(i,arguments,o)}else l=i.apply(this,arguments);return Nw(this,l)}}function Nw(t,e){return e&&(Pl(e)==="object"||typeof e=="function")?e:Km(t)}function Km(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function co(t){return co=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},co(t)}var Lw=Bn.EventEmitter,Uw=ze,qe=Ue,Fw=AC,up=NT,cp=GT,fp=sw,Ya=gs,$w=dw,ll=nt(),Hw=jn,jw=Vn(),Vw=qm,Ja=hn,Bw=Tw,Xa=uf,Se=new Uw("UA"),Ge={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2},zw=function(t){xw(r,t);var e=Dw(r);ap(r,null,[{key:"C",get:function(){return Ge}}]);function r(i){var l;if(Pw(this,r),Se.debug("new() [configuration:%o]",i),l=e.call(this),l._cache={credentials:{}},l._configuration=Object.assign({},Xa.settings),l._dynConfiguration={},l._dialogs={},l._applicants={},l._sessions={},l._transport=null,l._contact=null,l._status=Ge.STATUS_INIT,l._error=null,l._transactions={nist:{},nict:{},ist:{},ict:{}},l._data={},l._closeTimer=null,i===void 0)throw new TypeError("Not enough arguments");try{l._loadConfig(i)}catch(o){throw l._status=Ge.STATUS_NOT_READY,l._error=Ge.CONFIGURATION_ERROR,o}return l._registrator=new Fw(Km(l)),l}return ap(r,[{key:"start",value:function(){Se.debug("start()"),this._status===Ge.STATUS_INIT?this._transport.connect():this._status===Ge.STATUS_USER_CLOSED?(Se.debug("restarting UA"),this._closeTimer!==null&&(clearTimeout(this._closeTimer),this._closeTimer=null,this._transport.disconnect()),this._status=Ge.STATUS_INIT,this._transport.connect()):this._status===Ge.STATUS_READY?Se.debug("UA is in READY status, not restarted"):Se.debug("ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this._dynConfiguration.register=this._configuration.register}},{key:"register",value:function(){Se.debug("register()"),this._dynConfiguration.register=!0,this._registrator.register()}},{key:"unregister",value:function(l){Se.debug("unregister()"),this._dynConfiguration.register=!1,this._registrator.unregister(l)}},{key:"registrator",value:function(){return this._registrator}},{key:"isRegistered",value:function(){return this._registrator.registered}},{key:"isConnected",value:function(){return this._transport.isConnected()}},{key:"call",value:function(l,o){Se.debug("call()");var n=new up(this);return n.connect(l,o),n}},{key:"sendMessage",value:function(l,o,n){Se.debug("sendMessage()");var f=new cp(this);return f.send(l,o,n),f}},{key:"sendOptions",value:function(l,o,n){Se.debug("sendOptions()");var f=new fp(this);return f.send(l,o,n),f}},{key:"terminateSessions",value:function(l){Se.debug("terminateSessions()");for(var o in this._sessions)this._sessions[o].isEnded()||this._sessions[o].terminate(l)}},{key:"stop",value:function(){var l=this;if(Se.debug("stop()"),this._dynConfiguration={},this._status===Ge.STATUS_USER_CLOSED){Se.debug("UA already closed");return}this._registrator.close();var o=Object.keys(this._sessions).length;for(var n in this._sessions)if(Object.prototype.hasOwnProperty.call(this._sessions,n)){Se.debug("closing session ".concat(n));try{this._sessions[n].terminate()}catch(c){}}for(var f in this._applicants)if(Object.prototype.hasOwnProperty.call(this._applicants,f))try{this._applicants[f].close()}catch(c){}this._status=Ge.STATUS_USER_CLOSED;var h=Object.keys(this._transactions.nict).length+Object.keys(this._transactions.nist).length+Object.keys(this._transactions.ict).length+Object.keys(this._transactions.ist).length;h===0&&o===0?this._transport.disconnect():this._closeTimer=setTimeout(function(){l._closeTimer=null,l._transport.disconnect()},2e3)}},{key:"normalizeTarget",value:function(l){return ll.normalizeTarget(l,this._configuration.hostport_params)}},{key:"get",value:function(l){switch(l){case"authorization_user":return this._configuration.authorization_user;case"realm":return this._configuration.realm;case"ha1":return this._configuration.ha1;case"authorization_jwt":return this._configuration.authorization_jwt;default:Se.warn('get() | cannot get "%s" parameter in runtime',l);return}}},{key:"set",value:function(l,o){switch(l){case"authorization_user":{this._configuration.authorization_user=String(o);break}case"password":{this._configuration.password=String(o);break}case"realm":{this._configuration.realm=String(o);break}case"ha1":{this._configuration.ha1=String(o),this._configuration.password=null;break}case"authorization_jwt":{this._configuration.authorization_jwt=String(o);break}case"display_name":{this._configuration.display_name=o;break}default:return Se.warn('set() | cannot set "%s" parameter in runtime',l),!1}return!0}},{key:"newTransaction",value:function(l){this._transactions[l.type][l.id]=l,this.emit("newTransaction",{transaction:l})}},{key:"destroyTransaction",value:function(l){delete this._transactions[l.type][l.id],this.emit("transactionDestroyed",{transaction:l})}},{key:"newDialog",value:function(l){this._dialogs[l.id]=l}},{key:"destroyDialog",value:function(l){delete this._dialogs[l.id]}},{key:"newMessage",value:function(l,o){this._applicants[l]=l,this.emit("newMessage",o)}},{key:"newOptions",value:function(l,o){this._applicants[l]=l,this.emit("newOptions",o)}},{key:"destroyMessage",value:function(l){delete this._applicants[l]}},{key:"newRTCSession",value:function(l,o){this._sessions[l.id]=l,this.emit("newRTCSession",o)}},{key:"destroyRTCSession",value:function(l){delete this._sessions[l.id]}},{key:"registered",value:function(l){this.emit("registered",l)}},{key:"unregistered",value:function(l){this.emit("unregistered",l)}},{key:"registrationFailed",value:function(l){this.emit("registrationFailed",l)}},{key:"receiveRequest",value:function(l){var o=l.method;if(l.ruri.user!==this._configuration.uri.user&&l.ruri.user!==this._contact.uri.user){Se.debug("Request-URI does not point to us"),l.method!==qe.ACK&&l.reply_sl(404);return}if(l.ruri.scheme===qe.SIPS){l.reply_sl(416);return}if(!Ya.checkTransaction(this,l)){if(o===qe.INVITE?new Ya.InviteServerTransaction(this,this._transport,l):o!==qe.ACK&&o!==qe.CANCEL&&new Ya.NonInviteServerTransaction(this,this._transport,l),o===qe.OPTIONS){if(this.listeners("newOptions").length===0){l.reply(200);return}var n=new fp(this);n.init_incoming(l)}else if(o===qe.MESSAGE){if(this.listeners("newMessage").length===0){l.reply(405);return}var f=new cp(this);f.init_incoming(l)}else if(o===qe.INVITE&&!l.to_tag&&this.listeners("newRTCSession").length===0){l.reply(405);return}var h,c;if(l.to_tag)h=this._findDialog(l.call_id,l.from_tag,l.to_tag),h?h.receiveRequest(l):o===qe.NOTIFY?(c=this._findSession(l),c?c.receiveRequest(l):(Se.debug("received NOTIFY request for a non existent subscription"),l.reply(481,"Subscription does not exist"))):o!==qe.ACK&&l.reply(481);else switch(o){case qe.INVITE:if(window.RTCPeerConnection)if(l.hasHeader("replaces")){var p=l.replaces;h=this._findDialog(p.call_id,p.from_tag,p.to_tag),h?(c=h.owner,c.isEnded()?l.reply(603):c.receiveRequest(l)):l.reply(481)}else c=new up(this),c.init_incoming(l);else Se.warn("INVITE received but WebRTC is not supported"),l.reply(488);break;case qe.BYE:l.reply(481);break;case qe.CANCEL:c=this._findSession(l),c?c.receiveRequest(l):Se.debug("received CANCEL request for a non existent session");break;case qe.ACK:break;case qe.NOTIFY:this.emit("sipEvent",{event:l.event,request:l}),l.reply(200);break;default:l.reply(405);break}}}},{key:"_findSession",value:function(l){var o=l.call_id,n=l.from_tag,f=l.to_tag,h=o+n,c=this._sessions[h],p=o+f,g=this._sessions[p];return c||g||null}},{key:"_findDialog",value:function(l,o,n){var f=l+o+n,h=this._dialogs[f];return h||(f=l+n+o,h=this._dialogs[f],h||null)}},{key:"_loadConfig",value:function(l){try{Xa.load(this._configuration,l)}catch(p){throw p}this._configuration.display_name===0&&(this._configuration.display_name="0"),this._configuration.instance_id||(this._configuration.instance_id=ll.newUUID()),this._configuration.jssip_id=ll.createRandomToken(5);var o=this._configuration.uri.clone();o.user=null,this._configuration.hostport_params=o.toString().replace(/^sip:/i,"");try{this._transport=new $w(this._configuration.sockets,{max_interval:this._configuration.connection_recovery_max_interval,min_interval:this._configuration.connection_recovery_min_interval}),this._transport.onconnecting=qw.bind(this),this._transport.onconnect=Ww.bind(this),this._transport.ondisconnect=Gw.bind(this),this._transport.ondata=Kw.bind(this)}catch(p){throw Se.warn(p),new Hw.ConfigurationError("sockets",this._configuration.sockets)}if(delete this._configuration.sockets,this._configuration.authorization_user||(this._configuration.authorization_user=this._configuration.uri.user),!this._configuration.registrar_server){var n=this._configuration.uri.clone();n.user=null,n.clearParams(),n.clearHeaders(),this._configuration.registrar_server=n}this._configuration.no_answer_timeout*=1e3,this._configuration.contact_uri?this._configuration.via_host=this._configuration.contact_uri.host:this._configuration.contact_uri=new jw("sip",ll.createRandomToken(8),this._configuration.via_host,null,{transport:"ws"}),this._contact={pub_gruu:null,temp_gruu:null,uri:this._configuration.contact_uri,toString:function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=g.anonymous||null,C=g.outbound||null,w="<";return v?w+=this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":w+=this.pub_gruu||this.uri.toString(),C&&(v?!this.temp_gruu:!this.pub_gruu)&&(w+=";ob"),w+=">",w}};var f=["authorization_user","password","realm","ha1","authorization_jwt","display_name","register"];for(var h in this._configuration)Object.prototype.hasOwnProperty.call(this._configuration,h)&&(f.indexOf(h)!==-1?Object.defineProperty(this._configuration,h,{writable:!0,configurable:!1}):Object.defineProperty(this._configuration,h,{writable:!1,configurable:!1}));Se.debug("configuration parameters after validation:");for(var c in this._configuration)if(Object.prototype.hasOwnProperty.call(Xa.settings,c))switch(c){case"uri":case"registrar_server":Se.debug("- ".concat(c,": ").concat(this._configuration[c]));break;case"password":case"ha1":case"authorization_jwt":Se.debug("- ".concat(c,": NOT SHOWN"));break;default:Se.debug("- ".concat(c,": ").concat(JSON.stringify(this._configuration[c])))}}},{key:"C",get:function(){return Ge}},{key:"status",get:function(){return this._status}},{key:"contact",get:function(){return this._contact}},{key:"configuration",get:function(){return this._configuration}},{key:"transport",get:function(){return this._transport}}]),r}(Lw);function qw(t){this.emit("connecting",t)}function Ww(t){this._status!==Ge.STATUS_USER_CLOSED&&(this._status=Ge.STATUS_READY,this._error=null,this.emit("connected",t),this._dynConfiguration.register&&this._registrator.register())}function Gw(t){for(var e=["nict","ict","nist","ist"],r=0,i=e;r<i.length;r++){var l=i[r];for(var o in this._transactions[l])Object.prototype.hasOwnProperty.call(this._transactions[l],o)&&this._transactions[l][o].onTransportError()}this.emit("disconnected",t),this._registrator.onTransportClosed(),this._status!==Ge.STATUS_USER_CLOSED&&(this._status=Ge.STATUS_NOT_READY,this._error=Ge.NETWORK_ERROR)}function Kw(t){var e=t.transport,r=t.message;if(r=Vw.parseMessage(r,this),!!r&&!(this._status===Ge.STATUS_USER_CLOSED&&r instanceof Ja.IncomingRequest)&&Bw(r,this,e)){if(r instanceof Ja.IncomingRequest)r.transport=e,this.receiveRequest(r);else if(r instanceof Ja.IncomingResponse){var i;switch(r.method){case qe.INVITE:i=this._transactions.ict[r.via_branch],i&&i.receiveResponse(r);break;case qe.ACK:break;default:i=this._transactions.nict[r.via_branch],i&&i.receiveResponse(r);break}}}}function Qw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dp(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Yw(t,e,r){return e&&dp(t.prototype,e),r&&dp(t,r),t}var Jw=ze,Xw=Yt(),it=new Jw("WebSocketInterface"),Zw=function(){function t(e){Qw(this,t),it.debug('new() [url:"%s"]',e),this._url=e,this._sip_uri=null,this._via_transport=null,this._ws=null;var r=Xw.parse(e,"absoluteURI");if(r===-1)throw it.warn("invalid WebSocket URI: ".concat(e)),new TypeError("Invalid argument: ".concat(e));if(r.scheme!=="wss"&&r.scheme!=="ws")throw it.warn("invalid WebSocket URI scheme: ".concat(r.scheme)),new TypeError("Invalid argument: ".concat(e));this._sip_uri="sip:".concat(r.host).concat(r.port?":".concat(r.port):"",";transport=ws"),this._via_transport=r.scheme.toUpperCase()}return Yw(t,[{key:"connect",value:function(){if(it.debug("connect()"),this.isConnected()){it.debug("WebSocket ".concat(this._url," is already connected"));return}else if(this.isConnecting()){it.debug("WebSocket ".concat(this._url," is connecting"));return}this._ws&&this.disconnect(),it.debug("connecting to WebSocket ".concat(this._url));try{this._ws=new WebSocket(this._url,"sip"),this._ws.binaryType="arraybuffer",this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onmessage=this._onMessage.bind(this),this._ws.onerror=this._onError.bind(this)}catch(r){this._onError(r)}}},{key:"disconnect",value:function(){it.debug("disconnect()"),this._ws&&(this._ws.onopen=function(){},this._ws.onclose=function(){},this._ws.onmessage=function(){},this._ws.onerror=function(){},this._ws.close(),this._ws=null)}},{key:"send",value:function(r){return it.debug("send()"),this.isConnected()?(this._ws.send(r),!0):(it.warn("unable to send message, WebSocket is not open"),!1)}},{key:"isConnected",value:function(){return this._ws&&this._ws.readyState===this._ws.OPEN}},{key:"isConnecting",value:function(){return this._ws&&this._ws.readyState===this._ws.CONNECTING}},{key:"_onOpen",value:function(){it.debug("WebSocket ".concat(this._url," connected")),this.onconnect()}},{key:"_onClose",value:function(r){var i=r.wasClean,l=r.code,o=r.reason;it.debug("WebSocket ".concat(this._url," closed")),i===!1&&it.debug("WebSocket abrupt disconnection"),this.ondisconnect(!i,l,o)}},{key:"_onMessage",value:function(r){var i=r.data;it.debug("received WebSocket message"),this.ondata(i)}},{key:"_onError",value:function(r){it.warn("WebSocket ".concat(this._url," error: "),r)}},{key:"via_transport",get:function(){return this._via_transport},set:function(r){this._via_transport=r.toUpperCase()}},{key:"sip_uri",get:function(){return this._sip_uri}},{key:"url",get:function(){return this._url}}]),t}(),ic=km,e1=Ue,t1=jn,n1=nt(),r1=zw,i1=Vn(),s1=Zc(),l1=Yt(),o1=Zw,a1=tf("JsSIP");a1("version %s",ic.version);var Cr={C:e1,Exceptions:t1,Utils:n1,UA:r1,URI:i1,NameAddrHeader:s1,WebSocketInterface:o1,Grammar:l1,debug:tf,get name(){return ic.title},get version(){return ic.version}};let L=class A{constructor(){return this._isInitialized=!1,this.serverConfig={},this.account={user:null,userAuth:null,displayName:null,password:null,registerExpires:600,useSessionTimer:!1},this.constraints={audio:!0,video:!0},this.chromiumBased=[{n:"Edge",s:"edg/"},{n:"Opera",s:"opr/"},{n:"Samsung",s:"samsungbrowser/"},{n:"Yandex",s:"yabrowser/"}],this.modes={video_call_audio_answer_firefox_fix:!0,video_call_audio_answer_safari_fix:!0,ice_timeout_fix:2e3,chrome_rtp_timeout_fix:13,sbc_ha_pairs_mode:void 0,ringing_header_mode:void 0,sbc_switch_register5xx_mode:!0,cache_register_auth_mode:!0,check_remote_sdp_mode:!0},this.credentials=[],this.listeners={},this.registerExtraHeaders=null,this.jssipUA=null,this.browser="",this.browserVersion=0,this.browserName="",this.os="other",this.reconnectMin=2,this.reconnectMax=30,this.u17=void 0,this.activeCalls=0,this.wsSocket=null,this.wsOnMessage=null,this.wsPingMs=0,this.wsOrigPingMs=0,this.wsThrottlingPingMs=0,this.wsVisibility=!1,this.wsCall=!1,this.wsLog=0,this.wsPongTimeout=!0,this.wsIsThrottling=!1,this.wsPingJob=null,this.wsPingTime=null,this.wsNextPingTime=null,this.wsPongReceived=!1,this.wsPongSupported=null,this.wsPongTimeoutTime=null,this.wsPongDelays=null,this.wsPongDelaysIx=0,this.wsPongReport=0,this.wsPongReportCounter=0,this.wsPongDist=!1,this.dtmfUseWebRTC=!0,this.dtmfDuration=250,this.dtmfInterToneGap=250,this.enableAddVideo=!1,this.oauthToken=null,this.oauthTokenUseInInvite=!0,this.networkPriority=void 0,A.ac_log=console.log,A.js_log=null,A.instance===void 0&&(A.instance=this),this._detectBrowser(),this._detectOS(),this.webrtcapi=c1,this.replacedCall=null,this.codecFilter=null,this.AUDIO=Symbol("audio"),this.VIDEO=Symbol("video"),this.RECVONLY_VIDEO=Symbol("recvonly_video"),A.instance}version(){return"1.18.0"}getBrowserName(){return this.browserName}getBrowser(){return this.browser}getBrowserVersion(){return this.browserVersion}getOS(){return this.os}getWR(){return this.webrtcapi}checkAvailableDevices(){return this.getWR().checkAvailableDevices()}getServerAddress(){if(this.wsSocket===null)return null;let e=this.wsSocket.url;return e.endsWith("/")&&(e=e.slice(0,-1)),e}setOAuthToken(e,r=!0){this.oauthToken=e,this.oauthTokenUseInInvite=r,this.setRegisterExtraHeaders(this.registerExtraHeaders)}setUserAgent(e){this.u17=e}setConstraints(e,r,i){let l=this.browser,o=this.browser+"|"+this.os;if(e===null||e===l||e===o){if(A.ac_log(`AC: setConstraints ${e} ${r}  ${JSON.stringify(i)}`),r!=="audio"&&r!=="video")throw new TypeError(`Wrong type: ${r}`);this.constraints[r]=i}else A.ac_log(`AC: setConstraints ${e} - ignored, no current browser`)}setConstraint(e,r,i){if(i!=null?A.ac_log(`AC: setConstraint ${e} ${r}=${JSON.stringify(i)}`):A.ac_log(`AC: setConstraint remove ${e} ${r}`),e!=="audio"&&e!=="video")throw new TypeError(`Wrong type: ${e}`);i!=null?(this.constraints[e]===!0&&(this.constraints[e]={}),this.constraints[e][r]=i):this.constraints[e]!==!0&&this.constraints[e]!==!1&&(delete this.constraints[e][r],Object.keys(this.constraints[e]).length===0&&(this.constraints[e]=!0))}setBrowsersConstraints(e){let r=this.browser,i=this.browser+"|"+this.os;for(let l in e){if(l!==r&&l!==i)continue;let o=e[l];o.audio!==void 0&&this.setConstraints(l,"audio",o.audio),o.video!==void 0&&this.setConstraints(l,"video",o.video)}}setCodecFilter(e){e&&(A.ac_log(`AC: setCodecFilter ${JSON.stringify(e)}`),this.codecFilter=this._cf_unpack(e))}setServerConfig(e,r,i=[]){this.serverConfig={addresses:e,domain:r,iceServers:this._convertIceList(i)},A.ac_log(`AC: setServerConfig() ${JSON.stringify(this.serverConfig)}`)}setReconnectIntervals(e,r){A.ac_log(`AC: setReconnectIntervals min=${e} max=${r}`),this.reconnectMin=e,this.reconnectMax=r}setAccount(e,r,i,l){r!=null&&r.length!==0||(r=void 0),l!=null&&l.length!==0||(l=e);let o=this.account;o.user=e,o.displayName=r,o.password=i,o.authUser=l}setRegisterExpires(e){A.ac_log(`AC: setRegisterExpires=${e}`),this.account.registerExpires=e}setUseSessionTimer(e){A.ac_log(`AC: setUseSessionTimer=${e}`),this.account.useSessionTimer=e}setDtmfOptions(e,r=null,i=null){A.ac_log(`AC: setDtmfOptions useWebRTC=${e} duration=${r} interToneGap=${i}`),this.dtmfUseWebRTC=e,r!==null&&(this.dtmfDuration=r),i!==null&&(this.dtmfInterToneGap=i)}setEnableAddVideo(e){A.ac_log(`AC: setEnableAddVideo=${e}`),this.enableAddVideo=e}getEnableAddVideo(){return this.enableAddVideo}getAccount(){return this.account}setListeners(e){A.ac_log("AC: setListeners()");for(let r of["loginStateChanged","outgoingCallProgress","callTerminated","callConfirmed","callShowStreams","incomingCall","callHoldStateChanged"])if(!(r in e))throw new Error(`${r} listener is missed`);this.listeners=e}static getSessionStatusName(e){switch(e){case 0:return"NULL (0)";case 1:return"INVITE_SENT (1)";case 2:return"1XX_RECEIVED (2)";case 3:return"INVITE_RECEIVED (3)";case 4:return"WAITING_FOR_ANSWER (4)";case 5:return"ANSWERED (5)";case 6:return"WAITING_FOR_ACK (6)";case 7:return"CANCELED (7)";case 8:return"TERMINATED (8)";case 9:return"CONFIRMED (9)";default:return"Unknown ("+e+")"}}setAcLogger(e){A.ac_log=e}setJsSipLogger(e){A.js_log=e}isInitialized(){return this._isInitialized}setModes(e={}){A.ac_log(`AC: setModes() ${JSON.stringify(e)}`),Object.assign(this.modes,e),this._normalizeModes()}_normalizeModes(){function e(i,l){return typeof i=="number"&&i<=l?void 0:i}let r=this.modes;r.sbc_ha_pairs_mode=e(r.sbc_ha_pairs_mode,0),r.chrome_rtp_timeout_fix=e(r.chrome_rtp_timeout_fix,0)}init(e=!0){if(A.ac_log(`AC: init() autoLogin=${e}`),this._isInitialized)return;this._isInitialized=!0,Cr.debug.enable("JsSIP:*"),Cr.debug.formatArgs=function(){A.js_log&&(this.log=A.js_log)};let r=[];for(let l of this.serverConfig.addresses)l instanceof Array?r.push({socket:new Cr.WebSocketInterface(l[0]),weight:l[1]}):r.push(new Cr.WebSocketInterface(l));let i={sockets:r,uri:"sip:"+this.account.user+"@"+this.serverConfig.domain,contact_uri:"sip:"+this.account.user+"@"+this._randomToken(12)+".invalid;transport=ws",authorization_user:this.account.authUser,password:this.account.password,register:e,session_timers:this.account.useSessionTimer,register_expires:this.account.registerExpires,user_agent:this.u17,connection_recovery_min_interval:this.reconnectMin,connection_recovery_max_interval:this.reconnectMax};this.account.displayName&&this.account.displayName.length>0&&(i.display_name=this.account.displayName),this.jssipUA=new Cr.UA(i),this.setRegisterExtraHeaders(this.registerExtraHeaders),this._setUACallbacks(),A.ac_log(`AC: applied SDK modes: ${JSON.stringify(this.modes,(l,o)=>o===void 0?"<undefined>":o)}`),this.jssipUA.modes=this.modes;for(let l of this.credentials)this.jssipUA.addCredential(l);this.credentials=[],this.jssipUA.start()}deinit(){this._isInitialized=!1,this.jssipUA&&this.jssipUA.stop()}setRegisterExtraHeaders(e){if(this.registerExtraHeaders=e,this.jssipUA){let r=e!==null?e:[];this.oauthToken!==null&&(r=r.slice()).push(`Authorization: Bearer ${this.oauthToken}`),this.jssipUA.registrator().setExtraHeaders(r)}}getRegisterExtraHeaders(){return this.registerExtraHeaders}login(){A.ac_log("AC: login()"),this.jssipUA.register()}logout(){A.ac_log("AC: logout()"),this.jssipUA.isRegistered()&&this.jssipUA.unregister()}switchSBC(e=!0){return A.ac_log("AC: switchSBC()"),this.jssipUA.switchSBC(e)}getNumberOfSBC(){return this.jssipUA.getNumberOfSBC()}setWebSocketKeepAlive(e,r=!0,i=!0,l=0,o=!1){if(A.ac_log(`AC: setWebSocketKeepAlive pingInterval=${e} pongTimeout=${r} timerThrottlingBestEffort=${JSON.stringify(i)} pongReport=${l} pongDist=${o}`),typeof e!="number"||typeof r!="boolean")throw new TypeError("setWebSocketKeepAlive: wrong type of first or second argument");let n;this.wsPingMs=this.wsOrigPingMs=1e3*e,this.wsPongTimeout=r,this.wsPongReport=l,this.wsPongDist=o,this.wsPongReportCounter=0,this.wsIsThrottling=!1;let f=(n=i===!0?{log:0,chrome:{interval:1,visibility:!0,call:!0,log:1}}:i===!1?{log:0}:i)[this.browser];this.wsThrottlingPingMs=f&&f.interval!==void 0?1e3*f.interval:0,this.wsVisibility=!(!f||f.visibility===void 0)&&f.visibility,this.wsCall=!(!f||f.call===void 0)&&f.call,this.wsLog=f&&f.log!==void 0?f.log:n.log,this.wsPongDelays=new Array(this.wsPongReport>0?this.wsPongReport:50),this.wsPongDelaysIx=0,this.wsOrigPingMs!==0&&this.wsThrottlingPingMs!==0&&this.wsVisibility&&document.addEventListener("visibilitychange",this._onVisibilityChange.bind(this))}_pingLog(){return` (ping=${this.wsPingMs/1e3} sec)`}_visibilityLog(e){let r="AC: keep-alive: Page is "+(document.hidden?"hidden":"visible");document.hidden&&(this.wsCall&&(r+=", "+(this.activeCalls===0?"no active call":"active call")),r+=" and "+(this.wsIsThrottling?"was":"was not")+" trottling"),e&&(r+=this._pingLog()),A.ac_log(r)}_activeCallsLog(e){let r=`AC: keep-alive: ${this.activeCalls===0?"Call ended":"Call started"}`;this.activeCalls===0&&(this.wsVisibility&&(r+=", page is "+(document.hidden?"hidden":"visible")),r+=" and "+(this.wsIsThrottling?"was":"was not")+" trottling"),e&&(r+=this._pingLog()),A.ac_log(r)}_onActiveCallsChange(e){if(this.activeCalls+=e,this.wsCall&&this.wsPingMs!==0&&this.wsThrottlingPingMs!==0){if(this.activeCalls<0&&A.ac_log("Warning: keep-alive: activeCalls < 0"),this.activeCalls===0){if((!this.wsVisibility||document.hidden)&&this.wsIsThrottling&&this.wsPingMs<this.wsThrottlingPingMs)return this.wsPingMs=this.wsThrottlingPingMs,void this._activeCallsLog(!0);this.wsLog>=2&&this._activeCallsLog(!1)}else if(this.activeCalls===1&&e>0){if(this.wsPingMs>this.wsOrigPingMs)return this.wsPingMs=this.wsOrigPingMs,void this._activeCallsLog(!0);this.wsLog>=2&&this._activeCallsLog(!1)}}}_onVisibilityChange(){if(this.wsVisibility&&this.wsPingMs!==0&&this.wsThrottlingPingMs!==0)if(document.hidden){if(this.wsCall&&this.activeCalls===0&&this.wsIsThrottling&&this.wsPingMs<this.wsThrottlingPingMs)return this.wsPingMs=this.wsThrottlingPingMs,void this._visibilityLog(!0);this.wsLog>=2&&this._visibilityLog(!1)}else{if(this.wsPingMs>this.wsOrigPingMs)return this.wsPingMs=this.wsOrigPingMs,void this._visibilityLog(!0);this.wsLog>=2&&this._visibilityLog(!1)}}_onMessageHook(e){e.data===`\r
`?this._onPong():this.wsOnMessage(e)}_onPong(){let e;this.wsPongReceived=!0,this.wsPongSupported===null&&(A.ac_log("AC: keep-alive: Server supports CRLF pong"),this.wsPongSupported=!0),this.wsPongTimeoutTime!==null?(e=Date.now()-this.wsPongTimeoutTime,this.wsPongTimeoutTime=null,A.ac_log(`AC: keep-alive: Received pong that exceeded the timeout, delay=${e}`)):e=Date.now()-this.wsPingTime;let r=this.wsPingMs-e;r<0&&(A.ac_log(`AC: nextPing calculated to ${r}ms, so resetting to 0ms.`),r=0),this.wsPingJob!==null&&clearTimeout(this.wsPingJob),this.wsPingJob=setTimeout(this._sendPing.bind(this),r),this.wsPongDelays[this.wsPongDelaysIx]=e,this.wsPongDelaysIx=this.wsPongDelaysIx+1,this.wsPongDelaysIx===this.wsPongDelays.length&&(this.wsPongDelaysIx=0),this.wsPongReport>0&&this.wsPongReportCounter++}_onPongTimeout(e){if(A.ac_log(`AC: keep-alive: Pong timeout (not received within ${e/1e3} seconds)`),A.ac_log(`AC: keep-alive: Previous pongs statistics: ${this._createPongReport(!0)}`),this.wsPongTimeout){A.ac_log("AC: keep-alive: Close websocket connection"),this._stopWsKeepAlive();try{this.wsSocket.close()}catch(r){A.ac_log("AC: Close websocket error",r)}}else A.ac_log("AC: keep-alive: Warning: websocket is not closed, because pongTimeout=false")}_sendPing(){try{let e=Date.now();if(this.wsPingTime!==null){let r=e-this.wsNextPingTime;this.wsLog>=3&&A.ac_log(`AC: keep-alive: timer deviation (ms): ${r}`);let i=this.wsPingMs;if(Math.abs(r)>=1e4&&((this.wsLog>0||!this.wsIsThrottling)&&(A.ac_log(`AC: keep-alive detected timer throttling: ${Math.round(r/1e3)} seconds ${r>0?"later":"earlier"}`),this.wsLog===0&&A.ac_log("AC: keep-alive: The next timer throttling will not be shown in the logs, because log==0")),this.wsIsThrottling=!0,this.wsPingMs<this.wsThrottlingPingMs&&(this.wsPingMs=this.wsThrottlingPingMs,A.ac_log(`AC: keep-alive: ping interval increased ${this._pingLog()}`))),this.wsPongSupported!==null||this.wsPongReceived||(A.ac_log("AC: keep-alive: Server does not support CRLF pong."),this.wsPongSupported=!1),this.wsPongSupported&&!this.wsPongReceived&&this.wsPongTimeoutTime===null){if(this._onPongTimeout(i),this.wsPongTimeout)return;this.wsPongTimeoutTime=this.wsPingTime}}this.wsPingTime=e,this.wsNextPingTime=this.wsPingTime+this.wsPingMs,this.wsPongReceived=!1,this.wsSocket.readyState===WebSocket.OPEN?this.wsSocket.send(`\r
\r
`):A.ac_log(`AC: keep-alive: Warning: Cannot send Ping, websocket state=${this.wsSocket.readyState}`),this.wsPingJob=setTimeout(this._sendPing.bind(this),this.wsPingMs),this.wsPongReport>0&&this.wsPongReportCounter>=this.wsPongReport&&(this.wsPongReportCounter=0,A.ac_log(`AC: keep-alive: Pong statistics: ${this._createPongReport(this.wsPongDist)}`))}catch(e){A.ac_log("AC: keep-alive: send ping error",e)}}_startWsKeepAlive(e){this.wsSocket=e,this.wsPingMs!==0&&(this.wsOnMessage=e.onmessage,e.onmessage=this._onMessageHook.bind(this),this._stopWsKeepAlive(),this.wsPingTime=null,this.wsPingJob=setTimeout(this._sendPing.bind(this),this.wsPingMs))}_stopWsKeepAlive(){this.wsPingJob!==null&&(clearTimeout(this.wsPingJob),this.wsPingJob=null)}_createPongReport(e){let r,i="",l=!1,o=1e6,n=0;e&&(r=new Array(this.wsPingMs/1e3*4).fill(0));let f=0;for(let h=0;h<this.wsPongDelays.length;h++){let c=this.wsPongDelays[h];if(c!==void 0&&(f++,c<o&&(o=c),c>n&&(n=c),e)){let p=Math.floor(c/250);p>=r.length&&(p=r.length-1,l=!0),r[p]++}}if(e){i=`\r
pongs distribution (1/4 second step): `;for(let h=0;h<r.length;h++)i+=r[h].toString(),h!==r.length-1&&(i+=(h+1)%4==0?",":" ");l&&(i+=" (+)")}return`pongs=${f} delay=${o}..${n} ms${i}`}_setUACallbacks(){this.jssipUA.on("connected",e=>{A.ac_log('AC>>: loginStateChanged: isLogin=false "connected"'),this._startWsKeepAlive(e.socket.socket._ws),this.listeners.loginStateChanged(!1,"connected",null)}),this.jssipUA.on("disconnected",()=>{this._stopWsKeepAlive(),A.ac_log('AC>>: loginStateChanged: isLogin=false "disconnected"'),this.listeners.loginStateChanged(!1,"disconnected",null)}),this.jssipUA.on("registered",e=>{A.ac_log('AC>>: loginStateChanged: isLogin=true "login"'),this.listeners.loginStateChanged(!0,"login",e.response)}),this.jssipUA.on("unregistered",e=>{A.ac_log('AC>>: loginStateChanged: isLogin=false "logout"'),this.listeners.loginStateChanged(!1,"logout",e.response)}),this.jssipUA.on("registrationFailed",e=>{let r=e.response?e.response.status_code:0;if(r>=300&&r<400){let i=e.response.parseHeader("contact");if(i){let l=i.uri,o="wss://"+l.host;if(l.port&&l.port!==443&&(o+=":"+l.port.toString()),A.ac_log(`AC: registerRedirect("${o}")`),this.jssipUA.registerRedirect(o))return}else A.ac_log('AC: 3xx response without "Contact" is ignored')}else if(r>=500&&r<600&&A.instance.modes.sbc_switch_register5xx_mode&&A.instance.switchSBC(!1))return;A.ac_log('AC>>: loginStateChanged: isLogin=false "login failed"'),this.listeners.loginStateChanged(!1,"login failed",e.response?e.response:null)}),this.listeners.incomingMessage&&this.jssipUA.on("newMessage",e=>{e.originator==="remote"&&(A.ac_log("AC>>: incomingMessage",e),this.listeners.incomingMessage(null,A.instance._get_from(e.request),A.instance._get_content_type(e.request),e.request.body,e.request))}),this.listeners.incomingNotify&&this.jssipUA.on("sipEvent",e=>{A.ac_log("AC>>: incoming out of dialog NOTIFY",e),this.listeners.incomingNotify(null,e.event?e.event.event:null,A.instance._get_from(e.request),A.instance._get_content_type(e.request),e.request.body,e.request)||e.request.reply(481)}),this.listeners.incomingSubscribe&&this.jssipUA.on("newSubscribe",e=>{let r=e.request,i=r.parseHeader("event"),l=r.getHeaders("accept");A.ac_log("AC>>: incomingSubscribe",r,i.event,l);let o=this.listeners.incomingSubscribe(r,i.event,l);o>0&&r.reply(o)}),this.jssipUA.on("newRTCSession",function(e){A.ac_log(`AC: event ${e.originator==="remote"?"incoming":"outgoing"} "newRTCSession"`,e);let r,i=new u1(e.session);if(i.js_session.on("sipEvent",function(l){if(!A.instance.listeners.incomingNotify)return;let o=this.data.ac_session;A.ac_log("AC>>: incoming NOTIFY",o,l),l.taken=A.instance.listeners.incomingNotify(o,l.event?l.event.event:null,A.instance._get_from(l.request),A.instance._get_content_type(l.request),l.request.body,l.request)}),i.js_session.on("newInfo",function(l){if(!A.instance.listeners.incomingInfo||l.originator==="local")return;let o=this.data.ac_session;A.ac_log("AC>>: incoming INFO",o,l),A.instance.listeners.incomingInfo(o,A.instance._get_from(l.request),A.instance._get_content_type(l.request),l.request.body,l.request)}),i.js_session.on("replaces",function(l){A.instance.replacedCall=this.data.ac_session,A.ac_log("AC>>: incoming INVITE with Replaces. This call will be replaced:",this.data.ac_session),l.accept()}),i.js_session.on("sdp",function(l){A.instance._sdp_checking(this,l)}),i.js_session.on("connecting",function(l){A.ac_log("AC>>: connecting");let o=A.instance.codecFilter;o&&(A.instance._cf_filter("audio",this.data.ac_session,o.audio),A.instance._cf_filter("video",this.data.ac_session,o.video))}),i.js_session.on("reinvite",function(l){if(!A.instance.listeners.callIncomingReinvite)return;let o=this.data.ac_session;A.ac_log("AC>>: callIncomingReinvite start"),A.instance.listeners.callIncomingReinvite(o,!0,l.request),l.callback=function(){A.ac_log("AC>>: callIncomingIncomingReinvite end"),A.instance.listeners.callIncomingReinvite(o,!1,null)}}),i.js_session.on("hold",function(l){let o=this.data.ac_session,n=l.originator==="remote";A.ac_log(`AC>>: callHoldStateChanged isHold=true isRemote=${n} session:`,o),A.instance.listeners.callHoldStateChanged(o,!0,n)}),i.js_session.on("unhold",function(l){let o=this.data.ac_session,n=l.originator==="remote";A.ac_log(`AC>>: callHoldStateChanged isHold=false isRemote=${n} session:`,o),A.instance.listeners.callHoldStateChanged(o,!1,n)}),i.js_session.on("progress",function(l){if(l.originator==="remote"){let o=this.data.ac_session;A.ac_log("AC>>: outgoingCallProgress",o),A.instance.listeners.outgoingCallProgress(o,l.response)}}),i.js_session.on("failed",function(l){let o=this.data.ac_session,n=null;if(l.cause==="Redirected"&&l.message&&l.message.headers){let f=l.message.parseHeader("Contact");f&&(n=f.uri.toString())}A.ac_log("AC>>: callTerminated (failed)",o,l.cause,n),A.instance.listeners.callTerminated(o,l.message,l.cause,n)}),i.js_session.on("accepted",function(l){let o=this.data.ac_session;o.data._accepted=!0,l.originator==="remote"&&(o.data._ok_response=l.response)}),e.originator==="remote"&&A.instance.replacedCall!==null&&i.js_session.removeAllListeners("confirmed"),i.js_session.on("confirmed",function(){let l,o=this.data.ac_session,n=null;"_ok_response"in o.data?(n=o.data._ok_response,delete o.data._ok_response,l="ACK sent"):l="ACK received",i.data._video_call_audio_answer_firefox&&(i.data._video_call_audio_answer_firefox=!1,A.ac_log("AC: [video call/audio answer] Firefox workaround. Send re-INVITE"),i.sendReInvite({showStreams:!0})),A.ac_log("AC>>: callConfirmed",o,l),A.instance._onActiveCallsChange.call(A.instance,1),A.instance.listeners.callConfirmed(o,n,l)}),i.js_session.on("ended",function(l){let o=this.data.ac_session;o.data._screenSharing&&o._onEndedScreenSharing.call(o,"call terminated"),A.ac_log("AC>>: callTerminated (ended)",o,l.cause),A.instance._onActiveCallsChange.call(A.instance,-1),A.instance.listeners.callTerminated(o,l.message,l.cause)}),i.js_session.on("refer",function(l){if(A.instance.listeners.transfereeCreatedCall){let o=this.data.ac_session;if(!A.instance.listeners.transfereeRefer||A.instance.listeners.transfereeRefer(o,l.request)){let n;A.ac_log("AC>>: incoming REFER accepted"),n=o.isScreenSharing()?o.doesScreenSharingReplaceCamera():o.hasSendVideo();let f=A.instance._callOptions(n,!0);l.accept(h=>{h.data._created_by_refer=o},f)}else A.ac_log("AC>>: incoming REFER rejected"),l.reject()}else A.ac_log("AC>>: incoming REFER rejected, because transfereeCreatedCall is not set"),l.reject()}),i._setEnabledReceiveVideo(A.instance.enableAddVideo),i.js_session.connection?(A.instance._set_connection_listener(i),A.ac_log('AC: connection exists, set "track" listener')):(A.ac_log("AC: peer connection does not exist, wait creation"),i.js_session.on("peerconnection",()=>{A.instance._set_connection_listener(i),A.ac_log('AC: [event connection] connection created, set "track" listener')})),r=e.originator==="remote"?e.request.from:e.request.to,i.data._user=r.uri.user,i.data._host=r.uri.host,i.data._display_name=r.display_name,i.data._create_time=new Date,e.originator==="remote"){let l,o,n,f=null;A.instance.replacedCall!==null&&(f=A.instance.replacedCall,A.instance.replacedCall=null),e.request.body?(n=!0,[l,o]=new hp(e.request.body).getMediaDirection("video",!0)):(n=!1,i.data._incoming_invite_without_sdp=!0,l=o=!0,A.ac_log("AC: warning incoming INVITE without SDP")),i._setVideoState(l,o),A.ac_log(`AC>>: incomingCall ${i.hasVideo()?"video":"audio"} from "${i.data._display_name}" ${i.data._user}`,i,f),A.instance.listeners.incomingCall(i,e.request,f,n)}else i.js_session.data._created_by_refer?(A.ac_log("AC>>: outgoing call created by REFER"),i.data._created_by_refer=i.js_session.data._created_by_refer,A.instance.listeners.transfereeCreatedCall(i)):A.ac_log("AC>>: outgoing call created by phone.call()")})}_get_from(e){return{user:e.from.uri.user,host:e.from.uri.host,displayName:e.from.display_name?e.from.display_name:null}}_get_content_type(e){let r=e.headers["Content-Type"];return r&&r.length>0?r[0].parsed:null}_set_connection_listener(e){A.instance.getWR().connection.addEventListener(e.js_session.connection,"track",r=>{if(A.ac_log(`AC>>: "track" event kind= ${r.track.kind}`,r),r.streams.length>0){let o=r.streams[0];A.ac_log(`AC: set call remote stream id=${o.id}`,e),e.data._remoteMediaStream=o}else A.ac_log('AC: Warning "track" event without stream');if(r.track.kind==="video"){if(!e.hasEnabledReceiveVideo()){e.data._video_call_audio_answer_safari&&(r.track.onmute=()=>{A.ac_log('AC: [video call/audio answer] Safari fix. Fired video track "mute" event.  Call callShowStream'),r.track.onmute=null;let n=e.getRTCLocalStream(),f=e.getRTCRemoteStream();A.ac_log("AC>>: callShowStreams",e,n,f),A.instance.listeners.callShowStreams(e,n,f)},A.ac_log('AC: [video call/audio answer] Safari fix. Set video track "mute" event listener'),e.data._video_call_audio_answer_safari=!1),A.ac_log('AC>>: event "track" video and !hasEnabledReceiveVideo therefore change transceiver direction.',e);let o=A.instance.getWR().connection.getTransceiver(e.js_session.connection,"video");if(o!==null){let n=e.hasEnabledSendVideo()?"sendonly":"inactive";A.instance.getWR().transceiver.setDirection(o,n)}}return void(A.instance.codecFilter&&A.instance._cf_filter("video",e,A.instance.codecFilter.video))}let i=e.getRTCLocalStream(),l=e.getRTCRemoteStream();A.ac_log("AC>>: callShowStreams",e,i,l),A.instance.listeners.callShowStreams(e,i,l)})}_check_remote_sdp(e,r){try{r.codec_map||(r.codec_map={});let i=e.getMedia("audio");A.instance._check_remote_m(i,r.codec_map);let l=e.getMedia("video");l&&A.instance._check_remote_m(l,r.codec_map)}catch(i){A.ac_log("AC:SDP exception",i)}}_check_remote_m(e,r){let i={};function l(o,n){let f=n.indexOf(" ",o);return f===-1?["?","?"]:[n.substring(o,f),n.substring(f+1).toLowerCase()]}for(let o of e)if(o.startsWith("a=rtpmap:")){let[n,f]=l(9,o);i[n]||(i[n]={}),i[n].rtpmap=f}else if(o.startsWith("a=fmtp:")){let[n,f]=l(7,o);i[n]||(i[n]={}),i[n].fmtp=f}for(let o of Object.keys(i))if(r[o])i[o].rtpmap===r[o].rtpmap?i[o].fmtp!==r[o].fmtp&&A.ac_log(`AC:SDP [The same payload type and codec name, different fmtp] pt=${o} rtpmap=${i[o].rtpmap} fmtp=${i[o].fmtp}, previously was fmtp=${r[o].fmtp}`):(parseInt(o)>=64||i[o].rtpmap&&r[o].rtpmap)&&A.ac_log(`AC:SDP [The same payload type, different codec names] pt=${o} rtpmap=${i[o].rtpmap}, previously was rtpmap=${r[o].rtpmap}`);else{let n,f=i[o];for(let[h,c]of Object.entries(r))if(f.rtpmap===c.rtpmap&&f.fmtp===c.fmtp){n=h;break}if(n){let h=r[n];f.fmtp||h.fmtp?A.ac_log(`AC:SDP [The same codec name used with different payload types] pt=${o} rtpmap=${f.rtpmap} fmtp=${f.fmtp}, previously was pt=${n} rtpmap=${h.rtpmap} fmtp=${h.fmtp}`):A.ac_log(`AC:SDP [The same codec name used with different payload types] pt=${o} rtpmap=${f.rtpmap}, previously was pt=${n} rtpmap=${h.rtpmap}`)}else r[o]=f}}_sdp_checking(e,r){let i,l,o,n=r.originator+" "+r.type,f=e.data.ac_session;try{i=new hp(r.sdp),[l,o]=i.getMediaDirection("video",r.originator==="remote")}catch(c){return void A.ac_log("AC: cannot parse SDP",c)}let h=f.data._initial;switch(r.type==="answer"&&(f.data._initial=!1),A.ac_log(`AC: Event "sdp" ${h?"initial":""} ${n}   Session state:${A.getSessionStatusName(e._status)}`),n){case"remote offer":A.instance.modes.check_remote_sdp_mode&&A.instance._check_remote_sdp(i,e.data);break;case"remote answer":if(A.instance.modes.check_remote_sdp_mode&&A.instance._check_remote_sdp(i,e.data),f.isLocalHold()||f.isRemoteHold())break;f._setVideoState(l,o);break;case"local offer":A.instance.networkPriority&&A.instance._set_senders_dscp(e);break;case"local answer":if(f.isLocalHold()||f.isRemoteHold())break;A.instance.networkPriority&&A.instance._set_senders_dscp(e),f._setVideoState(l,o)}}_set_senders_dscp(e){if(A.instance.browser!=="chrome")return;A.ac_log("AC: _set_senders_dscp()");let r=A.instance.networkPriority;A.instance._set_dscp(e,"audio",r),A.instance._set_dscp(e,"video",r)}_set_dscp(e,r,i){let l=e.connection,o=A.instance.getWR().connection.getTransceiver(l,r);return o||r!=="video"?Promise.resolve().then(()=>{let n=o.sender.getParameters();if(!n)throw new Error("sender getParameters() returns undefined");let f=n.encodings;if(!f)throw new Error("parameters encodings is undefined");if(f.length===0)throw new Error("parameters encodings is empty array");let h=f[0].networkPriority;if(!h)throw new Error("parameters encodings networkPriority is undefined");return h===i||(f[0].networkPriority=i,o.sender.setParameters(n).then(()=>(A.ac_log(`AC: DSCP: ${r} "${i}"`),!0)))}).catch(n=>(A.ac_log(`AC: DSCP: ${r} error: ${n}`),!1)):Promise.resolve(!1)}_cf_unpack(e){function r(l,o){let n,f=o.indexOf("/"),h=o.indexOf("#");n=f!==-1?f:h!==-1?h:void 0;let c={mimeType:(l+"/"+o.substring(0,n)).toLowerCase()};return f!==-1&&(n=h!==-1?h:void 0,c.clockRate=parseInt(o.substring(f+1,n))),h!==-1&&(c.sdpFmtpLine=o.substring(h+1)),c}if(!e)return null;let i={};for(let l in e){i[l]={};for(let o in e[l])i[l][o]=e[l][o].map(n=>r(l,n))}return i}_cf_pack(e){return e.map(r=>function(i){let l=i.mimeType.substring(6).toLowerCase();return i.clockRate&&(l+="/"+i.clockRate),i.sdpFmtpLine&&(l+="#"+i.sdpFmtpLine),l}(r))}_cf_str(e){return JSON.stringify(A.instance._cf_pack(e))}_cf_match(e,r){let i=e.mimeType.toLowerCase();for(let l of r)if(l.mimeType===i){if(l.clockRate&&l.clockRate!==e.clockRate||l.sdpFmtpLine&&l.sdpFmtpLine!==e.sdpFmtpLine)continue;return!0}return!1}_cf_find(e,r){let i=[];for(let l of r){let o=l.mimeType.toLowerCase();if(e.mimeType===o){if(e.clockRate&&e.clockRate!==l.clockRate||e.sdpFmtpLine&&e.sdpFmtpLine!==l.sdpFmtpLine)continue;i.push(l)}}return i}_cf_filter(e,r,i){if(i&&!r.data[`_used_${e}_codec_filter`])try{let l=r.getRTCPeerConnection(),o=A.instance.getWR().connection.getTransceiver(l,e);if(!o)return void(e==="audio"&&A.ac_log("AC: codec-filter: cannot get audio transceiver"));if(r.data[`_used_${e}_codec_filter`]=!0,!RTCRtpSender.getCapabilities||!RTCRtpReceiver.getCapabilities||!o.setCodecPreferences)return void A.ac_log("AC: codec-filter is not supported.");let n=RTCRtpSender.getCapabilities(e).codecs,f=RTCRtpReceiver.getCapabilities(e).codecs,h=[];for(let p of f)n.findIndex(g=>p.mimeType===g.mimeType&&p.clockRate===g.clockRate&&p.sdpFmtpLine===g.sdpFmtpLine)===-1&&h.push(p);let c=n.concat(h);if(A.ac_log(`AC: ${e} codec-filter original: ${A.instance._cf_str(c)}
(receiver: ${h.length})`),i.remove&&i.remove.length>0){let p=c.length;(c=c.filter(g=>!A.instance._cf_match(g,i.remove))).length<p&&A.ac_log(`AC: ${e} codec-filter remaining: ${A.instance._cf_str(c)}`)}if(i.priority&&i.priority.length>0){let p=[];for(let g of i.priority){let v=A.instance._cf_find(g,c);v.length!==0&&(p=p.concat(v),c=c.filter(C=>!v.includes(C)))}c=p.concat(c),A.ac_log(`AC: ${e} codec-filter changed priority: ${A.instance._cf_str(c)}`)}return void o.setCodecPreferences(c)}catch(l){return void A.ac_log("AC: codec filter exception",l)}}_convertIceList(e){let r=[];for(let i of e)typeof i=="string"&&(i={urls:"stun:"+i}),r.push(i);return r}_randomToken(e){let r="";for(let i=0;i<e;i++)r+=Math.floor(36*Math.random()).toString(36);return r}_detectBrowser(){try{let e=navigator.userAgent;if(this.browser="other",this.browserName=e,this.browserVersion=0,navigator.mozGetUserMedia)this.browser="firefox",this.browserName=e.match(/Firefox\/([.\d]+)$/)[0],this.browserVersion=parseInt(e.match(/Firefox\/(\d+)\./)[1],10);else if(navigator.webkitGetUserMedia){this.browser="chrome",this.browserName=e.match(/Chrom(e|ium)\/([\d]+)/)[0],this.browserVersion=parseInt(e.match(/Chrom(e|ium)\/(\d+)\./)[2],10);let r=e.toLowerCase();for(let i=0;i<this.chromiumBased.length;i++){let l=this.chromiumBased[i].s,o=r.indexOf(l);if(o!==-1){let n=r.substring(o+l.length).match(/([.\d]+)/)[1];this.browserName+=" ("+this.chromiumBased[i].n+"/"+n+")";break}}}else window.safari?(this.browser="safari",this.browserName="Safari/"+e.match(/Version\/([.\d]+)/)[1],this.browserVersion=parseInt(e.match(/Version\/(\d+)\./)[1],10)):e.indexOf("Edge/")!==-1&&(this.browser="other",this.browserName=e.match(/Edge\/([.\d]+)/)[0],this.browserVersion=parseInt(e.match(/Edge\/(\d+).(\d+)$/)[2],10));/iPad|iPhone|iPod/.test(e)&&(this.browserName=e,e.includes("CriOS")?(this.browser="chrome",this.browserVersion=parseInt(e.match(/CriOS\/(\d+)\./)[1],10)):e.includes("FxiOS")?(this.browser="firefox",this.browserVersion=parseInt(e.match(/FxiOS\/(\d+)\./)[1],10)):(this.browser="safari",this.browserVersion=parseInt(e.match(/Version\/(\d+)\./)[1],10)))}catch(e){A.ac_log("AC: Browser detection error",e),this.browser="other",this.browserName=navigator.userAgent,this.browserVersion=0}}_detectOS(){this._detectOS1(),this.os==="other"&&this._detectOS2()}_detectOS1(){try{let e=!!navigator.userAgentData&&navigator.userAgentData.platform;if(!e)return;(e=e.toLowerCase())!=="windows"&&e!=="linux"&&e!=="android"&&e!=="macos"||(this.os=e)}catch(e){A.ac_log("AC: detectOS1 error",e),this.os="other"}}_detectOS2(){try{let e=navigator.platform;if(!e)return;(e=e.toLowerCase()).startsWith("win")?this.os="windows":e.startsWith("android")?this.os="android":e.startsWith("linux")?navigator.userAgent.includes("Android")?this.os="android":this.os="linux":e.startsWith("mac")?this.os="macos":/ipad|iphone|ipod/.test(e)&&(this.os="ios")}catch(e){A.ac_log("AC: detectOS2 error",e),this.os="other"}}_mediaConstraints(e){let r=A.instance,i={audio:r.constraints.audio};return e&&(i.video=r.constraints.video),i}_callOptions(e,r,i=null,l=null){let o={},n=A.instance;return n.browser==="chrome"&&n.networkPriority&&(o={rtcConstraints:{optional:[{googDscp:!0}]}}),l!==null&&Object.assign(o,l),o.mediaConstraints=n._mediaConstraints(e),o.pcConfig===void 0&&(o.pcConfig={}),o.pcConfig.iceServers=n.serverConfig.iceServers,i!==null&&(i=i.slice()),n.oauthToken!==null&&n.oauthTokenUseInInvite&&r&&(i===null&&(i=[]),i.push("Authorization: Bearer "+n.oauthToken)),i!==null&&(o.extraHeaders=i),o}call(e,r,i=null,l=null){if(e===!1?e=A.instance.AUDIO:e===!0&&(e=A.instance.VIDEO),typeof e!="symbol"||![A.instance.AUDIO,A.instance.VIDEO].includes(e))throw new TypeError(`Illegal videoOption=${e.toString()}`);r=r.replace(/\s+/g,""),A.ac_log(`AC: call ${e.description} to ${r}`);let o=this._callOptions(e===A.instance.VIDEO,!0,i,l),n=this.jssipUA.call(r,o);o.mediaStream&&(n._localMediaStreamLocallyGenerated=!0);let f=n.data.ac_session;return f._setEnabledSendVideo(e===A.instance.VIDEO),e===A.instance.VIDEO&&f._setEnabledReceiveVideo(!0),f}sendMessage(e,r,i="text/plain"){return A.ac_log(`AC: sendMessage to: ${e} "${r}"`),new Promise((l,o)=>{let n={contentType:i,eventHandlers:{succeeded:f=>l(f),failed:f=>o(f)}};this.jssipUA.sendMessage(e,r,n)})}isScreenSharingSupported(){return A.instance.getWR().hasDisplayMedia()}openScreenSharing(){return this.isScreenSharingSupported()?(A.ac_log("AC: openScreenSharing()"),A.instance.getWR().getDisplayMedia().then(e=>e).catch(e=>{throw A.ac_log("AC: openScreenSharing() error",e),e})):(A.ac_log("AC: openScreenSharing: screen sharing is not supported in the browser"),Promise.reject("Screen sharing is not supported"))}closeScreenSharing(e){if(A.ac_log("AC: closeScreenSharing()"),e){let r=e.getVideoTracks();if(r.length==0)return;let i=r[0];i.readyState==="live"&&(i.stop(),i.dispatchEvent(new Event("ended")))}}setNetworkPriority(e){if(A.ac_log(`AC: setNetworkPriority ${e}`),e!==void 0&&e!=="high"&&e!=="medium"&&e!=="low"&&e!=="very-low")throw new TypeError(`setNetworkPriority: illegal value: ${e}`);this.networkPriority=e}subscribe(...e){return this.jssipUA.subscribe(...e)}notify(...e){return this.jssipUA.notify(...e)}addCredential(e){if(!e.realm||!e.password||!e.username)throw new TypeError("wrong credential structure");this.credentials.push(e)}};class u1{constructor(e){this.js_session=e,this.data={_user:null,_display_name:null,_create_time:null,_initial:!0,_remoteMediaStream:null,_wasUsedSendVideo:!1,_screenSharing:null,_video:{send:!1,receive:!1,enabledSend:!1,enabledReceive:!1}},e.data.ac_session=this}getRTCPeerConnection(){return this.js_session.connection}getRTCLocalStream(){return this.js_session._localMediaStream}getRTCRemoteStream(){return this.data._remoteMediaStream}isEstablished(){return this.js_session.isEstablished()}isTerminated(){return this.js_session.isEnded()}isOutgoing(){return this.js_session.direction==="outgoing"}isAudioMuted(){return this.js_session.isMuted().audio}isVideoMuted(){return this.js_session.isMuted().video}wasAccepted(){return this.data._accepted===!0}getReplacesHeader(){if(!this.js_session.isEstablished()||!this.js_session._dialog)return L.ac_log("getReplacesHeader(): call is not established"),null;let e=this.js_session._dialog.id;return`${e.call_id};to-tag=${e.remote_tag};from-tag=${e.local_tag}`}muteAudio(e){L.ac_log(`AC: muteAudio() arg=${e} `),e?this.js_session.mute({audio:!0,video:!1}):this.js_session.unmute({audio:!0,video:!1})}muteVideo(e){L.ac_log(`AC: muteVideo() arg=${e} `),e?this.js_session.mute({audio:!1,video:!0}):this.js_session.unmute({audio:!1,video:!0})}sendDTMF(e){let r=L.instance.dtmfUseWebRTC;r&&L.instance.browser==="safari"&&L.instance.getWR().connection.getDTMFSender(this.js_session.connection)===void 0&&(r=!1),L.ac_log(`AC: sendDTMF() tone=${e} ${r?"[RFC2833]":"[INFO]"}`);let i={duration:L.instance.dtmfDuration,interToneGap:L.instance.dtmfInterToneGap,transportType:r?"RFC2833":"INFO"};this.js_session.sendDTMF(e,i)}sendInfo(e,r,i=null){L.ac_log("AC: sendInfo()",e,r,i);let l=i!==null?{extraHeaders:i}:void 0;this.js_session.sendInfo(r,e,l)}duration(){let e=this.js_session.start_time;if(!e)return 0;let r=this.js_session.end_time;return r||(r=new Date),Math.floor((r.getTime()-e.getTime())/1e3)}hasSendVideo(){return this.data._video.send}hasReceiveVideo(){return this.data._video.receive}hasVideo(){return this.hasSendVideo()&&this.hasReceiveVideo()}getVideoState(){return this.hasSendVideo()&&this.hasReceiveVideo()?"sendrecv":this.hasSendVideo()?"sendonly":this.hasReceiveVideo()?"recvonly":"inactive"}_setVideoState(e,r){L.ac_log(`AC: _setVideoState(send=${e}, receive=${r})`),this.data._video.send=e,this.data._video.receive=r}hasEnabledSendVideo(){return this.data._video.enabledSend}hasEnabledReceiveVideo(){return this.data._video.enabledReceive}getEnabledVideoState(){return this.hasEnabledSendVideo()&&this.hasEnabledReceiveVideo()?"sendrecv":this.hasEnabledSendVideo()?"sendonly":this.hasEnabledReceiveVideo()?"recvonly":"inactive"}_setEnabledSendVideo(e){L.ac_log(`AC: _setEnabledSendVideo(${e})`),this.data._video.enabledSend=e}_setEnabledReceiveVideo(e){L.ac_log(`AC: _setEnabledReceiveVideo(${e})`),this.data._video.enabledReceive=e}answer(e,r=null,i=null){if(this.data._answer_called)return void L.ac_log("AC: answer() is already called. [Ignored]");if(this.data._answer_called=!0,e===!1?e=L.instance.AUDIO:e===!0&&(e=L.instance.VIDEO),typeof e!="symbol"||![L.instance.AUDIO,L.instance.RECVONLY_VIDEO,L.instance.VIDEO].includes(e))throw new TypeError(`Illegal videoOption=${e.toString()}`);if(L.ac_log(`AC: ${e.description} answer`),this.hasVideo()||e!==L.instance.RECVONLY_VIDEO&&e!==L.instance.VIDEO||(L.ac_log('AC: incoming INVITE without video, so answer can be only "audio"'),e=L.instance.AUDIO),this.hasVideo()&&e===L.instance.AUDIO){let o=L.instance,n=o.browser,f=o.modes,h=o.browserVersion;n==="firefox"&&f.video_call_audio_answer_firefox_fix?this.data._video_call_audio_answer_firefox=!0:n==="safari"&&(f.video_call_audio_answer_safari_fix===!0&&h<14||f.video_call_audio_answer_safari_fix==="force")&&(this.data._video_call_audio_answer_safari=!0)}switch(e){case L.instance.AUDIO:this._setEnabledSendVideo(!1),this.data._incoming_invite_without_sdp?this._setEnabledReceiveVideo(L.instance.enableAddVideo):this._setEnabledReceiveVideo(!this.hasVideo()&&L.instance.enableAddVideo),this._setVideoState(!1,!1);break;case L.instance.VIDEO:this._setEnabledSendVideo(!0),this._setEnabledReceiveVideo(!0),this._setVideoState(!0,!0);break;case L.instance.RECVONLY_VIDEO:this._setEnabledSendVideo(!1),this._setEnabledReceiveVideo(!0),this._setVideoState(!1,!0)}let l=L.instance._callOptions(e===L.instance.VIDEO,!1,r,i);Promise.resolve().then(()=>l.mediaStream?l.mediaStream:L.instance.getWR().getUserMedia(l.mediaConstraints)).then(o=>{l.mediaStream=o,this.js_session._localMediaStreamLocallyGenerated=!0,L.ac_log("AC: answer options:",l),this.js_session.answer(l)}).catch(o=>{L.ac_log("AC: getUserMedia failure",o),this.reject(488)})}reject(e=486,r=null){L.ac_log("AC: reject()");try{let i={status_code:e};r&&(i.extraHeaders=r),this.js_session.terminate(i)}catch(i){L.ac_log("AC: call reject error:",i)}}terminate(){L.ac_log("AC: terminate()");try{this.js_session.terminate()}catch(e){L.ac_log("AC: call terminate error:",e)}}redirect(e,r=302,i=null){L.ac_log(`AC: redirect() callTo=${e}`);try{let l={status_code:r,extraHeaders:["Contact: "+L.instance.jssipUA.normalizeTarget(e)]};i&&l.extraHeaders.push(...i),this.js_session.terminate(l)}catch(l){L.ac_log("AC: call redirect error:",l)}}isLocalHold(){return this.js_session.isOnHold().local}isRemoteHold(){return this.js_session.isOnHold().remote}isReadyToReOffer(){return this.js_session._isReadyToReOffer()}hold(e){return L.ac_log(`AC: hold(${e})`),new Promise((r,i)=>{(e?this.js_session.hold:this.js_session.unhold).call(this.js_session,{},()=>{L.ac_log("AC: hold()/unhold() is completed"),r()})||(L.ac_log("AC: hold()/unhold() failed"),i())})}enableReceiveVideo(e){this._setEnabledReceiveVideo(e);let r=this.getRTCPeerConnection(),i=L.instance.getWR().connection.getTransceiver(r,"video");if(i!==null){let l=this.getEnabledVideoState();L.instance.getWR().transceiver.setDirection(i,l)}return L.ac_log(`AC: enableReceiveVideo(${e}) ${i!==null?"":"No video transceiver"}`),i!==null}startSendingVideo(e={}){let r=e&&e.enabledReceiveVideo!==!1;return this.hasEnabledSendVideo()?(L.ac_log("AC: startSendingVideo(). Already started"),Promise.reject("video already started")):(L.ac_log("AC: startSendingVideo()"),L.instance.getWR().getUserMedia({video:L.instance.constraints.video}).catch(i=>{throw L.ac_log("AC: startSendingVideo() getUserMedia failure",i),i}).then(i=>{let l=i.getVideoTracks()[0];this.getRTCLocalStream().addTrack(l),this._setEnabledSendVideo(!0),this._setEnabledReceiveVideo(r);let o=this.data._wasUsedSendVideo;return L.instance.getWR().connection.addVideo(this.getRTCPeerConnection(),this.getRTCLocalStream(),l,this.hasEnabledReceiveVideo(),o).then(()=>{!o&&L.instance.codecFilter&&L.instance._cf_filter("video",this,L.instance.codecFilter.video)}).catch(n=>{throw L.ac_log("AC: startSendingVideo(). Adding video error",n),n})}).then(()=>this._renegotiate(e)))}stopSendingVideo(e={}){return this.hasEnabledSendVideo()?(L.ac_log("AC: stopSendingVideo()"),L.instance.getWR().connection.removeVideo(this.getRTCPeerConnection(),this.getRTCLocalStream()).catch(r=>{throw L.ac_log("AC: stopSendingVideo(). Remove video error",r),r}).then(()=>(this._setEnabledSendVideo(!1),this.data._wasUsedSendVideo=!0,this._renegotiate(e)))):(L.ac_log("AC: stopSendingVideo(). Already stopped"),Promise.reject("video already stopped"))}_doRenegotiate(e){return this.js_session.isEnded()?Promise.reject("call is ended"):new Promise(r=>{if(!this.js_session.renegotiate(e,()=>r(!0)))return r(!1)})}_renegotiate(e,r=30,i=500){return L.ac_log(`AC: _renegotiate() attemptsLeft=${r}`),this._doRenegotiate(e).then(l=>{if(l)return L.ac_log("AC: Renegotiation success"),!0;if(r<=1)throw new Error("Too many attempts");return new Promise(o=>setTimeout(o,i)).then(()=>this._renegotiate(e,r-1,i))}).catch(l=>{throw L.ac_log("AC: Renegotiation failed",l),l})}sendReInvite(e={}){return L.ac_log("AC: sendReInvite()"),this._renegotiate(e).then(()=>{if(e.showStreams){let r=this.getRTCLocalStream(),i=this.getRTCRemoteStream();L.ac_log("AC>>: [after send re-INVITE] callShowStreams",this,r,i),L.instance.listeners.callShowStreams(this,r,i)}})}startScreenSharing(e,r={localScreenSharing:!0,enabledReceiveVideo:!0,separateVideo:!1}){if(L.ac_log("AC: startScreenSharing"),!e)return Promise.reject("missed stream argument");if(this.data._screenSharing)return Promise.reject("the call is already using screen-sharing");let i=r&&r.enabledReceiveVideo!==!1,l=e.getVideoTracks()[0],o;r.localScreenSharing&&(o=this._onEndedScreenSharingTrack.bind(this),l.addEventListener("ended",o)),this.data._screenSharing={stream:e,onended:o,hadSendVideo:this.hasSendVideo()};let n=this.data._wasUsedSendVideo;return this._setEnabledSendVideo(!0),this._setEnabledReceiveVideo(i),L.instance.getWR().connection.addVideo(this.getRTCPeerConnection(),this.getRTCLocalStream(),l,this.hasEnabledReceiveVideo(),n).then(()=>{!n&&L.instance.codecFilter&&L.instance._cf_filter("video",this,L.instance.codecFilter.video)}).catch(f=>{throw L.ac_log("AC: startScreenSharing() error",f),this.data._screenSharing=null,f}).then(()=>this._renegotiate({extraHeaders:["X-Screen-Sharing: on"]}))}stopScreenSharing(){return L.ac_log("AC: stopScreenSharing"),this.data._screenSharing?this._onEndedScreenSharing("called stopScreenSharing()"):Promise.reject("the call does not use screen-sharing")}isScreenSharing(){return!!this.data._screenSharing}doesScreenSharingReplaceCamera(){let e=this.data._screenSharing;return e&&e.hadSendVideo}_onEndedScreenSharingTrack(){return this._onEndedScreenSharing("track ended")}_onEndedScreenSharing(e){let r=this.data._screenSharing;this.data._screenSharing=null;let i=r.stream,l=r.onended;return i&&l&&i.getVideoTracks()[0].removeEventListener("ended",l),Promise.resolve().then(()=>{if(!this.isTerminated()){let o=this.getRTCPeerConnection(),n=this.getRTCLocalStream(),f={extraHeaders:["X-Screen-Sharing: off"]};return r.hadSendVideo?(L.ac_log("AC: screen sharing stopped - restore previously sending video track"),L.instance.getWR().connection.replaceSenderTrack(o,"video",n),this._renegotiate(f)):(L.ac_log("AC: screen sharing stopped - stop send video"),this.stopSendingVideo(f))}}).then(()=>{L.instance.listeners.callScreenSharingEnded&&(L.ac_log(`AC>>: callScreenSharingEnded "${e}"`,this,i),L.instance.listeners.callScreenSharingEnded(this,i))})}setRemoteHoldState(){this.js_session._remoteHold=!0}sendRefer(e,r=null){if(!L.instance.listeners.transferorNotification)throw new Error("transferorNotification listener is missed");let i=this,l={eventHandlers:{requestSucceeded(){L.ac_log("AC>>: transferorNotification progress [REFER accepted]"),L.instance.listeners.transferorNotification(i,0)},requestFailed(){L.ac_log("AC>>: transferorNotification failed [REFER failed]"),L.instance.listeners.transferorNotification(i,-1)},trying(){L.ac_log("AC>>: transferorNotification progress [NOTIFY 1xx]"),L.instance.listeners.transferorNotification(i,0)},progress(){L.ac_log("AC>>: transferorNotification progress [NOTIFY 1xx]"),L.instance.listeners.transferorNotification(i,0)},accepted(){L.ac_log("AC>>: transferorNotification success [NOTIFY 2xx]"),L.instance.listeners.transferorNotification(i,1)},failed(){L.ac_log("AC>>: transferorNotification failed [NOTIFY >= 300]"),L.instance.listeners.transferorNotification(i,-1)}}};r!==null&&(l.replaces=r.js_session),this.js_session.refer(e,l)}}class hp{constructor(e){this.start=[],this.media=[];let r=e.split(`
`).map(l=>l.trim()).filter(l=>l.length>0),i=this.start;for(let l of r)l.startsWith("m=")&&(i=[],this.media.push(i)),i.push(l)}getMedia(e){for(let r of this.media)if(r.length>0&&r[0].startsWith("m="+e))return r;return null}checkSendRecv(e){switch(e){case"a=sendrecv":return"sendrecv";case"a=sendonly":return"sendonly";case"a=recvonly":return"recvonly";case"a=inactive":return"inactive";default:return null}}getMediaDirectionValue(e){let r,i=this.getMedia(e);if(i===null)return null;let l="sendrecv";for(let o of this.start)if((r=this.checkSendRecv(o))!==null){l=r;break}for(let o of i)if((r=this.checkSendRecv(o))!==null){l=r;break}return l}getMediaDirection(e,r){let i=this.getMediaDirectionValue(e);switch(i){case"sendrecv":return[!0,!0,i];case"sendonly":return r?[!1,!0,i]:[!0,!1,i];case"recvonly":return r?[!0,!1,i]:[!1,!0,i];case null:case"inactive":return[!1,!1,i]}}toString(){let e=this.start;for(let r of this.media)e=e.concat(r);return e.join(`\r
`)+`\r
`}}let c1={getUserMedia:t=>(L.ac_log(`[webrtc] getUserMedia constraints=${JSON.stringify(t)}`),navigator.mediaDevices.getUserMedia(t)),hasDisplayMedia:()=>navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia,getDisplayMedia:()=>(L.ac_log("[webrtc] getDisplayMedia"),navigator.mediaDevices.getDisplayMedia({video:!0})),mediaDevices:{enumerateDevices:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices():Promise.reject("WebRTC is not supported"),addDeviceChangeListener(t){navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",t)},removeDeviceChangeListener(t){navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",t)}},checkAvailableDevices(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return Promise.reject("WebRTC is not supported");let t=!1,e=!1,r=!1;return navigator.mediaDevices.enumerateDevices().then(i=>(i.forEach(function(l){switch(l.kind){case"videoinput":t=!0;break;case"audioinput":e=!0;break;case"audiooutput":r=!0}}),navigator.webkitGetUserMedia===void 0&&(r=!0),r?e?Promise.resolve(t):Promise.reject("Missing a microphone! Please connect one and reload"):Promise.reject("Missing a speaker! Please connect one and reload")))},transceiver:{setDirection(t,e){let r="";t.sender.track!==null?r=t.sender.track.kind:t.receiver.track!==null&&(r=t.receiver.track.kind),L.ac_log(`[webrtc] set ${r} transceiver direction=${e}`),t.direction=e}},stream:{getInfo(t){function e(r){return r.length>0?r[0].enabled.toString():"-"}return t===null?Promise.resolve("stream is null"):Promise.resolve(`audio: ${e(t.getAudioTracks())} video: ${e(t.getVideoTracks())}`)}},connection:{getTransceiversInfo(t){function e(o){return o===null?"none":`d=${o.direction} c=${o.currentDirection}`}let r=t.getTransceivers(),i=L.instance.getWR().connection.getTransceiver(t,"audio"),l=L.instance.getWR().connection.getTransceiver(t,"video");return Promise.resolve(`(${r.length}) audio ${e(i)} video ${e(l)}`)},getTransceiver(t,e){for(let r of t.getTransceivers())if(r.sender!==null&&r.sender.track!==null&&r.sender.track.kind===e||r.receiver!==null&&r.receiver.track!==null&&r.receiver.track.kind===e)return r;return null},addEventListener:(t,e,r)=>(L.ac_log(`[webrtc] Connection addEventListener ${e}`),e!=="track"?Promise.reject(`Wrong event name: ${e}`):(t.addEventListener(e,r),Promise.resolve())),getDTMFSender(t){let e=t.getSenders().find(r=>r.track&&r.track.kind==="audio");if(e&&e.dtmf)return e.dtmf},addVideo(t,e,r,i,l){L.ac_log("[webrtc] Connection addVideo");let o=L.instance.getWR().connection.getTransceiver(t,"video");if(o!==null){let n=i?"sendrecv":"sendonly";L.instance.getWR().transceiver.setDirection(o,n)}return o===null||o.sender.track===null&&!l?(L.ac_log("[webrtc] addVideo (connection addTrack)"),t.addTrack(r,e),Promise.resolve(!0)):(L.ac_log("[webrtc] addVideo (video transceiver sender replaceTrack)"),o.sender.replaceTrack(r).then(()=>!1))},removeVideo(t,e){L.ac_log("[webrtc] Connection removeVideo");let r=L.instance.getWR().connection.getTransceiver(t,"video");if(r===null)return Promise.reject("no video transceiver found");if(t.removeTrack(r.sender),e)for(let i of e.getVideoTracks())e.removeTrack(i),i.stop();return Promise.resolve()},replaceSenderTrack(t,e,r){L.ac_log(`[webrtc] ReplaceSenderTrack ${e}`);let i=null;for(let o of t.getSenders())if(o.track!==null&&o.track.kind===e){i=o;break}if(i===null)return Promise.reject(`No ${e} sender`);let l=e==="audio"?r.getAudioTracks():r.getVideoTracks();return l.length===0?Promise.reject(`No ${e} track`):i.replaceTrack(l[0])},getStats(t,e){let r="";return t.getStats(null).then(i=>(i.forEach(l=>{if(e.includes(l.type)){r+=" {";let o=!0;for(let n of Object.keys(l))o?o=!1:r+=",",r+=n+"="+l[n];r+=`} \r
`}}),r))}}};class f1{constructor(){this.browser=this._browser(),this.speakerDeviceId=void 0,this.ringerDeviceId=void 0,this.useAudioElement=void 0,this.logger=console.log,this.sounds={},this.sound=null,this.ringer=null,this.ssound=null,this.audioCtx=null,this.dtmfTones={1:[{f:[697,1209],t:.2}],2:[{f:[697,1336],t:.2}],3:[{f:[697,1477],t:.2}],4:[{f:[770,1209],t:.2}],5:[{f:[770,1336],t:.2}],6:[{f:[770,1477],t:.2}],7:[{f:[852,1209],t:.2}],8:[{f:[852,1336],t:.2}],9:[{f:[852,1477],t:.2}],"*":[{f:[941,1209],t:.2}],0:[{f:[941,1336],t:.2}],"#":[{f:[941,1477],t:.2}],A:[{f:[697,1633],t:.2}],B:[{f:[770,1633],t:.2}],C:[{f:[852,1633],t:.2}],D:[{f:[941,1633],t:.2}]}}init(e={logger:null,audioCtx:null,useAudioElement:void 0}){this.logger=e.logger?e.logger:console.log,this.audioCtx=e.audioCtx?e.audioCtx:new(window.AudioContext||window.webkitAudioContext),e.useAudioElement===!0||e.useAudioElement===!1?this.useAudioElement=e.useAudioElement:this.useAudioElement=!["safari","safari|ios"].includes(this.browser),this.logger(`AudioPlayer2: init ${this.useAudioElement?"AudioElement":"AudioContext"} (${this.browser})`)}setSpeakerId(e){this.logger(`AudioPlayer2: setSpeakerId(${e})`),this.speakerDeviceId=e!==null?e:""}setRingerId(e){this.logger(`AudioPlayer2: setRingerId(${e})`),this.ringerDeviceId=e||null}_browser(){return/iPad|iPhone|iPod/.test(navigator.userAgent)?"safari|ios":navigator.mozGetUserMedia?"firefox":navigator.webkitGetUserMedia?"chrome":window.safari?"safari":"other"}isDisabled(){return this.audioCtx.state==="interrupted"&&this.logger("AudioPlayer2: isDisabled() state = interrupted ! Hello from iOS"),["chrome","safari","safari|ios"].includes(this.browser)?this.audioCtx.state==="suspended":!1}enable(){return["chrome","safari","safari|ios"].includes(this.browser)?this.audioCtx.resume():Promise.resolve()}downloadSounds(e,r){this.logger(`AudioPlayer2: downloadSounds ${e} ${JSON.stringify(r)}`),!this.useAudioElement&&["safari","safari|ios"].includes(this.browser)&&this._setDecodeAudioDataShim(this.audioCtx);let i=[];for(let l of r){let o,n;typeof l=="string"?o=n=l:(o=Object.keys(l)[0],n=l[o]);let f=e+n+".mp3";i.push(this.useAudioElement?this._downloadSound1(o,f):this._downloadSound2(o,f))}return Promise.allSettled(i)}generateTonesSuite(e){this.logger("AudioPlayer2: generateTonesSuite");let r=[];for(let i of Object.keys(e)){let l=e[i];r.push(this.useAudioElement?this._generateTone1(i,l):this._generateTone2(i,l))}return Promise.allSettled(r)}play(e,r=void 0){return this.isDisabled()?(this.logger(`AudioPlayer2: play: ${JSON.stringify(e)} [Sound is disabled]`),Promise.resolve()):this.useAudioElement?r?this._playStream1(e,r):this._play1(e):this._play2(e,r)}playRing(e){return this.isDisabled()?(this.logger(`AudioPlayer2: playRing: ${JSON.stringify(e)} [Sound is disabled]`),Promise.resolve()):this.useAudioElement?this._playRing1(e):Promise.resolve()}stop(){this.useAudioElement?this._stop1():this._stop2()}playShortSound(e){return this.audioCtx?this.useAudioElement?this._playShortSound1(e):this._playShortSound2(e):Promise.reject("No audio context")}_downloadSound1(e,r){let i=new Audio(r);return this.sounds[e]={audioElem:i,deviceId:"",source:null,streamDestination:null},new Promise((l,o)=>{i.oncanplaythrough=l,["safari","safari|ios"].includes(this.browser)&&(i.oncanplay=l,i.onloadedmetadata=l),i.onerror=o})}_generateTone1(e,r){return this._generateTone(r).then(i=>{let l=new Audio,o=this._createBlob1(i);l.src=URL.createObjectURL(o),this.sounds[e]={audioElem:l,deviceId:"",source:null,streamDestination:null}})}_createBlob1(e){function r(k,F,T){for(let S=0;S<T.length;S++)k.setUint8(F+S,T.charCodeAt(S))}function i(k,F,T,S){for(let E=0;E<T.length;E++,F+=2){let x=T[E]/S,$=Math.max(-1,Math.min(1,x));k.setInt16(F,$<0?$*32768:$*32767,!0)}}function l(k){let F=0,T=0;for(let S=0;S<k.length;S++){let E=k[S];F=Math.max(F,E),T=Math.min(T,E)}return(F-T)/2}let o=e.getChannelData(0),n=e.sampleRate,f=1,h=16,c=h/8,p=1,g=p*c,v=new ArrayBuffer(44+o.length*c),C=new DataView(v);r(C,0,"RIFF"),C.setUint32(4,36+o.length*c,!0),r(C,8,"WAVE"),r(C,12,"fmt "),C.setUint32(16,16,!0),C.setUint16(20,f,!0),C.setUint16(22,p,!0),C.setUint32(24,n,!0),C.setUint32(28,n*g,!0),C.setUint16(32,g,!0),C.setUint16(34,h,!0),r(C,36,"data"),C.setUint32(40,o.length*c,!0);let w=l(o);return i(C,44,o,w),new Blob([v],{type:"audio/wav"})}_play1(e){return this.logger(`AudioPlayer2 [AudioElement]: play: ${JSON.stringify(e)}`),this._play1_impl(e,"sound",this.speakerDeviceId)}_playRing1(e){return this.ringerDeviceId?(this.logger(`AudioPlayer2 [AudioElement]: playRing: ${JSON.stringify(e)}`),this._play1_impl(e,"ringer",this.ringerDeviceId)):Promise.resolve()}_playShortSound1(e){return this._play1_impl(e,"ssound",this.speakerDeviceId)}_play1_impl(e,r,i){this._silentStop1(this[r]);let l=this[r]=this.sounds[e.name];return l?l.source?(this.logger(`AudioPlayer2 [AudioElement]: sound "${e.name}" was used for streaming`),Promise.reject()):Promise.resolve().then(()=>i!==void 0&&l.audioElem.setSinkId!==void 0?l.deviceId===i?Promise.resolve():(this.logger(`AudioPlayer2 [AudioElement]: "${e.name}": setSinkId deviceId="${i}"`),l.audioElem.setSinkId(i)):Promise.resolve()).then(()=>{l.deviceId=i}).catch(o=>{this.logger(`AudioPlayer2 [AudioElement]: HTMLAudioElement.setSinkId error "${o.message}" [used default speaker]`)}).then(()=>{l.audioElem.volume=e.volume!==void 0?e.volume:1,l.audioElem.loop=!!e.loop&&e.repeat===void 0;let o=e.repeat!==void 0?e.repeat:1;return new Promise(n=>{l.audioElem.onended=()=>{--o>0&&this[r]?(l.audioElem.currentTime=0,l.audioElem.play().catch(f=>{this.logger("AudioPlayer2 [AudioElement]: play error",f)})):n()},l.audioElem.currentTime=0,l.audioElem.play().catch(f=>{this.logger("AudioPlayer2 [AudioElement]: play error",f)})})}):(this.logger(`AudioPlayer2 [AudioElement]: missed sound: "${e.name}"`),Promise.reject())}_playStream1(e,r){return this.logger(`AudioPlayer2 [AudioElement]: play stream: ${JSON.stringify(e)}`),this._silentStop1(this.sound),this.sound=null,this.sound=this.sounds[e.name],this.sound?new Promise(i=>{this.sound.audioElem.volume=e.volume!==void 0?e.volume:1,this.sound.audioElem.loop=!!e.loop&&e.repeat===void 0;let l=e.repeat!==void 0?e.repeat:1;this.sound.audioElem.onended=()=>{--l>0&&this.sound?(this.sound.audioElem.currentTime=0,this.sound.audioElem.play().catch(o=>{this.logger("AudioPlayer2 [AudioElement]: streaming error",o)})):(this.logger("AudioPlayer2 [AudioElement]: stopped"),i())},this.sound.audioElem.currentTime=0,this.sound.source||(this.sound.source=this.audioCtx.createMediaElementSource(this.sound.audioElem)),this.sound.streamDestination=r,this.sound.source.connect(this.sound.streamDestination),this.sound.audioElem.play().catch(o=>{this.logger("AudioPlayer2 [AudioElement]: streaming error",o)})}):(this.logger(`AudioPlayer2 [AudioElement]: missed media file: "${e.name}"`),Promise.reject())}_stop1(){this.logger("AudioPlayer2 [AudioElement]: stop"),this._silentStop1(this.sound),this.sound=null,this._silentStop1(this.ringer),this.ringer=null}_silentStop1(e){if(e&&(e.audioElem.pause(),e.source))try{e.source&&e.source.disconnect(),e.streamDestination&&e.streamDestination.disconnect(),e.streamDestination=null}catch(r){this.logger("AudioPlayer2 [AudioElement]: disconnect AudioContext error",r)}}_downloadSound2(e,r){return fetch(r,{credentials:"same-origin"}).then(i=>{if(i.status>=200&&i.status<=299)return i.arrayBuffer().catch(()=>{throw"download body error"});throw i.status===404?"file not found":"download error"}).then(i=>this.audioCtx.decodeAudioData(i).catch(()=>{throw"decoding error"})).then(i=>{this.sounds[e]={data:i,source:null,gain:null,streamDestination:null}}).catch(i=>{this.logger("AudioPlayer2 [AudioContext]: "+i+": "+r)})}_generateTone2(e,r){return this._generateTone(r).then(i=>{i&&(this.sounds[e]={data:i,source:null,gain:null,streamDestination:null})})}_play2(e,r=null){return this.logger(`AudioPlayer2 [AudioContext]: ${r?"playStream":"play"}: ${JSON.stringify(e)}`),this._silentStop2(),this.sound=this.sounds[e.name],this.sound?new Promise((i,l)=>{try{this.sound.source=this.audioCtx.createBufferSource(),this.sound.source.buffer=this.sound.data,this.sound.source.onended=()=>{this.logger(`AudioPlayer2 [AudioContext]:  onended ${e.name}`),this._silentStop2(),i(!0)},this.sound.source.onerror=f=>{this.logger(`AudioPlayer2 [AudioContext]:  onerror ${e.name}`),this._silentStop2(),l(new Error("onerror callback"))},this.sound.gain=this.audioCtx.createGain();let o=e.volume?e.volume:1;this.sound.gain.gain.setValueAtTime(o,this.audioCtx.currentTime),this.sound.source.connect(this.sound.gain),r?(this.sound.streamDestination=r,this.sound.gain.connect(this.sound.streamDestination)):(this.sound.streamDestination=null,this.sound.gain.connect(this.audioCtx.destination)),(e.loop===!0||e.repeat)&&(this.sound.source.loop=!0,this.sound.source.loopStart=0);let n=null;e.repeat&&(n=this.sound.source.buffer.duration*e.repeat),this.sound.source.start(0,0),n&&this.sound.source.stop(this.audioCtx.currentTime+n)}catch(o){this.logger("AudioPlayer2 [AudioContext]: play error",o),this._silentStop2(),l(o)}}):(this.logger(`AudioPlayer2 [AudioContext]: missed media: "${e.name}"`),Promise.reject())}_playShortSound2(e){let r,i;function l(){try{r&&r.stop(),i&&i.disconnect(),r&&r.disconnect()}catch(o){this.logger("AudioPlayer [AudioContext]: playShortSound: release error",o)}}return new Promise((o,n)=>{try{let f=this.sounds[e.name];if(!f){`${e.name}`,n("No sound");return}r=this.audioCtx.createBufferSource(),r.buffer=f.data,r.onended=()=>{l(),o()},r.onerror=c=>{l(),n(c)},i=this.audioCtx.createGain();let h=e.volume?e.volume:1;i.gain.setValueAtTime(h,this.audioCtx.currentTime),r.connect(i),i.connect(this.audioCtx.destination),r.start()}catch(f){this.logger("AudioPlayer [AudioContext]: playShortSound error",f),n(f)}})}_stop2(){this.logger("AudioPlayer2 [AudioContext]: stop"),this._silentStop2()}_silentStop2(){if(this.sound){try{this.sound.source&&this.sound.source.stop()}catch(e){}try{this.sound.gain&&this.sound.gain.disconnect(),this.sound.source&&this.sound.source.disconnect(),this.sound.streamDestination&&this.sound.streamDestination.disconnect(),this.sound.gain=null,this.sound.source=null,this.sound.streamDestination=null}catch(e){this.logger("AudioPlayer2 [AudioContext]: release resources error",e)}this.sound=null}}_setDecodeAudioDataShim(e){let r=e.decodeAudioData;e.decodeAudioData=i=>new Promise((l,o)=>{r.call(e,i,n=>l(n),n=>o(n))})}_setStartRenderingShim(e){let r=e.startRendering;e.startRendering=()=>new Promise(i=>{e.oncomplete=l=>{i(l.renderedBuffer)},r.call(e)})}_generateTone(e){function r(i){return i===void 0?[]:Array.isArray(i)?i:[i]}try{let i=0,l=0;for(let g of e)i+=g.t,l=Math.max(l,r(g.f).length);let o=1,n=this.audioCtx.sampleRate,f=n*i,h=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(o,f,n);(this.browser==="safari"||this.browser==="safari|ios")&&this._setStartRenderingShim(h);let c=new Array(l);for(let g=0;g<c.length;g++)c[g]=h.createOscillator(),c[g].connect(h.destination);let p=0;for(let g=0,v=e.length;g<v;g++){let C=e[g],w=r(C.f);for(let k=0;k<c.length;k++){let F=k<w.length?w[k]:0;c[k].frequency.setValueAtTime(F,h.currentTime+p)}p+=C.t}for(let g of c)g.start(0),g.stop(h.currentTime+i);return h.startRendering().then(g=>{for(let v of c)v.disconnect();return g})}catch(i){return this.logger("AudioPlayer2: cannot generate tone",i),Promise.reject(i)}}}class d1{constructor(){this.defaultPseudoDevice=!0,this.names=[],this.enumerateDevices=AudioCodesUA.instance.getWR().mediaDevices.enumerateDevices,this.browserDefaultLabel="-- browser default--",this.emptyLabel="-- no label --",this.previousSelection=null}setDevices(e,r){this.defaultPseudoDevice=e,this.names=[];for(let i of r){if(!["audioinput","audiooutput","videoinput"].includes(i.kind))throw new TypeException(`Illegal kind: ${i.kind}`);this.names.push(i.name),this[i.name]={kind:i.kind}}}setEnumerateDevices(e){this.enumerateDevices=e}enumerate(e){let r=null,i=!1;return Promise.resolve().then(()=>this.doEnumerate()).then(l=>(i=l,i&&e?AudioCodesUA.instance.getWR().getUserMedia({audio:!0,video:!0}):Promise.resolve(null))).then(l=>{if(r=l,r)return this.doEnumerate()}).then(()=>{r&&(i=!1,r.getTracks().forEach(l=>l.stop()))}).then(()=>{if(this.previousSelection)for(let l of this.names)this.findPreviousSelection(l)||i&&this.addPreviousSelection(l)})}doEnumerate(){let e=!1,r=this.emptyLabel;function i(l,o){return o||(e=l.incomplete=!0,r)}for(let l of this.names){let o=this.getDevice(l);o.incomplete=!1,this.defaultPseudoDevice?(o.index=0,o.list=[{deviceId:null,label:this.browserDefaultLabel}]):(o.index=-1,o.list=[])}return this.enumerateDevices().then(l=>{for(let o of l)for(let n of this.names){let f=this.getDevice(n);o.kind===f.kind&&f.list.push({deviceId:o.deviceId,label:i(f,o.label)})}}).then(()=>e)}findPreviousSelection(e){let r=this.getDevice(e),i=this.previousSelection&&this.previousSelection[e];if(!i||i.label===this.emptyLabel)return!1;for(let l=0;l<r.list.length;l++)if(r.list[l].label===i.label)return r.index=l,!0;return!1}addPreviousSelection(e){let r=this.getDevice(e),i=this.previousSelection&&this.previousSelection[e];i&&i.label!==this.browserDefaultLabel&&i.label!==this.emptyLabel&&(AudioCodesUA.ac_log(`devices: added previously selected ${e} "${i.label}"`),r.list.push(i),r.index=r.list.length-1)}getDevice(e){if(!this[e])throw new TypeError(`wrong device name: ${e}`);return this[e]}getSelected(e){let r=this.getDevice(e);return r.list.length===0||r.index===-1?{deviceId:null,label:this.emptyLabel}:r.list[r.index]}getNumber(e){return this.getDevice(e).list.length}setSelectedIndex(e,r){let i=this.getDevice(e);if(r<0||r>=i.list.length)throw new RangeError(`setSelectedIndex ${e} index=${r}`);i.index=r}store(){this.previousSelection=null;for(let e of this.names){let r=this.getDevice(e);r.list.length===0||r.index===-1||(this.previousSelection||(this.previousSelection={}),this.previousSelection[e]=this.getSelected(e))}return this.previousSelection}load(e){this.previousSelection=e}addDeviceChangeListener(e){AudioCodesUA.instance.getWR().mediaDevices.addDeviceChangeListener(e)}removeDeviceChangeListener(e){AudioCodesUA.instance.getWR().mediaDevices.removeDeviceChangeListener(e)}}class h1{constructor(e,r,i){le(this,"c2c_userAgent","AudioCodes Click-to-Call");le(this,"c2c_sbcDisconnectCounterMax",5);le(this,"c2c_sbcDisconnectDelay",60);le(this,"c2c_phone",new L);le(this,"c2c_ac_log",console.log);le(this,"c2c_hasMicrophone",!0);le(this,"c2c_hasCamera",!1);le(this,"c2c_audioPlayer",new f1);le(this,"c2c_activeCall",null);le(this,"c2c_restoreCall",null);le(this,"c2c_sbcDisconnectCounter",0);le(this,"c2c_sbcDisconnectTimer",null);le(this,"c2c_messageId",0);le(this,"c2c_streamDest",null);le(this,"c2c_usedTurnServer",!1);le(this,"c2c_isRegularCall",!0);le(this,"c2c_isWsConnected",!1);le(this,"c2c_isStartCall",!1);le(this,"c2c_dtmfSequence",null);le(this,"c2c_dtmfDelay",2e3);le(this,"c2c_callButtonHandler",function(){});le(this,"c2c_testButtonHandler",function(){});le(this,"c2c_callButtonTitle",null);le(this,"c2c_x_header",null);le(this,"c2c_token",null);le(this,"c2c_devices",null);le(this,"c2c_remoteVideoDeviceId");le(this,"c2c_connectionSpeedDiv",null);le(this,"c2c_testCallQualityDiv",null);le(this,"c2c_widgetDiv",null);le(this,"c2c_selectDevicesButton",null);le(this,"c2c_testButton",null);le(this,"c2c_callButton",null);le(this,"c2c_videoSpan",null);le(this,"c2c_videoCheckbox",null);le(this,"c2c_cameraButton",null);le(this,"c2c_cameraLineSvg",null);le(this,"c2c_selectDevicesDiv",null);le(this,"c2c_status_line",null);le(this,"c2c_remoteVideo",null);le(this,"c2c_soundConfig");le(this,"c2c_config");le(this,"c2c_serverConfig");this.c2c_config=e,this.c2c_serverConfig=r,this.c2c_soundConfig=i;let l=this.c2c_getStrUrlParameter("logger");l||(l=this.c2c_serverConfig.logger),l?this.c2c_setWebsocketLoggers(l).catch(o=>{this.c2c_setConsoleLoggers(),this.c2c_ac_log("Cannot connect to logger server",o)}).finally(()=>{this.c2c_startPhone()}):(this.c2c_setConsoleLoggers(),this.c2c_startPhone())}c2c_startPhone(){return Kn(this,null,function*(){if(this.c2c_ac_log(`------ Date: ${new Date().toDateString()} -------`),this.c2c_ac_log(this.c2c_userAgent),this.c2c_ac_log(`SDK: ${this.c2c_phone.version()}`),this.c2c_ac_log(`SIP: ${Cr.C.USER_AGENT}`),this.c2c_ac_log(`Browser: ${this.c2c_phone.getBrowserName()}  Internal name: ${this.c2c_phone.getBrowser()}|${this.c2c_phone.getOS()}`),this.c2c_phone.setUserAgent(`${this.c2c_userAgent} ${this.c2c_phone.version()} ${this.c2c_phone.getBrowserName()}`),this.c2c_config.selectDevicesEnabled){this.c2c_devices=new d1,this.c2c_devices.setDevices(!0,[{name:"microphone",kind:"audioinput"},{name:"camera",kind:"videoinput"},{name:"speaker",kind:"audiooutput"}]);let p=sessionStorage.getItem("c2c_selectedDevices");p!==null&&this.c2c_devices.load(JSON.parse(p)),yield this.c2c_devices.enumerate(!1)}let e=this.c2c_getStrUrlParameter("call");e&&(this.c2c_config.call==="_take_value_from_url_"?this.c2c_config.call=this.c2c_stringDropCharacters(e," -"):this.c2c_ac_log(`Error: URL parameter "call" is ignored. To enable set configuration "call: '_take_value_from_url_'"`));let r=this.c2c_getStrUrlParameter("domain");r&&(this.c2c_serverConfig.domain==="_take_value_from_url_"?this.c2c_serverConfig.domain=r:this.c2c_ac_log(`Error: URL parameter "domain" is ignored. To enable set configuration "domain: '_take_value_from_url_'"`));let i=this.c2c_getStrUrlParameter("server");i&&(this.c2c_serverConfig.addresses==="_take_value_from_url_"?this.c2c_serverConfig.addresses=[`wss://${i}`]:this.c2c_ac_log(`Error: URL parameter "server" is ignored. To enable set configuration "addresses: '_take_value_from_url_'"`));let l=this.c2c_getStrUrlParameter("token");l&&(this.c2c_config.urlToken?this.c2c_token=l:this.c2c_ac_log('Error: URL parameter "token" is ignored. To enable set configuration "urlToken: true"'));let o=this.c2c_getStrUrlParameter("dtmf");o&&(this.c2c_dtmfSequence=this.c2c_stringDropCharacters(o," -")),this.c2c_dtmfDelay=this.c2c_getIntUrlParameter("delay",this.c2c_dtmfDelay),(e||o)&&this.c2c_ac_log(`URL parameters: call=${e} dtmf=${o} delay=${this.c2c_dtmfDelay}
After filtering: call=${this.c2c_config.call}  dtmf=${this.c2c_dtmfSequence}`);let n=this.c2c_phone.getBrowser(),f=this.c2c_phone.getOS();if(this.c2c_config.testCallEnabled&&!this.c2c_config.testCallSBCScore&&(n==="safari"||f==="ios")&&(this.c2c_ac_log("Disable test call for iMac/iOS Safari browser, because getStats() implementation missed remote-inbound-rtp report"),this.c2c_config.testCallEnabled=!1),!this.c2c_getHTMLPageReferences())return;if(this.c2c_callButton.onclick=()=>{this.c2c_buttonHandler("call button",this.c2c_callButtonHandler.bind(this))},this.c2c_selectDevicesButton&&(this.c2c_selectDevicesButton.onclick=()=>{this.c2c_buttonHandler("select devices button",this.c2c_selectDevices.bind(this))}),this.c2c_testButton&&(this.c2c_testButton.onclick=()=>{this.c2c_buttonHandler("test button",this.c2c_testButtonHandler.bind(this))}),this.c2c_cameraButton&&(this.c2c_cameraButton.onclick=()=>{this.c2c_buttonHandler("webcam on/off button",this.c2c_cameraToggle.bind(this))}),document.getElementById("keypad_btn").onclick=this.guiToggleDTMFKeyPad.bind(this),this.c2c_config.testCallEnabled&&(this.c2c_testButtonHandler=()=>{this.c2c_call(!1)},this.c2c_connectionSpeedDiv&&navigator.connection))try{let p=navigator.connection;if(p.downlink){let g=p.downlink;this.c2c_connectionSpeedDiv.innerHTML='Connection speed: <span style="font-weight:bold">'+g+"</span> Mbps"}else throw"nc.downlink is undefined"}catch(p){this.c2c_ac_log("Cannot get connection information",p)}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){this.c2c_info("No WebRTC"),this.c2c_gui_phoneDisabled("WebRTC API is not supported in this browser !");return}try{this.c2c_hasCamera=yield this.c2c_phone.checkAvailableDevices(),this.c2c_ac_log(`Camera is ${this.c2c_hasCamera?"present":"missing"}`)}catch(p){if(this.c2c_config.allowCallWithoutMicrophone)this.c2c_ac_log('Microphone is missed. Used "allowCallWithoutMicrophone" mode'),this.c2c_hasMicrophone=!1;else{this.c2c_info("No microphone or speaker !"),this.c2c_gui_phoneDisabled("No microphone or speaker !");return}}location.protocol!=="https:"&&location.protocol!=="file:"&&this.c2c_ac_log('Warning: for the URL used "'+location.protocol+'" protocol');const h=p=>p.replace(/[a-z]/gi,g=>String.fromCharCode(g.charCodeAt()+13-26*/[n-z]/i.test(g)));for(let p of this.c2c_serverConfig.iceServers){if(typeof p=="string")continue;(Array.isArray(p.urls)?p.urls[0]:p.urls).startsWith("turn:")&&(this.c2c_usedTurnServer=!0,p.username===void 0&&(p.username="some-username"),p.credential===void 0&&(p.credential=h("nhgu-gbxra")))}let c=sessionStorage.getItem("c2c_restoreCall");if(c!==null){sessionStorage.removeItem("c2c_restoreCall"),this.c2c_restoreCall=JSON.parse(c);let p=Math.ceil(Math.abs(this.c2c_restoreCall.time-new Date().getTime())/1e3);p>this.c2c_config.c2c_restoreCallMaxDelay&&(this.c2c_ac_log("No restore call, delay is too long ("+p+" seconds)"),this.c2c_restoreCall=null)}if(window.addEventListener("beforeunload",this.c2c_onBeforeUnload.bind(this)),this.c2c_audioPlayer.init({logger:this.c2c_ac_log.bind(this)}),yield this.c2c_audioPlayer.downloadSounds("../sounds/",this.c2c_soundConfig.downloadSounds).then(()=>{let p=Object.assign({},this.c2c_soundConfig.generateTones,this.c2c_audioPlayer.dtmfTones);return this.c2c_audioPlayer.generateTonesSuite(p)}).then(()=>{this.c2c_ac_log("audioPlayer: sounds are ready:",this.c2c_audioPlayer.sounds)}),this.c2c_devices){let p=this.c2c_devices.getSelected("speaker").deviceId;this.c2c_audioPlayer.setSpeakerId(p)}if(this.c2c_gui_phoneBeforeCall(),this.c2c_restoreCall===null){let p=this.c2c_config.callAutoStart?this.c2c_config.callAutoStart.toLowerCase():"no";p==="yes force"||p==="yes"&&!this.c2c_audioPlayer.isDisabled()?(this.c2c_audioPlayer.isDisabled()?this.c2c_ac_log("Start call automatically. Warning: audio player is disabled. So you cannot hear beeps!"):this.c2c_ac_log("Start call automatically"),this.c2c_call(!0)):this.c2c_config.testCallEnabled&&this.c2c_config.testCallAutoStart&&(this.c2c_config.testCallUseMicrophone?(this.c2c_ac_log("Test call used microphone. Start test call automatically"),this.c2c_call(!1)):this.c2c_audioPlayer.isDisabled()?this.c2c_ac_log("Test call used recorded sound. Play sound is disabled by Auto-Play policy. Please press button to start test call"):(this.c2c_ac_log("Test call used recorded sound. Play sound is enabled by Auto-Play policy. Start test call automatically"),this.c2c_call(!1)))}this.c2c_restoreCall!==null&&(this.c2c_ac_log("Trying to restore call",this.c2c_restoreCall),this.c2c_call(!0))})}c2c_getHTMLPageReferences(){if(this.c2c_widgetDiv=document.getElementById("c2c_widget_div"),!this.c2c_widgetDiv)return this.c2c_ac_log('Fatal error: HTML missed div id="c2c_widget"'),!1;if(this.c2c_callButton=document.getElementById("c2c_call_btn"),!this.c2c_callButton)return this.c2c_ac_log('Fatal error: HTML missed button id="c2c_call_btn"'),!1;if(this.c2c_callButtonTitle=this.c2c_callButton.title,this.c2c_remoteVideo=document.getElementById("c2c_remote_video"),!this.c2c_remoteVideo)return this.c2c_ac_log('Fatal error: HTML missed video element id="c2c_remote_video"'),!1;if(this.c2c_status_line=document.getElementById("c2c_status_line"),!this.c2c_status_line)return this.c2c_ac_log('Fatal error: HTML missed div id="c2c_status_line"'),!1;if(this.c2c_devices&&(this.c2c_selectDevicesButton=document.getElementById("c2c_select_devices_btn"),this.c2c_selectDevicesDiv=document.getElementById("c2c_select_devices_div")),this.c2c_config.testCallEnabled){if(this.c2c_connectionSpeedDiv=document.getElementById("c2c_connection_speed_div"),this.c2c_testCallQualityDiv=document.getElementById("c2c_test_call_quality_div"),this.c2c_testButton=document.getElementById("c2c_test_btn"),!this.c2c_testCallQualityDiv)return this.c2c_ac_log('Fatal error: Mode testCallEnabled and HTML missed span id="c2c_quality_span"'),!1;if(!this.c2c_testButton)return this.c2c_ac_log('Fatal error: Mode testCallEnabled and HTML missed button id="c2c_test_btn"'),!1}if(this.c2c_videoSpan=document.getElementById("c2c_video_chk_span"),this.c2c_videoCheckbox=document.getElementById("c2c_video_chk"),this.c2c_cameraButton=document.getElementById("c2c_camera_btn"),this.c2c_cameraLineSvg=document.getElementById("c2c_camera_line_svg"),this.c2c_config.type==="user_control"){if(!this.c2c_videoSpan)return this.c2c_ac_log('Fatal error: Call type is "user_control" and HTML missed span id="c2c_video_chk_span"'),!1;if(!this.c2c_videoCheckbox)return this.c2c_ac_log('Fatal error: Call type is "user_control" and HTML missed checkbox id="c2c_video_chk"'),!1;if(!this.c2c_cameraButton)return this.c2c_ac_log('Fatal error: Call type is "user_control" and HTML missed button id="c2c_camera_btn"'),!1;if(!this.c2c_cameraLineSvg)return this.c2c_ac_log('Fatal error: Call type is "user_control" and HTML missed svg id="c2c_camera_line_svg"'),!1}return!0}c2c_buttonHandler(e,r){if(this.c2c_ac_log(`phone>> "${e}" onclick event`),!this.c2c_audioPlayer.isDisabled()){r();return}this.c2c_ac_log("Let enable sound..."),this.c2c_audioPlayer.enable().then(()=>{this.c2c_ac_log("Sound is enabled")}).catch(i=>{this.c2c_ac_log("Cannot enable sound",i)}).finally(()=>{r()})}c2c_getStrUrlParameter(e,r=null){let i=window.location.search.split("&"+e+"=")[1];return i||(i=window.location.search.split("?"+e+"=")[1]),i!==void 0?decodeURIComponent(i.split("&")[0]):r}c2c_getIntUrlParameter(e,r=null){let i=window.location.search.split("&"+e+"=")[1];return i||(i=window.location.search.split("?"+e+"=")[1]),i!==void 0?parseInt(decodeURIComponent(i.split("&")[0])):r}c2c_stringDropCharacters(e,r){let i="";for(let l of e)r.includes(l)||(i+=l);return i}c2c_delay(e){return new Promise(r=>{setTimeout(()=>r(),e)})}c2c_timestamp(){let e=new Date,r=e.getHours(),i=e.getMinutes(),l=e.getSeconds(),o=e.getMilliseconds();return(r<10?"0"+r:r)+":"+(i<10?"0"+i:i)+":"+(l<10?"0"+l:l)+"."+("00"+o).slice(-3)+" "}c2c_searchServerAddress(e,r){r=r.toLowerCase();for(let i=0;i<e.length;i++){let l=e[i];if((l instanceof Array?l[0]:l).toLowerCase()===r)return i}return-1}c2c_setConsoleLoggers(){let e=["chrome","firefox","safari"].includes(this.c2c_phone.getBrowser());const r=function(){let l=[].slice.call(arguments),o=[this.c2c_timestamp()+(e?"%c":"")+l[0]];e&&(o=o.concat(["color: BlueViolet;"])),console.log.apply(console,o.concat(l.slice(1)))};let i=function(){let l=[].slice.call(arguments),o=[this.c2c_timestamp()+l[0]];console.log.apply(console,o.concat(l.slice(1)))};this.c2c_ac_log=r.bind(this),this.c2c_phone.setAcLogger(r.bind(this)),this.c2c_phone.setJsSipLogger(i.bind(this))}c2c_setWebsocketLoggers(e){return new Promise((r,i)=>{let l=new WebSocket("wss://"+e,"wslog");l.onopen=()=>{r(l)},l.onerror=o=>{i(o)}}).then(r=>{const i=function(){let l=[].slice.call(arguments);r.send([this.c2c_timestamp()+l[0]].concat(l.slice(1)).join()+`
`)};this.c2c_ac_log(`Sending log to "${e}"`),this.c2c_ac_log=i.bind(this),this.c2c_phone.setAcLogger(i.bind(this)),this.c2c_phone.setJsSipLogger(i.bind(this))})}c2c_initStack(e){if(this.c2c_restoreCall!==null){let r=this.c2c_searchServerAddress(this.c2c_serverConfig.addresses,this.c2c_restoreCall.address);r!==-1?(this.c2c_ac_log('Page reloading, raise priority of previously connected server: "'+this.c2c_restoreCall.address+'"'),this.c2c_serverConfig.addresses[r]=[this.c2c_restoreCall.address,1e3]):this.c2c_ac_log("Cannot find previously connected server: "+this.c2c_restoreCall.address+" in configuration")}this.c2c_phone.setServerConfig(this.c2c_serverConfig.addresses,this.c2c_serverConfig.domain,this.c2c_serverConfig.iceServers),this.c2c_phone.setAccount(e.user,e.displayName,e.password),this.c2c_phone.setWebSocketKeepAlive(this.c2c_config.pingInterval,this.c2c_config.pongTimeout,this.c2c_config.timerThrottlingBestEffort,this.c2c_config.pongReport,this.c2c_config.pongDist),this.c2c_phone.setListeners({loginStateChanged:(r,i)=>{switch(i){case"connected":if(this.c2c_ac_log("phone>>> loginStateChanged: connected"),this.c2c_isWsConnected=!0,this.c2c_activeCall!==null){this.c2c_ac_log("phone: active call exists (SBC might have switched over to secondary)");break}this.c2c_restoreCall!==null?(this.c2c_ac_log("send INVITE with Replaces to restore call"),this.c2c_makeCall(this.c2c_restoreCall.callTo,this.c2c_restoreCall.video==="sendrecv"||this.c2c_restoreCall.video==="sendonly"?this.c2c_phone.VIDEO:this.c2c_phone.AUDIO,["Replaces: "+this.c2c_restoreCall.replaces])):this.c2c_isStartCall&&this.c2c_startCall();break;case"disconnected":this.c2c_ac_log("phone>>> loginStateChanged: disconnected"),this.c2c_isWsConnected=!1,this.c2c_phone.isInitialized()&&this.c2c_sbcDisconnectCounter++>=this.c2c_sbcDisconnectCounterMax&&this.c2c_activeCall===null&&(this.c2c_ac_log("phone: too many disconnections."),this.c2c_phone.deinit(),this.c2c_info("Cannot connect to SBC server"),this.c2c_gui_phoneBeforeCall());break;case"login failed":this.c2c_ac_log("phone>>> loginStateChanged: login failed");break;case"login":this.c2c_ac_log("phone>>> loginStateChanged: login");break;case"logout":this.c2c_ac_log("phone>>> loginStateChanged: logout");break}},outgoingCallProgress:(r,i)=>{this.c2c_ac_log("phone>>> outgoing call progress"),this.c2c_isRegularCall&&(this.c2c_info("Ringing",!0),this.c2c_audioPlayer.play(this.c2c_soundConfig.play.outgoingCallProgress))},callTerminated:(r,i,l,o)=>{if(this.c2c_ac_log(`phone>>> call terminated callback, cause=${l}`),this.c2c_activeCall=null,l==="Redirected"){this.c2c_ac_log(`Redirect call to ${o}`),this.c2c_makeCall(o,this.c2c_videoOption());return}if(this.c2c_audioPlayer.stop(),this.c2c_isRegularCall){let n=l;this.c2c_info(n,!0),r.isOutgoing()&&!r.wasAccepted()?this.c2c_audioPlayer.play(this.c2c_soundConfig.play.busy):this.c2c_audioPlayer.play(this.c2c_soundConfig.play.disconnect)}else if(!r.wasAccepted())this.c2c_ac_log("Warning: Test call is failed !"),this.c2c_info("Test line is failed");else if(this.c2c_config.testCallSBCScore)try{if(!i)throw"No BYE message";let n=getXVoiceQuality(i);if(n){let f=this.c2c_config.testCallQualityText[n.color];this.c2c_ac_log(`BYE: "X-VoiceQuality" header: score="${n.score}", color="${n.color}" text="${f}"`),this.c2c_testCallQualityDiv&&(this.c2c_testCallQualityDiv.innerHTML='Test call quality: <span style="color:'+n.color+';font-weight:bold">'+f+"</span>"),this.c2c_info("Test passed",!0)}else throw this.c2c_ac_log('BYE: missing "X-VoiceQuality" header'),'BYE: missing "X-VoiceQuality" header'}catch(n){this.c2c_ac_log("Warning: cannot take SBC voice quality information",n),this.c2c_info("Test failed",!0)}this.c2c_sbcDisconnectDelay===0?this.c2c_phone.deinit():this.c2c_sbcDisconnectTimer=setTimeout(()=>{this.c2c_ac_log("The time interval between the end of the call and SBC disconnection is over"),this.c2c_phone.deinit()},this.c2c_sbcDisconnectDelay*1e3),this.c2c_gui_phoneBeforeCall(),this.c2c_setRemoteVideoVisibility(!1),this.c2c_restoreCall=null},callConfirmed:(r,i,l)=>Kn(this,null,function*(){if(this.c2c_ac_log("phone>>> callConfirmed"),this.c2c_audioPlayer.stop(),this.c2c_setRemoteVideoVisibility(this.c2c_activeCall.hasReceiveVideo()),this.c2c_gui_phoneDuringCall(),this.c2c_isRegularCall){if(this.c2c_info("Call is established",!0),this.c2c_restoreCall!==null&&this.c2c_restoreCall.hold.includes("remote")&&(this.c2c_ac_log("Restore remote hold"),this.c2c_info("Hold"),this.c2c_activeCall.setRemoteHoldState()),this.c2c_dtmfSequence!==null&&this.c2c_restoreCall===null){this.c2c_dtmfDelay>0&&(this.c2c_ac_log(`Wait ${this.c2c_dtmfDelay}ms before DTMF sending...`),yield this.c2c_delay(this.c2c_dtmfDelay)),this.c2c_ac_log(`Send DTMF sequence: ${this.c2c_dtmfSequence}`);for(let o of this.c2c_dtmfSequence)this.c2c_activeCall.sendDTMF(o)}this.c2c_hasMicrophone||(this.c2c_info("Warning: No microphone"),this.c2c_ac_log('Play "noMicrophoneSound"'),this.c2c_audioPlayer.play(this.c2c_soundConfig.play.noMicrophoneSound,this.c2c_streamDest))}else yield this.c2c_voiceQualityTesting()}),callShowStreams:(r,i,l)=>{this.c2c_ac_log("phone>>> callShowStreams"),this.c2c_audioPlayer.stop(),this.c2c_devices?this.c2c_setRemoteVideoSinkId().catch(o=>{this.c2c_ac_log(`Warning: remove video HTMLVideoElement.setSinkId(): "${o.message}" [Used default browser speaker]`,o)}).finally(()=>{this.c2c_remoteVideo.srcObject=l,this.c2c_remoteVideo.volume=this.c2c_isRegularCall?1:this.c2c_config.testCallVolume}):(this.c2c_remoteVideo.srcObject=l,this.c2c_remoteVideo.volume=this.c2c_isRegularCall?1:this.c2c_config.testCallVolume)},incomingCall:(r,i)=>{this.c2c_ac_log("phone>>> incomingCall"),r.reject()},callHoldStateChanged:(r,i,l)=>{this.c2c_ac_log("phone>>> callHoldStateChanged"),r.isRemoteHold()?this.c2c_gui_phoneOnRemoteHold():this.c2c_gui_phoneDuringCall()},callIncomingReinvite:(r,i,l)=>{i||(this.c2c_setRemoteVideoVisibility(r.hasReceiveVideo()),r.hasReceiveVideo()&&!r.hasSendVideo()&&this.c2c_hasCamera&&(r.hasEnabledSendVideo()?this.c2c_ac_log("Other side disable receive video for video call"):this.c2c_info("You are invited to turn on your camera",!0)))},incomingNotify:(r,i,l,o,n,f)=>{if(this.c2c_ac_log(`phone>>> incoming NOTIFY "${i}"`,r,l,o,n),r!==null)return!1;if(i==="vq"){let h=getXVoiceQuality(f);if(h){let c=this.c2c_config.testCallQualityText[h.color];this.c2c_ac_log(`NOTIFY: "X-VoiceQuality" header: score="${h.score}", color="${h.color}" text="${c}"`)}else this.c2c_ac_log('NOTIFY: missing "X-VoiceQuality" header');return!0}else return!1}}),this.c2c_sbcDisconnectCounter=0,this.c2c_phone.setEnableAddVideo(this.c2c_config.type!=="audio"),this.c2c_phone.setNetworkPriority(this.c2c_config.networkPriority),this.c2c_phone.setModes(this.c2c_config.modes),this.c2c_phone.init(!1)}getXVoiceQuality(e){let r=e.getHeader("X-VoiceQuality");if(!r)return;let i=r.trim().split(" ");if(i.length!==2){console.log("X-VoiceQuality header: parsing problem: must be 2 tokens");return}let l=parseInt(i[0]);if(isNaN(l)){console.log("X-VoiceQuality header: parsing problem: the first token is not number");return}let o=i[1].trim().toLowerCase();return{score:l,color:o}}c2c_onBeforeUnload(){if(this.c2c_ac_log("phone>>> beforeunload event"),!(this.c2c_phone===null||!this.c2c_phone.isInitialized())&&this.c2c_activeCall!==null&&this.c2c_isRegularCall)if(this.c2c_activeCall.isEstablished()){let e={callTo:this.c2c_activeCall.data._user,video:this.c2c_activeCall.getVideoState(),replaces:this.c2c_activeCall.getReplacesHeader(),time:new Date().getTime(),hold:`${this.c2c_activeCall.isLocalHold()?"local":""}${this.c2c_activeCall.isRemoteHold()?"remote":""}`,address:this.c2c_phone.getServerAddress()};sessionStorage.setItem("c2c_restoreCall",JSON.stringify(e))}else this.c2c_activeCall.terminate()}c2c_videoOption(){if(!this.c2c_hasCamera)return this.c2c_phone.AUDIO;switch(this.c2c_config.type){case"audio":return this.c2c_phone.AUDIO;case"video":return this.c2c_phone.VIDEO;case"user_control":return this.c2c_videoCheckbox.checked?this.c2c_phone.VIDEO:this.c2c_phone.AUDIO;default:return this.c2c_log("Warning: c2c_videoOption(): Illegal value of c2c_config.type Used: 'audio'"),this.c2c_phone.AUDIO}}c2c_selectDevices(){this.c2c_ac_log("c2c_selectDevices()"),this.c2c_info(""),document.getElementById("select_devices_done_btn").onclick=this.c2c_selectDevicesDone.bind(this),this.c2c_devices.enumerate(!0).catch(e=>{ac_log("getUserMedia() exception",e)}).finally(()=>{for(let e of this.c2c_devices.names)this.c2c_fillDeviceList(e);this.c2c_gui_DeviceSelection()})}c2c_fillDeviceList(e){let r=this.c2c_devices.getDevice(e),i=document.querySelector(`#c2c_devices [name=${e}]`);for(;i.firstChild;)i.removeChild(i.firstChild);r.incomplete?(i.disabled=!0,this.c2c_ac_log(`Warning: To device selection let enable ${e} usage`)):i.disabled=!1;for(let l=0;l<r.list.length;l++){let o=r.list[l],n=document.createElement("option");n.text=o.label,n.value=l.toString(),n.selected=r.index===l,i.add(n)}if(e==="camera"&&this.c2c_config.type==="audio"){document.getElementById("camera_dev").style.display="none";return}document.getElementById(`${e}_dev`).style.display=r.list.length>1?"block":"none"}c2c_selectDevicesDone(){for(let n of this.c2c_devices.names){let f=document.querySelector(`#c2c_devices [name=${n}]`),h=f.selectedIndex;if(h!==-1){let c=f.options[h].value;this.c2c_devices.setSelectedIndex(n,parseInt(c))}}let e=this.c2c_devices.store();sessionStorage.setItem("c2c_selectedDevices",JSON.stringify(e));let r="Devices done: selected";for(let n of this.c2c_devices.names)this.c2c_devices.getNumber(n)>1&&(r+=`
${n}: "${this.c2c_devices.getSelected(n).label}"`);this.c2c_ac_log(r);let i=this.c2c_devices.getSelected("microphone").deviceId;this.c2c_phone.setConstraint("audio","deviceId",i);let l=this.c2c_devices.getSelected("camera").deviceId;this.c2c_phone.setConstraint("video","deviceId",l);let o=this.c2c_devices.getSelected("speaker").deviceId;this.c2c_audioPlayer.setSpeakerId(o),this.c2c_gui_phoneBeforeCall()}c2c_setRemoteVideoSinkId(){let e=this.c2c_devices.getSelected("speaker").deviceId;return e===null&&(e=""),this.c2c_remoteVideoDeviceId===e?(this.c2c_ac_log("c2c: remote video: sinkId is already assigned"),Promise.resolve()):this.c2c_remoteVideo.setSinkId?(this.c2c_ac_log(`c2c: remove video: setSinkId "${e}"`),this.c2c_remoteVideo.srcObject=null,this.c2c_remoteVideo.setSinkId(e).then(()=>{this.c2c_ac_log("c2c: remote video: setSinkId completed"),this.c2c_remoteVideoDeviceId=e})):Promise.reject(new Error("setSinkId is not implemented"))}c2c_cameraToggle(){this.c2c_ac_log("c2c_cameraToggle()"),this.c2c_info(""),this.c2c_activeCall.hasEnabledSendVideo()?this.c2c_activeCall.stopSendingVideo().then(()=>{this.c2c_gui_phoneDuringCall(),this.c2c_setRemoteVideoVisibility(this.c2c_activeCall.hasReceiveVideo())}).catch(e=>{ac_log("stop sending video failure",e)}).finally(()=>{this.c2c_cameraButton&&(this.c2c_cameraButton.disabled=!1)}):(this.c2c_cameraButton&&(this.c2c_cameraButton.disabled=!0),this.c2c_activeCall.startSendingVideo().then(()=>{this.c2c_gui_phoneDuringCall(),this.c2c_setRemoteVideoVisibility(this.c2c_activeCall.hasReceiveVideo())}).catch(e=>{this.c2c_ac_log("c2c error during start video",e)}).finally(()=>{this.c2c_cameraButton&&(this.c2c_cameraButton.disabled=!1)}))}c2c_call(e){return Kn(this,null,function*(){if(e&&typeof this.c2c_create_x_header=="function")try{this.c2c_x_header=this.c2c_create_x_header()}catch(r){this.c2c_info(r),this.c2c_ac_log("Exception in function this.c2c_create_x_header",r);return}if(this.c2c_sbcDisconnectTimer!==null&&(clearTimeout(this.c2c_sbcDisconnectTimer),this.c2c_sbcDisconnectTimer=null),this.c2c_isRegularCall=e,this.c2c_isStartCall=!0,this.c2c_audioPlayer.stop(),this.c2c_gui_phoneCalling(),this.c2c_phone.isInitialized())this.c2c_isWsConnected?this.c2c_startCall():this.c2c_ac_log("SIP is already initialized. websocket is disconnected. Wait connection...");else try{yield this.c2c_sbc_connect_sequence()}catch(r){this.c2c_ac_log("phone initialization or SBC connecting error:",r),this.c2c_info(r),this.c2c_gui_phoneBeforeCall()}})}c2c_sbc_connect_sequence(){return Kn(this,null,function*(){this.c2c_info("Connecting"),this.c2c_initStack({user:this.c2c_config.caller,displayName:this.c2c_config.callerDN,password:""})})}c2c_startCall(){this.c2c_isStartCall=!1,this.c2c_isRegularCall?this.c2c_makeCall(this.c2c_config.call,this.c2c_videoOption()):this.c2c_makeCall(this.c2c_config.testCallUser,this.c2c_phone.AUDIO)}c2c_makeCall(e,r,i=[]){let l={};if(this.c2c_activeCall!==null)throw"Already exists active call";this.c2c_info("Calling",!0),this.c2c_serverConfig.iceTransportPolicyRelay&&this.c2c_usedTurnServer&&(this.c2c_ac_log("Used TURN debugging iceTransportPolicy: 'relay'"),l.pcConfig={iceTransportPolicy:"relay"}),(this.c2c_isRegularCall&&!this.c2c_hasMicrophone||!this.c2c_isRegularCall&&!this.c2c_config.testCallUseMicrophone)&&(this.c2c_streamDest=this.c2c_audioPlayer.audioCtx.createMediaStreamDestination(),l.mediaStream=this.c2c_streamDest.stream),!this.c2c_isRegularCall&&this.c2c_config.testCallSBCScore&&(i.push("X-AC-Action: test-voice-quality"),e=`${e}@${this.c2c_serverConfig.domain};duration=${this.c2c_config.testCallMinDuration*1e3}`),this.c2c_isRegularCall&&this.c2c_x_header&&i.push(this.c2c_x_header),this.c2c_isRegularCall&&this.c2c_token&&i.push(`X-Token: ${this.c2c_token}`),this.c2c_activeCall=this.c2c_phone.call(r,e,i,l)}c2c_hangupCall(){this.c2c_activeCall!==null&&(this.c2c_activeCall.terminate(),this.c2c_activeCall=null),this.guiIsHidden("dtmf_keypad")||this.guiHideKeypad()}c2c_setRemoteVideoVisibility(e){let r=this.c2c_remoteVideo.style;r.display="block",e?(r.width=this.c2c_config.videoSize.width,r.height=this.c2c_config.videoSize.height):r.width=r.height=0}c2c_info(e,r=!1){this.c2c_status_line.innerHTML=e,this.c2c_status_line.dataset.id=++this.c2c_messageId,r&&(i=>{setTimeout(()=>{this.c2c_status_line.dataset.id===i&&(this.c2c_status_line.innerHTML="")},this.c2c_config.messageDisplayTime*1e3)})(this.c2c_status_line.dataset.id)}c2c_voiceQualityTesting(){return Kn(this,null,function*(){if(this.c2c_ac_log("Test call is established"),this.c2c_config.testCallUseMicrophone?this.c2c_ac_log("Test call plays microphone sound"):(this.c2c_ac_log("Test call plays recorded sound"),this.c2c_audioPlayer.play(this.c2c_soundConfig.play.testCallSound,this.c2c_streamDest)),this.c2c_info("Checking line quality..."),this.c2c_config.testCallSBCScore)this.c2c_ac_log("Checking line quality (SBC test)...");else{if(typeof this.c2c_browserVoiceQualityTest=="undefined"){this.c2c_info("Warning: Missed browser voice test",!0),this.c2c_ac_log("Warning: voice_quality.js is not loaded"),this.c2c_activeCall.terminate();return}yield this.c2c_browserVoiceQualityTest()}})}c2c_gui_phoneDisabled(e){this.c2c_ac_log(e),this.c2c_callButton.disabled=!0,document.querySelector("#c2c_call_btn svg").setAttribute("class","c2c_call_svg_disabled"),this.c2c_widgetDiv.className="c2c_widget_disabled",this.c2c_config.testCallEnabled&&(this.c2c_testButton.disabled=!0)}c2c_gui_phoneBeforeCall(){if(this.c2c_connectionSpeedDiv&&navigator.connection&&(this.c2c_connectionSpeedDiv.style.display="block"),this.c2c_testCallQualityDiv&&(this.c2c_testCallQualityDiv.style.display="block"),this.c2c_config.selectDevicesEnabled&&(this.c2c_selectDevicesButton.style.display="inline-block",this.c2c_selectDevicesButton.disabled=!1,this.c2c_selectDevicesDiv.style.display="none"),this.c2c_config.testCallEnabled&&(this.c2c_testButton.style.display="inline-block",this.c2c_testButton.disabled=!1),this.c2c_callButton.style.display="inline-block",this.c2c_callButton.disabled=!1,this.c2c_callButton.className="c2c_call_btn_ready btn btn-primary",this.c2c_callButton.querySelector("span").innerText="Click to Call",this.c2c_callButton.title=this.c2c_callButtonTitle,this.c2c_callButtonHandler=()=>{this.c2c_call(!0)},this.c2c_videoSpan){let e=this.c2c_config.type==="user_control"&&this.c2c_hasCamera;this.c2c_videoSpan.style.display=e?"inline-block":"none",this.c2c_videoCheckbox&&(this.c2c_videoCheckbox.checked=this.c2c_config.videoCheckboxDefault)}this.c2c_cameraButton&&(this.c2c_cameraButton.style.display="none",this.c2c_cameraLineSvg&&(this.c2c_cameraButton.style.display="none"))}c2c_gui_DeviceSelection(){this.c2c_selectDevicesDiv.style.display="block",this.c2c_connectionSpeedDiv&&(this.c2c_connectionSpeedDiv.style.display="none"),this.c2c_selectDevicesButton.style.display="none",this.c2c_testButton&&(this.c2c_testButton.style.display="none"),this.c2c_callButton.style.display="none",this.c2c_videoSpan&&(this.c2c_videoSpan.style.display="none"),this.c2c_cameraButton&&(this.c2c_cameraButton.style.display="none",this.c2c_cameraLineSvg&&(this.c2c_cameraButton.style.display="none"))}c2c_gui_phoneCalling(){this.guiIsHidden("dtmf_keypad")&&this.guiShowKeypad(),this.c2c_selectDevicesButton&&(this.c2c_selectDevicesButton.style.display="none"),this.c2c_isRegularCall?(this.c2c_connectionSpeedDiv&&(this.c2c_connectionSpeedDiv.style.display="none"),this.c2c_config.testCallEnabled&&(this.c2c_testButton.disabled=!0),this.c2c_callButton.className="c2c_call_btn_hangup btn btn-primary",this.c2c_callButton.querySelector("span").innerText="Hangup",this.c2c_callButton.title="Hang up",this.c2c_callButtonHandler=this.c2c_hangupCall.bind(this),this.c2c_videoSpan&&(this.c2c_videoSpan.style.display="none")):(this.c2c_testCallQualityDiv&&(this.c2c_testCallQualityDiv.innerHTML=""),this.c2c_callButton.style.display="none",this.c2c_videoSpan&&(this.c2c_videoSpan.style.display="none"))}c2c_gui_phoneOnRemoteHold(){this.c2c_ac_log("phone on remote hold")}c2c_gui_phoneDuringCall(){this.c2c_isRegularCall&&(this.c2c_videoSpan&&(this.c2c_videoSpan.style.display="none"),this.c2c_config.type==="user_control"&&this.c2c_hasCamera&&this.c2c_cameraButton&&this.c2c_cameraLineSvg&&(this.c2c_cameraButton.style.display="inline-block",this.c2c_cameraButton.title=this.c2c_activeCall.hasEnabledSendVideo()?"turn camera off":"turn camera on",this.c2c_cameraLineSvg.setAttribute("class",this.c2c_activeCall.hasEnabledSendVideo()?"c2c_camera_on":"c2c_camera_off")))}custom_guiSendDTMF(e){this.c2c_activeCall!=null&&(this.c2c_audioPlayer.play(Object.assign({name:e},this.c2c_soundConfig.play.dtmf)),this.c2c_activeCall.sendDTMF(e))}guiIsHidden(e){let r=document.getElementById(e);return window.getComputedStyle(r).getPropertyValue("display")==="none"}guiShow(e){document.getElementById(e).style.display="block"}guiHide(e){document.getElementById(e).style.display="none"}guiToggleDTMFKeyPad(){this.guiIsHidden("dtmf_keypad")?this.guiShowKeypad():this.guiHideKeypad()}guiShowKeypad(){document.getElementById("keypad_btn").value="Close keypad",this.guiShow("dtmf_keypad")}guiHideKeypad(){document.getElementById("keypad_btn").value="Keypad",this.guiHide("dtmf_keypad")}}const _1={domain:{}.VITE_SERVER_CONFIG_DOMAIN,addresses:{}.VITE_SERVER_ADDRESS?[{}.VITE_SERVER_ADDRESS]:[],iceServers:[]},p1={call:{}.VITE_CONFIG_CALL,caller:{}.VITE_CONFIG_CALLER,callerDN:{}.VITE_CONFIG_CALLER_DN,type:"audio",videoCheckboxDefault:!1,videoSize:{width:"480px",height:"360px"},callAutoStart:"no",messageDisplayTime:5,restoreCallMaxDelay:20,allowCallWithoutMicrophone:!0,networkPriority:void 0,urlToken:!1,testCallEnabled:!1,testCallSBCScore:!0,testCallUser:"50012",testCallAutoStart:!1,testCallUseMicrophone:!1,testCallVolume:0,testCallMinDuration:10,testCallMaxDuration:20,testCallQualityText:{green:"Good",yellow:"Fair",red:"Low",gray:"N/A"},selectDevicesEnabled:!1,pingInterval:10,pongTimeout:!0,timerThrottlingBestEffort:!0,pongReport:60,pongDist:!1,modes:{ice_timeout_fix:2e3,chrome_rtp_timeout_fix:13}},g1={generateTones:{ringingTone:[{f:400,t:1.5},{t:3.5}],busyTone:[{f:400,t:.5},{t:.5}],disconnectTone:[{f:400,t:.5},{t:.5}],sirenTone:[{f:400,t:1},{f:300,t:.5}]},downloadSounds:[{ring:"ring1"},"bell"],play:{outgoingCallProgress:{name:"ringingTone",loop:!0,volume:.2},busy:{name:"busyTone",volume:.2,repeat:4},disconnect:{name:"disconnectTone",volume:.2,repeat:3},testCallSound:{name:"sirenTone",loop:!0,volume:1},noMicrophoneSound:{name:"sirenTone",loop:!0,volume:.1},dtmf:{volume:.15},keepAliveBeep:{name:"keepAliveTone",volue:.01}}};function m1({description:t,callConfig:e,serverConfig:r}){const[i,l]=er.useState(null),[o,n]=er.useState(null);return er.useLayoutEffect(()=>{i&&n(new h1(e,r,g1))},[i]),er.useEffect(()=>{Kn(this,null,function*(){try{if(!r.addresses||r.addresses.length===0)throw new Error("The address was not defined in the configuration.");const f=new WebSocket(r.addresses[0],"sip");let h=null;yield new Promise((c,p)=>{f.onopen=c,f.onerror=p,h=setTimeout(p,5e3)}),h&&clearTimeout(h),l(!0),f.close()}catch(f){l(!1),console.debug({callConfig:e,serverConfig:r}),console.error(f)}})},[]),i===null?q.jsx(q.Fragment,{children:q.jsx("p",{children:"Testing connection with server..."})}):i===!1?q.jsx(q.Fragment,{children:q.jsx("p",{children:"Unable to connect to the server, please check if your internet is connected. Sometimes IT may be blocking the connection to the server, if the error persists, contact the IT team."})}):q.jsx(q.Fragment,{children:q.jsxs("div",{id:"main_div",children:[q.jsx("small",{children:t}),q.jsx("div",{id:"c2c_connection_speed_div"}),q.jsx("div",{id:"c2c_test_call_quality_div"}),q.jsxs("div",{id:"c2c_widget_div",children:[q.jsxs("button",{id:"c2c_select_devices_btn",title:"Click to select devices (microphone, camera, speaker)",children:[q.jsx("svg",{id:"c2c_select_devices_svg",height:"512px",version:"1.1",viewBox:"0 0 512 512",width:"512px",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:q.jsx("path",{d:"M424.5,216.5h-15.2c-12.4,0-22.8-10.7-22.8-23.4c0-6.4,2.7-12.2,7.5-16.5l9.8-9.6c9.7-9.6,9.7-25.3,0-34.9l-22.3-22.1  c-4.4-4.4-10.9-7-17.5-7c-6.6,0-13,2.6-17.5,7l-9.4,9.4c-4.5,5-10.5,7.7-17,7.7c-12.8,0-23.5-10.4-23.5-22.7V89.1  c0-13.5-10.9-25.1-24.5-25.1h-30.4c-13.6,0-24.4,11.5-24.4,25.1v15.2c0,12.3-10.7,22.7-23.5,22.7c-6.4,0-12.3-2.7-16.6-7.4l-9.7-9.6  c-4.4-4.5-10.9-7-17.5-7s-13,2.6-17.5,7L110,132c-9.6,9.6-9.6,25.3,0,34.8l9.4,9.4c5,4.5,7.8,10.5,7.8,16.9  c0,12.8-10.4,23.4-22.8,23.4H89.2c-13.7,0-25.2,10.7-25.2,24.3V256v15.2c0,13.5,11.5,24.3,25.2,24.3h15.2  c12.4,0,22.8,10.7,22.8,23.4c0,6.4-2.8,12.4-7.8,16.9l-9.4,9.3c-9.6,9.6-9.6,25.3,0,34.8l22.3,22.2c4.4,4.5,10.9,7,17.5,7  c6.6,0,13-2.6,17.5-7l9.7-9.6c4.2-4.7,10.2-7.4,16.6-7.4c12.8,0,23.5,10.4,23.5,22.7v15.2c0,13.5,10.8,25.1,24.5,25.1h30.4  c13.6,0,24.4-11.5,24.4-25.1v-15.2c0-12.3,10.7-22.7,23.5-22.7c6.4,0,12.4,2.8,17,7.7l9.4,9.4c4.5,4.4,10.9,7,17.5,7  c6.6,0,13-2.6,17.5-7l22.3-22.2c9.6-9.6,9.6-25.3,0-34.9l-9.8-9.6c-4.8-4.3-7.5-10.2-7.5-16.5c0-12.8,10.4-23.4,22.8-23.4h15.2  c13.6,0,23.3-10.7,23.3-24.3V256v-15.2C447.8,227.2,438.1,216.5,424.5,216.5z M336.8,256L336.8,256c0,44.1-35.7,80-80,80  c-44.3,0-80-35.9-80-80l0,0l0,0c0-44.1,35.7-80,80-80C301.1,176,336.8,211.9,336.8,256L336.8,256z"})}),q.jsx("span",{children:"Devices"})]}),q.jsxs("button",{id:"c2c_test_btn",title:"Click to test connection quality",children:[q.jsx("svg",{id:"c2c_test_svg",children:q.jsxs("g",{fill:"none",fillRule:"evenodd",children:[q.jsx("path",{d:"M-1-1h24v24H-1z"}),q.jsx("path",{d:"M21.61 17.99l-9.08-9.08c.93-2.34.45-5.1-1.44-7-2.3-2.3-5.88-2.51-8.43-.65L6.5 5.11 5.08 6.52 1.25 2.69C-.61 5.23-.4 8.82 1.9 11.11c1.86 1.86 4.57 2.35 6.89 1.48l9.11 9.11c.39.39 1.02.39 1.41 0l2.3-2.3c.4-.38.4-1.01 0-1.41zm-3 1.6l-9.46-9.46c-.61.45-1.29.72-2 .82-1.36.2-2.79-.21-3.83-1.25C2.37 8.76 1.93 7.5 2 6.26l3.09 3.09 4.24-4.24-3.09-3.09c1.24-.07 2.49.37 3.44 1.31a4.469 4.469 0 011.24 3.96 4.35 4.35 0 01-.88 1.96l9.45 9.45-.88.89z",fill:"#1D1D1D"})]})}),q.jsx("span",{children:"Test line"})]}),"",q.jsx("button",{id:"c2c_call_btn",title:"Click to call us on the phone",className:"c2c_call_btn_ready btn btn-primary",style:{display:"inline-block"},children:q.jsx("span",{children:"Call to Stefanini"})}),q.jsxs("span",{id:"c2c_video_chk_span",style:{display:"none"},children:[q.jsx("input",{id:"c2c_video_chk",type:"checkbox",title:"video call"}),"video"]}),q.jsx("input",{id:"keypad_btn",className:"btn btn-primary",type:"button",value:"Keypad",title:"Open/Close key panel"}),q.jsx("button",{id:"c2c_camera_btn",style:{display:"none"},children:q.jsx("svg",{id:"c2c_camera_svg",viewBox:"0 0 30 30",children:q.jsxs("g",{strokeWidth:"2",strokeLinejoin:"round",children:[q.jsx("rect",{x:"4",y:"12",width:"15",height:"14"}),q.jsx("polyline",{points:"20,15 26,12 26,26 20,23"}),q.jsx("line",{id:"c2c_camera_line_svg",className:"c2c_camera_on c2c_camera_off",strokeWidth:"3",x1:"23.823129",y1:"6.0983146",x2:"0.69568307",y2:"29.082097",stroke:"none"})]})})}),q.jsx("div",{id:"c2c_select_devices_div",children:q.jsxs("form",{id:"c2c_devices",onSubmit:f=>f.preventDefault(),children:[q.jsxs("fieldset",{children:[q.jsx("legend",{children:"Select devices"}),q.jsxs("div",{id:"microphone_dev",children:["Microphone",q.jsx("br",{}),q.jsx("select",{name:"microphone"}),q.jsx("br",{}),q.jsx("br",{})]}),q.jsxs("div",{id:"speaker_dev",children:["Speaker",q.jsx("br",{}),q.jsx("select",{name:"speaker"}),q.jsx("br",{}),q.jsx("br",{})]}),q.jsxs("div",{id:"camera_dev",children:["Camera",q.jsx("br",{}),q.jsx("select",{name:"camera"}),q.jsx("br",{}),q.jsx("br",{})]})]}),q.jsx("input",{id:"select_devices_done_btn",type:"button",value:"Done"})]})}),q.jsx("div",{id:"c2c_status_line","data-id":"5"}),q.jsx("div",{id:"dtmf_keypad",style:{display:"none"},children:q.jsx("table",{id:"keypad_table",cellPadding:"5",cellSpacing:"3",children:q.jsxs("tbody",{children:[q.jsxs("tr",{children:[q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("1"),children:"1"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("2"),children:"2"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("3"),children:"3"})]}),q.jsxs("tr",{children:[q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("4"),children:"4"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("5"),children:"5"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("6"),children:"6"})]}),q.jsxs("tr",{children:[q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("7"),children:"7"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("8"),children:"8"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("9"),children:"9"})]}),q.jsxs("tr",{children:[q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("*"),children:"*"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("0"),children:"0"}),q.jsx("td",{onClick:()=>o==null?void 0:o.custom_guiSendDTMF("#"),children:"#"})]})]})})})]}),q.jsxs("div",{id:"c2c_video_div",children:[q.jsx("video",{id:"c2c_local_video",style:{display:"none"},playsInline:!0}),q.jsx("video",{id:"c2c_remote_video",style:{display:"block",height:"0px",width:"0px"},autoPlay:!0,playsInline:!0})]})]})})}function v1({description:t,callConfig:e,serverConfig:r}){return q.jsx(q.Fragment,{children:q.jsx(m1,{description:t||"This widget is for Demo purpose only.",callConfig:mr(mr({},p1),e),serverConfig:mr(mr({},_1),r)})})}function y1(t,e={}){const r=document.getElementById(t);r&&Za.createRoot(r).render(q.jsx(Xv.StrictMode,{children:q.jsx(v1,mr({},e))}))};


  return {
    renderOn: function (id, params) {
      return y1(id, params);
    },
    type: 'CallServiceDesk',
  };
})()
]]></script>
        <script_name>CallServiceDesk</script_name>
        <sys_class_name>sys_ui_script</sys_class_name>
        <sys_created_by>andre.nunes@stefanini.com</sys_created_by>
        <sys_created_on>2023-05-30 19:18:19</sys_created_on>
        <sys_id>1c7d877a1b0be910ad11eb93b24bcbf8</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>x_stefa_chameleon.CallServiceDesk</sys_name>
        <sys_package display_value="Chameleon" source="x_stefa_chameleon">15b425181b832510cc28c955624bcbd6</sys_package>
        <sys_policy/>
        <sys_scope display_value="Chameleon">15b425181b832510cc28c955624bcbd6</sys_scope>
        <sys_update_name>sys_ui_script_1c7d877a1b0be910ad11eb93b24bcbf8</sys_update_name>
        <sys_updated_by>vinicius.lourenco@stefanini.com</sys_updated_by>
        <sys_updated_on>2023-06-08 17:33:20</sys_updated_on>
        <ui_type>10</ui_type>
        <use_scoped_format>false</use_scoped_format>
    </sys_ui_script>
</record_update>
